<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-translate-key="pageTitle">Smart Business Analytics - Saudi Mais Co</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: white;
            overflow-x: hidden;
            perspective: 2000px;
            min-height: 100vh;
        }

        .language-switcher {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1001;
            display: flex;
            gap: 10px;
        }

        html[dir="rtl"] .language-switcher {
            left: auto;
            right: 20px;
        }

        .lang-btn {
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.4);
            color: white;
            cursor: pointer;
            border-radius: 20px;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .lang-btn:hover, .lang-btn.active {
            background: linear-gradient(45deg, #00c6ff, #0072ff);
            border-color: transparent;
        }


        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            transform-style: preserve-3d;
        }

        .header {
            text-align: center;
            padding: 80px 0 40px 0; /* Increased top padding for lang switcher & API status */
            transform: translateZ(100px);
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateZ(100px) translateY(0px); }
            50% { transform: translateZ(120px) translateY(-20px); }
        }

        .header h1 {
            font-size: 3.5em;
            background: linear-gradient(45deg, #00c6ff, #0072ff, #ff6b6b);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(0, 198, 255, 0.5);
            margin-bottom: 20px;
        }
        
        .navigation {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
            transform: translateZ(50px);
        }

        .nav-btn {
            padding: 12px 25px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            border-radius: 25px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            transform: translateZ(10px);
            border: 2px solid transparent;
        }

        .nav-btn:hover, .nav-btn.active {
            transform: translateZ(20px) scale(1.05);
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .section {
            display: none;
            animation: fadeInUp 0.6s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .company-info {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            padding: 30px;
            margin: 30px 0;
            transform: translateZ(50px) rotateX(5deg);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.5s ease;
        }

        .company-info:hover {
            transform: translateZ(80px) rotateX(0deg) scale(1.02);
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 30px;
            margin: 40px 0;
            transform-style: preserve-3d;
        }

        .analysis-card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            transform: translateZ(40px);
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.6s cubic-bezier(0.23, 1, 0.320, 1);
            position: relative;
            overflow: hidden;
        }

        .analysis-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s;
        }
        html[dir="rtl"] .analysis-card::before {
            left: auto;
            right: -100%;
            background: linear-gradient(-90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: right 0.6s;
        }


        .analysis-card:hover::before {
            left: 100%;
        }
        html[dir="rtl"] .analysis-card:hover::before {
            left: auto;
            right: 100%;
        }

        .analysis-card:hover {
            transform: translateZ(80px) rotateY(5deg);
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        html[dir="rtl"] .analysis-card:hover {
            transform: translateZ(80px) rotateY(-5deg); /* Invert Y rotation for RTL */
        }


        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        html[dir="rtl"] .card-header {
            flex-direction: row-reverse; /* Icon on the right */
        }


        .card-icon {
            font-size: 2.5em;
            margin-right: 15px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        html[dir="rtl"] .card-icon {
            margin-right: 0;
            margin-left: 15px;
        }


        .input-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }

        .input-options {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            justify-content: center;
            flex-wrap: wrap; /* Allow wrapping on small screens */
        }

        .option-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option-btn.active {
            background: linear-gradient(45deg, #00c6ff, #0072ff);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .input-area {
            display: none;
        }

        .input-area.active {
            display: block;
        }

        .text-input, .focus-input {
            width: 100%;
            min-height: 120px;
            background: rgba(0, 0, 0, 0.2); /* Darker input */
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: white;
            padding: 15px;
            font-size: 16px;
            resize: vertical;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.2);
        }
        html[dir="rtl"] .text-input, html[dir="rtl"] .focus-input {
            text-align: right;
        }

        .text-input::placeholder, .focus-input::placeholder {
            color: rgba(255, 255, 255, 0.5); /* Lighter placeholder */
        }
        html[dir="rtl"] .text-input::placeholder, html[dir="rtl"] .focus-input::placeholder {
            text-align: right;
        }


        .focus-input {
            height: 80px;
            font-size: 14px;
            margin-top: 10px;
        }

        .file-upload-area { /* Wrapper for file input and status */
             margin-bottom: 15px;
        }

        .file-upload {
            width: 100%;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2); /* Darker upload area */
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload:hover {
            background: rgba(0, 0, 0, 0.3);
            border-color: rgba(0, 198, 255, 0.7);
        }

        .file-upload input {
            display: none;
        }
        
        .file-status-display {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top:10px;
        }
        .file-status-display p {
            margin-bottom: 5px;
        }
        .file-status-display .file-name {
            font-weight: bold;
            color: #00c6ff;
        }
        .file-status-display .file-preview {
            font-size: 0.9em;
            opacity: 0.8;
            max-height: 60px;
            overflow-y: auto;
            background: rgba(0,0,0,0.2);
            padding: 5px;
            border-radius: 5px;
            margin-top:5px;
            border: 1px solid rgba(255,255,255,0.1);
        }


        .gemini-integration {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 25px;
            padding: 40px;
            margin: 40px 0;
            transform: translateZ(60px);
            box-shadow: 0 30px 60px rgba(102, 126, 234, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .gemini-chat {
            background: rgba(0,0,0, 0.2); /* Darker chat */
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            min-height: 400px;
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.3);
        }
        html[dir="rtl"] .gemini-chat p {
            text-align: right;
        }
        
        .gemini-chat p {
            margin-bottom: 15px;
            line-height: 1.7;
        }
        .gemini-chat p strong { /* User/AI Name */
            color: #00c6ff;
            display: block;
            margin-bottom: 3px;
        }

        .input-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .input-group input {
            flex: 1;
            min-width: 200px;
            padding: 15px;
            background: rgba(0,0,0, 0.3); /* Darker input */
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 16px;
        }
        html[dir="rtl"] .input-group input {
            text-align: right;
        }


        .input-group input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        html[dir="rtl"] .input-group input::placeholder {
            text-align: right;
        }

        .btn {
            padding: 15px 25px;
            background: linear-gradient(45deg, #00c6ff, #0072ff);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            transform: translateZ(10px);
            white-space: nowrap;
            margin: 5px; /* Added for wrap spacing */
        }

        .btn:hover {
            transform: translateZ(20px) scale(1.05);
            box-shadow: 0 10px 20px rgba(0, 114, 255, 0.4);
        }

        .export-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
            font-size: 12px;
            padding: 10px 15px;
        }

        .export-btn:hover {
            box-shadow: 0 10px 20px rgba(40, 167, 69, 0.4);
        }

        .chart-container {
            background: rgba(0,0,0,0.15); /* Darker chart bg */
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            transform: translateZ(30px);
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.2);
            height: 300px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transform: translateZ(40px);
            transition: all 0.4s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-card:hover {
            transform: translateZ(60px) scale(1.05);
            background: rgba(255, 255, 255, 0.15);
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 10px 0;
        }

        .recommendations { /* This class was present but not used in HTML. Retaining for potential future use. */
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            color: #333;
            border-radius: 25px;
            padding: 40px;
            margin: 40px 0;
            transform: translateZ(50px);
            box-shadow: 0 25px 50px rgba(255, 154, 158, 0.3);
        }
        html[dir="rtl"] .recommendations {
             text-align: right;
        }

        .solution-card {
            background: rgba(76, 175, 80, 0.1);
            border: 2px solid rgba(76, 175, 80, 0.3);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            transform: translateZ(35px);
            transition: all 0.4s ease;
        }

        .solution-card:hover {
            transform: translateZ(55px);
            background: rgba(76, 175, 80, 0.2);
        }

        /* ŸÖÿ≠ÿ≥ŸÜ - ÿ™ÿµŸÖŸäŸÖ ŸÖÿÆÿ±ÿ¨ÿßÿ™ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ */
        .results-section {
            background: rgba(10, 20, 30, 0.6); /* Darker, more distinct background */
            backdrop-filter: blur(30px); /* Increased blur */
            -webkit-backdrop-filter: blur(30px);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border: 1px solid rgba(0, 198, 255, 0.4); /* Themed border */
            max-height: 700px; /* Consider increasing for desktop */
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5), inset 0 0 20px rgba(0, 198, 255, 0.15); /* Enhanced shadow */
            position: relative;
        }

        .results-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px; /* Thicker highlight bar */
            background: linear-gradient(90deg, #00c6ff, #0072ff, #ff6b6b);
            border-radius: 20px 20px 0 0;
        }
        html[dir="rtl"] .results-section::before {
            background: linear-gradient(-90deg, #00c6ff, #0072ff, #ff6b6b); /* Invert gradient for RTL */
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px; /* Increased margin */
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(0, 198, 255, 0.25); /* Themed border */
            flex-wrap: wrap;
            gap: 15px;
        }
        html[dir="rtl"] .results-header {
            flex-direction: row-reverse; /* Ensure controls are on the left */
        }


        .results-header h4 {
            font-size: 1.8em; /* Larger title */
            background: linear-gradient(45deg, #00c6ff, #4ecdc4);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 12px rgba(0, 198, 255, 0.6); /* Enhanced text shadow */
        }

        .export-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .api-status {
            position: fixed;
            top: 20px;
            right: 20px; 
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        html[dir="rtl"] .api-status {
            right: auto;
            left: 20px; 
        }

        .api-connected {
            background: rgba(76, 175, 80, 0.9);
            color: white;
        }

        .api-disconnected {
            background: rgba(244, 67, 54, 0.9);
            color: white;
        }

        .status-messages {
            background: rgba(0,0,0, 0.2); /* Darker status messages */
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            font-size: 14px;
            display: none;
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        html[dir="rtl"] .status-messages {
            text-align: right;
        }


        .status-step {
            margin: 8px 0;
            opacity: 0.7;
            transition: all 0.3s ease;
            padding: 5px 0;
        }

        .status-step.active {
            opacity: 1;
            color: #00c6ff;
            font-weight: bold;
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ™ŸÜÿ≥ŸäŸÇ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ */
        .formatted-content {
            line-height: 1.8;
            font-size: 16px; /* Slightly larger base font for results */
        }
        html[dir="rtl"] .formatted-content {
            text-align: right;
        }

        .formatted-content h1 {
            color: #00c6ff;
            font-size: 2em; /* Larger H1 */
            margin: 30px 0 20px 0;
            padding: 15px 0;
            border-bottom: 2px solid rgba(0, 198, 255, 0.4);
            background: linear-gradient(45deg, #00c6ff, #4ecdc4);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 8px rgba(0, 198, 255, 0.3);
        }

        .formatted-content h2 {
            color: #4cecbc; /* Brighter H2 */
            font-size: 1.7em;
            margin: 25px 0 15px 0;
            padding: 12px 0 10px 0;
            border-left: 4px solid #4cecbc;
            padding-left: 15px;
        }
        html[dir="rtl"] .formatted-content h2 {
            border-left: none;
            border-right: 4px solid #4cecbc;
            padding-left: 0;
            padding-right: 15px;
        }


        .formatted-content h3 {
            color: #ff7b7b; /* Brighter H3 */
            font-size: 1.4em;
            margin: 20px 0 12px 0;
            padding: 10px 0;
        }

        .formatted-content h4 {
            color: #ffb74e; /* Brighter H4 */
            font-size: 1.2em;
            margin: 18px 0 10px 0;
        }

        .formatted-content ul, .formatted-content ol {
            margin: 18px 0;
            padding-left: 30px; /* More indent */
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 20px 30px; /* More padding inside list bg */
            border: 1px solid rgba(255,255,255,0.08);
        }
        html[dir="rtl"] .formatted-content ul, html[dir="rtl"] .formatted-content ol {
            padding-left: 0;
            padding-right: 30px;
        }


        .formatted-content li {
            margin: 10px 0; /* More spacing for li */
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }

        .formatted-content li:last-child {
            border-bottom: none;
        }

        .formatted-content p {
            margin: 15px 0;
            text-align: justify; 
        }
        /* Removed empty ruleset: html[dir="rtl"] .formatted-content p */

        .formatted-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            background: rgba(0, 0, 0, 0.15); /* Darker table */
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .formatted-content th, .formatted-content td {
            border: 1px solid rgba(255, 255, 255, 0.15); /* Slightly more visible border */
            padding: 14px 18px; /* More padding */
            text-align: left; 
        }
        html[dir="rtl"] .formatted-content th, html[dir="rtl"] .formatted-content td {
            text-align: right;
        }

        .formatted-content th {
            background: rgba(0, 198, 255, 0.25); /* More prominent th */
            font-weight: bold;
            color: #00e0ff; /* Brighter th text */
        }

        .formatted-content td {
            background: rgba(255, 255, 255, 0.03); /* Slightly lighter td for contrast */
        }

        .formatted-content strong {
            color: #5effd1; /* Brighter strong */
            font-weight: bold;
        }

        .formatted-content em {
            color: #ff8b8b; /* Brighter em */
            font-style: italic;
        }

        .formatted-content blockquote {
            background: rgba(0, 0, 0, 0.1); /* Darker blockquote */
            border-left: 5px solid #00c6ff; 
            margin: 20px 0;
            padding: 20px 25px;
            border-radius: 0 10px 10px 0; 
            font-style: italic;
            box-shadow: inset 3px 0 8px rgba(0,0,0,0.2);
        }
        html[dir="rtl"] .formatted-content blockquote {
            border-left: none;
            border-right: 5px solid #00c6ff;
            border-radius: 10px 0 0 10px;
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑŸÖÿ™ÿÆÿµÿµÿ© */
        .analysis-result-card { /* Main container for a "section" of results */
            background: rgba(255, 255, 255, 0.04); /* Slightly lighter than section bg */
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.12);
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .analysis-result-card:hover {
            background: rgba(255, 255, 255, 0.07);
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .analysis-result-card h2, .analysis-result-card h3 { /* Titles within result cards */
            margin-top: 0; /* Remove default top margin for titles inside these cards */
            border-left: none; /* Remove default h2 border if it's inside */
            padding-left: 0;
        }
        html[dir="rtl"] .analysis-result-card h2, html[dir="rtl"] .analysis-result-card h3 {
            border-right: none;
            padding-right: 0;
        }


        .result-icon { /* Generic icon styling if needed */
            font-size: 2em;
            margin-bottom: 10px;
            display: block;
            color: #00c6ff; /* Example color */
        }

        .metric-card {
            background: linear-gradient(135deg, rgba(0, 198, 255, 0.15), rgba(76, 236, 196, 0.15)); /* Slightly stronger gradient */
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0; /* Increased margin */
            text-align: center;
            border: 1px solid rgba(0, 198, 255, 0.3); /* More visible border */
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .metric-value {
            font-size: 2.4em; /* Slightly larger */
            font-weight: bold;
            color: #00d2ff; /* Brighter */
            margin: 10px 0;
        }

        .metric-label {
            font-size: 1em; /* Larger label */
            opacity: 0.85;
            margin-top: 8px;
        }

        .quality-indicator {
            display: inline-block;
            padding: 6px 14px; /* More padding */
            border-radius: 20px;
            font-size: 0.9em; /* Slightly larger */
            font-weight: bold;
            margin: 5px; /* More margin */
            text-transform: uppercase; /* Make it stand out */
            letter-spacing: 0.5px;
        }

        .quality-excellent {
            background: rgba(76, 175, 80, 0.3);
            color: #66bb6a; /* Brighter green */
            border: 1px solid #66bb6a;
        }

        .quality-good {
            background: rgba(76, 236, 196, 0.3);
            color: #50e1c2; /* Brighter teal */
            border: 1px solid #50e1c2;
        }

        .quality-warning {
            background: rgba(255, 167, 38, 0.3);
            color: #ffb74d; /* Brighter orange */
            border: 1px solid #ffb74d;
        }

        .quality-critical {
            background: rgba(244, 67, 54, 0.3);
            color: #ef5350; /* Brighter red */
            border: 1px solid #ef5350;
        }

        .recommendation-box, .warning-box, .critical-box {
            border-left: 5px solid #4caf50; /* Thicker border */
            border-radius: 0 10px 10px 0;  
            padding: 25px; /* More padding */
            margin: 25px 0; /* More margin */
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        html[dir="rtl"] .recommendation-box, html[dir="rtl"] .warning-box, html[dir="rtl"] .critical-box {
            border-left: none;
            border-radius: 10px 0 0 10px;
            text-align: right;
        }

        .recommendation-box {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.15), rgba(139, 195, 74, 0.15));
            border-left-color: #4caf50;
        }
        html[dir="rtl"] .recommendation-box { border-right: 5px solid #4caf50; }


        .warning-box {
            background: linear-gradient(135deg, rgba(255, 167, 38, 0.15), rgba(255, 193, 7, 0.15));
            border-left-color: #ffa726;
        }
        html[dir="rtl"] .warning-box { border-right: 5px solid #ffa726; }

        .critical-box {
            background: linear-gradient(135deg, rgba(244, 67, 54, 0.15), rgba(229, 57, 53, 0.15));
            border-left-color: #f44336;
        }
        html[dir="rtl"] .critical-box { border-right: 5px solid #f44336; }

        .recommendation-box h4, .warning-box h4, .critical-box h4 {
            margin-top:0;
            margin-bottom: 10px;
            font-size: 1.3em;
        }
        .recommendation-box h4 { color: #4caf50; }
        .warning-box h4 { color: #ffa726; }
        .critical-box h4 { color: #f44336; }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÑŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑŸÖÿ≠ŸÖŸàŸÑÿ© */
        @media (max-width: 768px) {
            .language-switcher {
                top: 10px;
                left: 10px;
                flex-wrap: wrap; /* Added for safety */
            }
            html[dir="rtl"] .language-switcher {
                left: auto;
                right: 10px;
            }
            .header {
                padding-top: 70px; /* More space if lang switcher wraps */
            }

            .container {
                padding: 10px; /* Slightly more padding */
            }
            .analysis-grid {
                grid-template-columns: 1fr;
            }
            .header h1 {
                font-size: 2.2em; /* Slightly larger for tablets */
            }
            
            .input-group {
                flex-direction: column;
                gap: 8px; /* Increased gap */
            }
            .navigation {
                gap: 8px; /* Increased gap */
            }
            .nav-btn {
                padding: 10px 18px; /* Slightly larger */
                font-size: 13px;
            }
            .input-options {
                flex-direction: column;
                gap: 10px;
            }
            .results-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            html[dir="rtl"] .results-header {
                align-items: flex-end;
            }
            .export-controls {
                width: 100%;
                justify-content: flex-start;
            }
            html[dir="rtl"] .export-controls {
                justify-content: flex-end;
            }
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); /* Larger minmax */
                gap: 10px;
            }
            .stat-value {
                font-size: 1.5em;
            }
            .formatted-content {
                font-size: 14px; /* Base for mobile */
            }
            .formatted-content h1 { font-size: 1.5em; }
            .formatted-content h2 { font-size: 1.3em; }
            .formatted-content h3 { font-size: 1.2em; }
            .formatted-content h4 { font-size: 1.1em; }

            .formatted-content table {
                font-size: 12px; /* Slightly larger table font */
            }
            .formatted-content th, .formatted-content td {
                padding: 8px 10px;
            }
            .metric-value {
                font-size: 1.8em; /* Larger metric value */
            }
            .results-section {
                max-height: 450px; /* Increased max-height */
                padding: 15px;
            }
            .api-status {
                position: relative; 
                top: auto; right: auto; left: auto;
                margin: 10px auto; 
                display: block;
                text-align: center;
                font-size: 13px;
                padding: 8px 12px;
                width: fit-content;
            }
            
            .card-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px; /* Increased gap */
            }
            html[dir="rtl"] .card-header {
                align-items: flex-end;
            }
            .analysis-card, .section-card { 
                padding: 20px; /* More padding */
            }
            .gemini-integration { padding: 25px; }
            .gemini-chat { min-height: 300px; max-height: 400px;}
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© ÿ¨ÿØÿßŸã */
        @media (max-width: 480px) {
             .language-switcher {
                top: 8px; /* More space */
                left: 8px;
                gap: 5px;
            }
            html[dir="rtl"] .language-switcher {
                left: auto;
                right: 8px;
            }
            .lang-btn {
                padding: 6px 12px; /* Slightly larger */
                font-size: 11px;
            }
            .header {
                padding-top: 60px; /* Adjust if lang switcher wraps */
            }

            .container {
                padding: 5px;
            }
            
            .header h1 {
                font-size: 1.8em; /* Readable size */
            }
             .header h2 { font-size: 1em; }
             .header p { font-size: 0.85em; }

            .nav-btn {
                padding: 8px 12px;
                font-size: 11px;
            }
            .analysis-card, .section-card {
                padding: 15px;
            }
            .input-section {
                padding: 10px;
            }
            .text-input, .focus-input {
                font-size: 13px;
                padding: 10px;
                min-height: 100px;
            }
            .focus-input { height: 70px; }
            .btn {
                padding: 10px 15px;
                font-size: 12px;
            }
            .results-section {
                padding: 10px;
                max-height: 350px; /* Increased */
            }
            .formatted-content ul, .formatted-content ol {
                padding: 10px 15px;
            }
            html[dir="rtl"] .formatted-content ul, html[dir="rtl"] .formatted-content ol {
                padding-left: 15px; 
                padding-right: 15px;
            }

            .stats-grid {
                grid-template-columns: 1fr; /* Single column for very small */
            }
            .stat-card { padding: 15px; }
            .stat-value { font-size: 1.8em; }

            .formatted-content { font-size: 13px; }
            .formatted-content h1 { font-size: 1.3em; }
            .formatted-content h2 { font-size: 1.15em; }
            .formatted-content h3 { font-size: 1.05em; }
            .formatted-content h4 { font-size: 1em; }
            .chart-container { height: 220px; padding: 10px;}
        }

        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .floating-element {
            position: absolute;
            background: rgba(255, 255, 255, 0.07); /* Slightly less visible */
            border-radius: 50%;
            animation: floatAround 20s infinite linear;
        }

        @keyframes floatAround {
            0% { transform: translateY(100vh) rotate(0deg) scale(0.8); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg) scale(1.2); opacity: 0; }
        }

        .section-card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            transform: translateZ(40px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.6s ease;
        }

        .section-card:hover {
            transform: translateZ(60px) scale(1.01); /* Subtle scale */
        }

        .results-section::-webkit-scrollbar { width: 10px; }
        .results-section::-webkit-scrollbar-track {
            background: rgba(0,0,0, 0.2);
            border-radius: 10px;
        }
        .results-section::-webkit-scrollbar-thumb {
            background: linear-gradient(0deg, #0072ff, #00c6ff); /* Vertical gradient */
            border-radius: 10px;
        }
        .results-section::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(0deg, #00c6ff, #0072ff);
        }
        
        .gemini-chat::-webkit-scrollbar { width: 8px; }
        .gemini-chat::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); border-radius: 10px; }
        .gemini-chat::-webkit-scrollbar-thumb { background: rgba(0, 198, 255, 0.5); border-radius: 10px; }
        .gemini-chat::-webkit-scrollbar-thumb:hover { background: rgba(0, 198, 255, 0.8); }


        .loading-enhanced {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 18px; /* Adjusted padding */
            background: rgba(0, 198, 255, 0.15); /* Slightly more visible */
            border-radius: 10px;
            border: 1px solid rgba(0, 198, 255, 0.4); /* Stronger border */
            color: #00c6ff; /* Text color match */
            font-weight: 500;
        }

        .loading-dots {
            display: flex;
            gap: 5px; /* Increased gap */
        }

        .loading-dot {
            width: 10px; /* Larger dots */
            height: 10px;
            background: #00c6ff;
            border-radius: 50%;
            animation: loadingDots 1.4s infinite ease-in-out; /* Smoother animation */
        }

        .loading-dot:nth-child(2) { animation-delay: 0.2s; }
        .loading-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes loadingDots {
            0%, 80%, 100% { opacity: 0.4; transform: scale(0.7); }
            40% { opacity: 1; transform: scale(1.1); } /* More pronounced scale */
        }
    </style>
</head>
<body>
    <div class="language-switcher">
        <button id="lang-en" class="lang-btn" onclick="setLanguage('en')">English</button>
        <button id="lang-ar" class="lang-btn" onclick="setLanguage('ar')">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</button>
    </div>

    <div id="apiStatus" class="api-status api-disconnected">
        <span data-translate-key="apiStatusDisconnected">üî¥ Not connected to Yazeed AI API</span>
    </div>

    <div class="floating-elements">
        <div class="floating-element" style="left: 10%; width: 60px; height: 60px; animation-delay: 0s; animation-duration: 25s;"></div>
        <div class="floating-element" style="left: 25%; width: 35px; height: 35px; animation-delay: 6s; animation-duration: 18s;"></div>
        <div class="floating-element" style="left: 75%; width: 50px; height: 50px; animation-delay: 12s; animation-duration: 30s;"></div>
        <div class="floating-element" style="left: 85%; width: 30px; height: 30px; animation-delay: 18s; animation-duration: 22s;"></div>
        <div class="floating-element" style="left: 50%; width: 45px; height: 45px; animation-delay: 3s; animation-duration: 20s;"></div>
    </div>

    <div class="container">
        <div class="header">
            <h1 data-translate-key="mainTitle">üîç Smart Business Analytics</h1>
            <h2 data-translate-key="companyNameHeader">Saudi Mais Co. Medical Products</h2>
            <p data-translate-key="headerSubtitle">Advanced AI-powered analysis system for financial crisis resolution</p>
        </div>

        <div class="navigation">
            <button class="nav-btn active" onclick="showSection('overview')" data-translate-key="navOverview">üè† Overview</button>
            <button class="nav-btn" onclick="showSection('advanced-analysis')" data-translate-key="navAdvancedAnalysis">üìä Advanced Analysis</button>
            <button class="nav-btn" onclick="showSection('quality-management')" data-translate-key="navQualityManagement">üè• Quality Management</button>
            <button class="nav-btn" onclick="showSection('demand-forecasting')" data-translate-key="navDemandForecasting">üìà Demand Forecasting</button>
            <button class="nav-btn" onclick="showSection('competitor-analysis')" data-translate-key="navCompetitorAnalysis">üéØ Competitor Analysis</button>
            <button class="nav-btn" onclick="showSection('ai-chat')" data-translate-key="navAiAssistant">ü§ñ AI Assistant</button>
        </div>

        <!-- Overview -->
        <div id="overview" class="section active">
            <div class="company-info">
                <h3 data-translate-key="companyInfoTitle">üìã Company Information</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">1994</div>
                        <p data-translate-key="yearFounded">Year Founded</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" data-translate-key="riyadh">Riyadh</div>
                        <p data-translate-key="headquarters">Headquarters</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" data-translate-key="medical">Medical</div>
                        <p data-translate-key="specializedProducts">Specialized Products</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" data-translate-key="middleEast">Middle East</div>
                        <p data-translate-key="targetMarket">Target Market</p>
                    </div>
                </div>
                <p data-translate-key="overviewCompanyDesc" style="text-align: center; margin-top: 20px; opacity: 0.9;">Saudi Mais Co. is a leading provider of medical products, committed to enhancing healthcare standards in the region through innovation and quality.</p>
            </div>

            <!-- Crisis Indicator Removed -->

            <div class="analysis-grid">
                <div class="analysis-card">
                    <div class="card-header">
                        <span class="card-icon">üìä</span>
                        <h3 data-translate-key="marketAnalysisTitle">Market Analysis</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="marketChart"></canvas>
                    </div>
                </div>

                <div class="analysis-card">
                    <div class="card-header">
                        <span class="card-icon">üí∞</span>
                        <h3 data-translate-key="financialAnalysisTitle">Financial Analysis</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="financialChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Advanced Analysis -->
        <div id="advanced-analysis" class="section">
            <div class="section-card">
                <div class="card-header">
                    <span class="card-icon">üìä</span>
                    <h3 data-translate-key="advancedAnalyticsSystemTitle">Advanced Data Analytics System</h3>
                </div>
                <p data-translate-key="advancedAnalyticsSystemDesc">Comprehensive analysis of market trends and operational performance with strategic recommendations</p>
                
                <div class="input-section">
                    <div class="input-options">
                        <button class="option-btn active" onclick="toggleInputMode('advanced', 'text')" data-translate-key="textInputBtn">üìù Text Input</button>
                        <button class="option-btn" onclick="toggleInputMode('advanced', 'file')" data-translate-key="fileUploadBtn">üìÅ File Upload</button>
                    </div>
                    
                    <div id="advanced-text" class="input-area active">
                        <textarea id="advancedTextInput" class="text-input" data-translate-key="advancedTextInputPlaceholder" placeholder="Enter company data for advanced analysis (financial data, sales, production, etc...)"></textarea>
                        <textarea id="advancedFocusInput" class="focus-input" data-translate-key="advancedFocusInputPlaceholder" placeholder="Specific focus areas or questions (e.g., 'Analyze competitor impact in respiratory products sector', 'Evaluate new regulation effects')"></textarea>
                    </div>
                    
                    <div id="advanced-file" class="input-area">
                        <div class="file-upload-area">
                            <div class="file-upload" onclick="document.getElementById('advancedFileInput').click()">
                                <p data-translate-key="dragFileHere">üìÅ Drag file here or click to select</p>
                                <p style="font-size: 14px; opacity: 0.7;" data-translate-key="supportedFileTypes">Supports: Excel, CSV, PDF, Word, TXT</p>
                                <input type="file" id="advancedFileInput" accept=".xlsx,.xls,.csv,.pdf,.doc,.docx,.txt" onchange="handleFileUpload('advanced', this)">
                            </div>
                            <div id="advancedFileStatus" class="file-status-display" style="display:none;"></div>
                        </div>
                        <textarea id="advancedFocusInputFile" class="focus-input" data-translate-key="advancedFocusInputFilePlaceholder" placeholder="Specific focus areas for file analysis"></textarea>
                    </div>
                    
                    <button class="btn" onclick="startAdvancedAnalysis()" data-translate-key="startAdvancedAnalysisBtn">üöÄ Start Advanced Analysis</button>
                </div>
                
                <div id="advancedStatus" class="status-messages">
                    <div class="status-step" id="advancedStep1" data-translate-key="advancedStep1Text">üìÑ Processing input/file...</div>
                    <div class="status-step" id="advancedStep2" data-translate-key="advancedStep2Text">üîÑ Sending data to Yazeed AI...</div>
                    <div class="status-step" id="advancedStep3" data-translate-key="advancedStep3Text">üß† AI analysis in progress...</div>
                    <div class="status-step" id="advancedStep4" data-translate-key="advancedStep4Text">üìä Formatting results...</div>
                </div>
                
                <div id="advancedResults" class="results-section" style="display: none;">
                    <div class="results-header">
                        <h4 data-translate-key="advancedAnalysisResultsTitle">üìä Advanced Analysis Results</h4>
                        <div class="export-controls">
                            <button class="btn export-btn" onclick="exportResults('advanced', 'txt')" data-translate-key="exportTxtBtn">üìÑ Export TXT</button>
                            <button class="btn export-btn" onclick="exportResults('advanced', 'md')" data-translate-key="exportMdBtn">üìù Export MD</button>
                            <button class="btn export-btn" onclick="exportResults('advanced', 'pdf')" data-translate-key="exportPdfBtn">üìë Export PDF</button>
                        </div>
                    </div>
                    <div id="advancedAnalysisContent" class="formatted-content"></div>
                </div>
            </div>
        </div>

        <!-- Quality Management -->
        <div id="quality-management" class="section">
            <div class="section-card">
                <div class="card-header">
                    <span class="card-icon">üè•</span>
                    <h3 data-translate-key="qualityManagementSystemTitle">Smart Quality Management System</h3>
                </div>
                <p data-translate-key="qualityManagementSystemDesc">Quality monitoring according to international standards ISO 13485 and FDA requirements</p>
                
                <div class="input-section">
                     <div class="input-options">
                        <button class="option-btn active" onclick="toggleInputMode('quality', 'text')" data-translate-key="textInputBtn">üìù Text Input</button>
                        <button class="option-btn" onclick="toggleInputMode('quality', 'file')" data-translate-key="fileUploadBtn">üìÅ File Upload</button>
                    </div>
                    
                    <div id="quality-text" class="input-area active">
                        <textarea id="qualityTextInput" class="text-input" data-translate-key="qualityTextInputPlaceholder" placeholder="Enter quality data (production defects, customer complaints, test results, etc...)"></textarea>
                        <textarea id="qualityFocusInput" class="focus-input" data-translate-key="qualityFocusInputPlaceholder" placeholder="Quality focus areas (e.g., 'ISO compliance assessment', 'Customer satisfaction analysis')"></textarea>
                    </div>
                    
                    <div id="quality-file" class="input-area">
                        <div class="file-upload-area">
                            <div class="file-upload" onclick="document.getElementById('qualityFileInput').click()">
                                <p data-translate-key="dragQualityFile">üìÅ Drag quality data file here</p>
                                <p style="font-size: 14px; opacity: 0.7;" data-translate-key="qualityFileTypes">Quality reports, inspection records, customer complaints</p>
                                <input type="file" id="qualityFileInput" accept=".xlsx,.xls,.csv,.pdf,.doc,.docx,.txt" onchange="handleFileUpload('quality', this)">
                            </div>
                            <div id="qualityFileStatus" class="file-status-display" style="display:none;"></div>
                        </div>
                        <textarea id="qualityFocusInputFile" class="focus-input" data-translate-key="qualityFocusInputFilePlaceholder" placeholder="Quality analysis focus areas"></textarea>
                    </div>
                    
                    <button class="btn" onclick="startQualityAnalysis()" data-translate-key="analyzeQualityBtn">üîç Analyze Quality</button>
                </div>
                
                <div id="qualityStatus" class="status-messages">
                    <div class="status-step" id="qualityStep1" data-translate-key="qualityStep1Text">üìÑ Reading quality data...</div>
                    <div class="status-step" id="qualityStep2" data-translate-key="qualityStep2Text">üîÑ Sending to AI analysis...</div>
                    <div class="status-step" id="qualityStep3" data-translate-key="qualityStep3Text">üè• Quality assessment in progress...</div>
                    <div class="status-step" id="qualityStep4" data-translate-key="qualityStep4Text">üìä Generating quality report...</div>
                </div>
                
                <div id="qualityResults" class="results-section" style="display: none;">
                    <div class="results-header">
                        <h4 data-translate-key="qualityAnalysisResultsTitle">üè• Quality Analysis Results</h4>
                        <div class="export-controls">
                            <button class="btn export-btn" onclick="exportResults('quality', 'txt')" data-translate-key="exportTxtBtn">üìÑ Export TXT</button>
                            <button class="btn export-btn" onclick="exportResults('quality', 'md')" data-translate-key="exportMdBtn">üìù Export MD</button>
                            <button class="btn export-btn" onclick="exportResults('quality', 'pdf')" data-translate-key="exportPdfBtn">üìë Export PDF</button>
                        </div>
                    </div>
                    <div id="qualityAnalysisContent" class="formatted-content"></div>
                </div>
            </div>
        </div>

        <!-- Demand Forecasting -->
        <div id="demand-forecasting" class="section">
            <div class="section-card">
                <div class="card-header">
                    <span class="card-icon">üìà</span>
                    <h3 data-translate-key="demandForecastingSystemTitle">Demand Forecasting & Inventory System</h3>
                </div>
                <p data-translate-key="demandForecastingSystemDesc">Predict future demand and optimize inventory levels using artificial intelligence</p>
                
                <div class="input-section">
                    <div class="input-options">
                        <button class="option-btn active" onclick="toggleInputMode('demand', 'text')" data-translate-key="textInputBtn">üìù Text Input</button>
                        <button class="option-btn" onclick="toggleInputMode('demand', 'file')" data-translate-key="fileUploadBtn">üìÅ File Upload</button>
                    </div>
                    
                    <div id="demand-text" class="input-area active">
                        <textarea id="demandTextInput" class="text-input" data-translate-key="demandTextInputPlaceholder" placeholder="Enter historical sales and inventory data (periods, quantities, seasons, etc...)"></textarea>
                        <textarea id="demandFocusInput" class="focus-input" data-translate-key="demandFocusInputPlaceholder" placeholder="Forecasting focus (e.g., 'Q4 seasonal trends', 'New product demand projection')"></textarea>
                    </div>
                    
                    <div id="demand-file" class="input-area">
                        <div class="file-upload-area">
                            <div class="file-upload" onclick="document.getElementById('demandFileInput').click()">
                                <p data-translate-key="dragDemandFile">üìÅ Drag sales and inventory data file</p>
                                <p style="font-size: 14px; opacity: 0.7;" data-translate-key="demandFileTypes">Historical sales data, inventory levels</p>
                                <input type="file" id="demandFileInput" accept=".xlsx,.xls,.csv,.pdf,.doc,.docx,.txt" onchange="handleFileUpload('demand', this)">
                            </div>
                            <div id="demandFileStatus" class="file-status-display" style="display:none;"></div>
                        </div>
                        <textarea id="demandFocusInputFile" class="focus-input" data-translate-key="demandFocusInputFilePlaceholder" placeholder="Demand forecasting focus areas"></textarea>
                    </div>
                    
                    <button class="btn" onclick="startDemandForecasting()" data-translate-key="forecastDemandBtn">üìä Forecast Demand</button>
                </div>
                
                <div id="demandStatus" class="status-messages">
                    <div class="status-step" id="demandStep1" data-translate-key="demandStep1Text">üìÑ Processing historical data...</div>
                    <div class="status-step" id="demandStep2" data-translate-key="demandStep2Text">üîÑ AI model preparation...</div>
                    <div class="status-step" id="demandStep3" data-translate-key="demandStep3Text">üìà Generating forecasts...</div>
                    <div class="status-step" id="demandStep4" data-translate-key="demandStep4Text">üìä Creating inventory recommendations...</div>
                </div>
                
                <div id="demandResults" class="results-section" style="display: none;">
                    <div class="results-header">
                        <h4 data-translate-key="demandForecastingResultsTitle">üìà Demand Forecasting Results</h4>
                        <div class="export-controls">
                            <button class="btn export-btn" onclick="exportResults('demand', 'txt')" data-translate-key="exportTxtBtn">üìÑ Export TXT</button>
                            <button class="btn export-btn" onclick="exportResults('demand', 'md')" data-translate-key="exportMdBtn">üìù Export MD</button>
                            <button class="btn export-btn" onclick="exportResults('demand', 'pdf')" data-translate-key="exportPdfBtn">üìë Export PDF</button>
                        </div>
                    </div>
                    <div id="demandAnalysisContent" class="formatted-content"></div>
                </div>
            </div>
        </div>
        
        <!-- Competitor Analysis -->
        <div id="competitor-analysis" class="section">
            <div class="section-card">
                <div class="card-header">
                    <span class="card-icon">üéØ</span>
                    <h3 data-translate-key="competitorAnalysisSystemTitle">Competitor Analysis System</h3>
                </div>
                <p data-translate-key="competitorAnalysisSystemDesc">Comprehensive competitive analysis in the medical equipment market and strategic opportunity identification</p>
                
                <div class="input-section">
                    <div class="input-options">
                        <button class="option-btn active" onclick="toggleInputMode('competitor', 'text')" data-translate-key="textInputBtn">üìù Text Input</button>
                        <button class="option-btn" onclick="toggleInputMode('competitor', 'file')" data-translate-key="fileUploadBtn">üìÅ File Upload</button>
                    </div>
                    
                    <div id="competitor-text" class="input-area active">
                        <textarea id="competitorTextInput" class="text-input" data-translate-key="competitorTextInputPlaceholder" placeholder="Enter competitor data (company names, prices, services, strengths and weaknesses, etc...)"></textarea>
                        <textarea id="competitorFocusInput" class="focus-input" data-translate-key="competitorFocusInputPlaceholder" placeholder="Competitive analysis focus (e.g., 'Pricing strategy comparison', 'Market positioning analysis')"></textarea>
                    </div>
                    
                    <div id="competitor-file" class="input-area">
                        <div class="file-upload-area">
                            <div class="file-upload" onclick="document.getElementById('competitorFileInput').click()">
                                <p data-translate-key="dragCompetitorFile">üìÅ Drag competitor data file</p>
                                <p style="font-size: 14px; opacity: 0.7;" data-translate-key="competitorFileTypes">Market reports, competitor information, comparison studies</p>
                                <input type="file" id="competitorFileInput" accept=".xlsx,.xls,.csv,.pdf,.doc,.docx,.txt" onchange="handleFileUpload('competitor', this)">
                            </div>
                            <div id="competitorFileStatus" class="file-status-display" style="display:none;"></div>
                        </div>
                        <textarea id="competitorFocusInputFile" class="focus-input" data-translate-key="competitorFocusInputFilePlaceholder" placeholder="Competitor analysis focus areas"></textarea>
                    </div>
                    
                    <button class="btn" onclick="startCompetitorAnalysis()" data-translate-key="analyzeCompetitionBtn">üîé Analyze Competition</button>
                </div>
                
                <div id="competitorStatus" class="status-messages">
                    <div class="status-step" id="competitorStep1" data-translate-key="competitorStep1Text">üìÑ Processing competitor data...</div>
                    <div class="status-step" id="competitorStep2" data-translate-key="competitorStep2Text">üîÑ Market analysis in progress...</div>
                    <div class="status-step" id="competitorStep3" data-translate-key="competitorStep3Text">üéØ Competitive positioning analysis...</div>
                    <div class="status-step" id="competitorStep4" data-translate-key="competitorStep4Text">üìä Strategic recommendations generation...</div>
                </div>
                
                <div id="competitorResults" class="results-section" style="display: none;">
                    <div class="results-header">
                        <h4 data-translate-key="competitorAnalysisResultsTitle">üéØ Competitor Analysis Results</h4>
                        <div class="export-controls">
                            <button class="btn export-btn" onclick="exportResults('competitor', 'txt')" data-translate-key="exportTxtBtn">üìÑ Export TXT</button>
                            <button class="btn export-btn" onclick="exportResults('competitor', 'md')" data-translate-key="exportMdBtn">üìù Export MD</button>
                            <button class="btn export-btn" onclick="exportResults('competitor', 'pdf')" data-translate-key="exportPdfBtn">üìë Export PDF</button>
                        </div>
                    </div>
                    <div id="competitorAnalysisContent" class="formatted-content"></div>
                </div>
            </div>
        </div>

        <!-- AI Assistant -->
        <div id="ai-chat" class="section">
            <div class="gemini-integration">
                <h3 data-translate-key="aiAssistantTitle">ü§ñ Yazeed AI Smart Assistant</h3>
                <div class="gemini-chat" id="chatContainer">
                    <div id="chatMessages">
                        <p><strong data-translate-key="aiAssistantName">Yazeed AI:</strong> <span data-translate-key="aiWelcomeMessage">Welcome! I'm your smart assistant for analyzing Saudi Mais Co.'s situation. I'll provide comprehensive analysis of the financial situation and strategies for crisis recovery.</span></p>
                    </div>
                </div>
                <div class="input-group">
                    <input type="text" id="userInput" data-translate-key="aiChatInputPlaceholder" placeholder="Ask about financial analysis or recovery strategies...">
                    <button class="btn" onclick="sendMessage()" data-translate-key="sendBtn">Send</button>
                    <button class="btn" onclick="startComprehensiveAnalysis()" data-translate-key="comprehensiveAnalysisBtn">Comprehensive Analysis</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script>
        // System variables
        let currentSection = 'overview';
        let uploadedFiles = {}; // Stores File objects
        let fileContents = {}; // Stores extracted text content from files
        let analysisHistory = {};
        let currentLanguage = localStorage.getItem('maisLang') || 'en';
        let marketChartInstance, financialChartInstance;


        const translations = {
            en: {
                pageTitle: "Smart Business Analytics - Saudi Mais Co",
                apiStatusConnected: "üü¢ Connected to Yazeed AI API",
                apiStatusDisconnected: "üî¥ Not connected to Yazeed AI API",
                mainTitle: "üîç Smart Business Analytics",
                companyNameHeader: "Saudi Mais Co. Medical Products",
                headerSubtitle: "Advanced AI-powered analysis system for financial crisis resolution",
                navOverview: "üè† Overview",
                navAdvancedAnalysis: "üìä Advanced Analysis",
                navQualityManagement: "üè• Quality Management",
                navDemandForecasting: "üìà Demand Forecasting",
                navCompetitorAnalysis: "üéØ Competitor Analysis",
                navAiAssistant: "ü§ñ AI Assistant",
                companyInfoTitle: "üìã Company Information",
                yearFounded: "Year Founded",
                riyadh: "Riyadh",
                headquarters: "Headquarters",
                medical: "Medical",
                specializedProducts: "Specialized Products",
                middleEast: "Middle East",
                targetMarket: "Target Market",
                overviewCompanyDesc: "Saudi Mais Co. is a leading provider of medical products, committed to enhancing healthcare standards in the region through innovation and quality.",
                marketAnalysisTitle: "Market Analysis",
                financialAnalysisTitle: "Financial Analysis",
                advancedAnalyticsSystemTitle: "Advanced Data Analytics System",
                advancedAnalyticsSystemDesc: "Comprehensive analysis of market trends and operational performance with strategic recommendations for Saudi Mais Co.",
                textInputBtn: "üìù Text Input",
                fileUploadBtn: "üìÅ File Upload",
                advancedTextInputPlaceholder: "Enter company data for advanced analysis (financial data, sales, production, etc...) specific to Saudi Mais Co.",
                advancedFocusInputPlaceholder: "Specific focus areas for Saudi Mais Co. (e.g., 'Analyze competitor impact in respiratory products sector', 'Evaluate new regulation effects on Saudi Mais Co.')",
                dragFileHere: "üìÅ Drag file here or click to select",
                supportedFileTypes: "Supports: Excel, CSV, PDF, Word, TXT",
                advancedFocusInputFilePlaceholder: "Specific focus areas for file analysis related to Saudi Mais Co.",
                startAdvancedAnalysisBtn: "üöÄ Start Advanced Analysis",
                advancedStep1Text: "üìÑ Processing input/file for Saudi Mais Co. analysis...",
                advancedStep2Text: "üîÑ Sending data to Yazeed AI for Saudi Mais Co. context...",
                advancedStep3Text: "üß† AI analysis for Saudi Mais Co. in progress...",
                advancedStep4Text: "üìä Formatting results for Saudi Mais Co...",
                advancedAnalysisResultsTitle: "üìä Advanced Analysis Results for Saudi Mais Co.",
                exportTxtBtn: "üìÑ Export TXT",
                exportMdBtn: "üìù Export MD",
                exportPdfBtn: "üìë Export PDF",
                qualityManagementSystemTitle: "Smart Quality Management System for Saudi Mais Co.",
                qualityManagementSystemDesc: "Quality monitoring according to international standards (ISO 13485) and FDA requirements for Saudi Mais Co.",
                qualityTextInputPlaceholder: "Enter quality data for Saudi Mais Co. (production defects, customer complaints, test results, etc...)",
                qualityFocusInputPlaceholder: "Quality focus areas for Saudi Mais Co. (e.g., 'ISO compliance assessment', 'Customer satisfaction analysis')",
                dragQualityFile: "üìÅ Drag quality data file here for Saudi Mais Co.",
                qualityFileTypes: "Quality reports, inspection records, customer complaints (Saudi Mais Co.)",
                qualityFocusInputFilePlaceholder: "Quality analysis focus areas from file for Saudi Mais Co.",
                analyzeQualityBtn: "üîç Analyze Quality for Saudi Mais Co.",
                qualityStep1Text: "üìÑ Reading quality data for Saudi Mais Co....",
                qualityStep2Text: "üîÑ Sending to AI for Saudi Mais Co. quality analysis...",
                qualityStep3Text: "üè• Quality assessment for Saudi Mais Co. in progress...",
                qualityStep4Text: "üìä Generating quality report for Saudi Mais Co....",
                qualityAnalysisResultsTitle: "üè• Quality Analysis Results for Saudi Mais Co.",
                demandForecastingSystemTitle: "Demand Forecasting & Inventory System for Saudi Mais Co.",
                demandForecastingSystemDesc: "Predict future demand and optimize inventory levels for Saudi Mais Co. using artificial intelligence",
                demandTextInputPlaceholder: "Enter historical sales and inventory data for Saudi Mais Co. (periods, quantities, seasons, etc...)",
                demandFocusInputPlaceholder: "Forecasting focus for Saudi Mais Co. (e.g., 'Q4 seasonal trends', 'New product demand projection')",
                dragDemandFile: "üìÅ Drag sales and inventory data file for Saudi Mais Co.",
                demandFileTypes: "Historical sales data, inventory levels (Saudi Mais Co.)",
                demandFocusInputFilePlaceholder: "Demand forecasting focus areas from file for Saudi Mais Co.",
                forecastDemandBtn: "üìä Forecast Demand for Saudi Mais Co.",
                demandStep1Text: "üìÑ Processing historical data for Saudi Mais Co....",
                demandStep2Text: "üîÑ AI model preparation for Saudi Mais Co. demand...",
                demandStep3Text: "üìà Generating forecasts for Saudi Mais Co....",
                demandStep4Text: "üìä Creating inventory recommendations for Saudi Mais Co....",
                demandForecastingResultsTitle: "üìà Demand Forecasting Results for Saudi Mais Co.",
                competitorAnalysisSystemTitle: "Competitor Analysis System for Saudi Mais Co.",
                competitorAnalysisSystemDesc: "Comprehensive competitive analysis in the medical equipment market for Saudi Mais Co. and strategic opportunity identification",
                competitorTextInputPlaceholder: "Enter competitor data relevant to Saudi Mais Co. (company names, prices, services, strengths and weaknesses, etc...)",
                competitorFocusInputPlaceholder: "Competitive analysis focus for Saudi Mais Co. (e.g., 'Pricing strategy comparison', 'Market positioning analysis')",
                dragCompetitorFile: "üìÅ Drag competitor data file for Saudi Mais Co. analysis",
                competitorFileTypes: "Market reports, competitor information, comparison studies (Saudi Mais Co.)",
                competitorFocusInputFilePlaceholder: "Competitor analysis focus areas from file for Saudi Mais Co.",
                analyzeCompetitionBtn: "üîé Analyze Competition for Saudi Mais Co.",
                competitorStep1Text: "üìÑ Processing competitor data for Saudi Mais Co. context...",
                competitorStep2Text: "üîÑ Market analysis in progress for Saudi Mais Co....",
                competitorStep3Text: "üéØ Competitive positioning analysis for Saudi Mais Co....",
                competitorStep4Text: "üìä Strategic recommendations generation for Saudi Mais Co....",
                competitorAnalysisResultsTitle: "üéØ Competitor Analysis Results for Saudi Mais Co.",
                aiAssistantTitle: "ü§ñ Yazeed AI Smart Assistant for Saudi Mais Co.",
                aiAssistantName: "Yazeed AI (Saudi Mais Co. Specialist):",
                aiWelcomeMessage: "Welcome! I'm your smart assistant for analyzing Saudi Mais Co.'s situation. I specialize in providing comprehensive analysis of its financial situation and strategies for crisis recovery, leveraging its unique profile.",
                aiChatInputPlaceholder: "Ask about Saudi Mais Co. financial analysis or recovery strategies...",
                sendBtn: "Send",
                comprehensiveAnalysisBtn: "Comprehensive Analysis for Saudi Mais Co.",
                fileProcessingMessage: "Reading file:", 
                fileReadSuccessMessage: "‚úÖ File ready:", 
                fileSizeLabel: "Size:",
                fileContentPreviewLabel: "Content preview (first 200 chars):",
                removeFileBtn: "üóëÔ∏è Remove File",
                fileReadError: "‚ùå Error reading file:",
                alertNoData: "Please enter data or upload a file for analysis related to Saudi Mais Co.",
                alertPdfExport: "PDF export feature requires an additional library. Exporting as text instead.",
                analysisFailedMsg: '<div class="critical-box"><h4>Analysis Failed</h4><p>Apologies, the analysis for Saudi Mais Co. could not be completed. Please check your input or try again later. If the problem persists, contact support.</p></div>',
                marketChartLabelCurrent: 'Current Status',
                marketChartLabelTarget: 'Future Target',
                marketChartLabels: ['Market Size', 'Growth', 'Competition', 'Quality', 'Price', 'Distribution'],
                financialChartLabelRevenue: 'Revenue (Million SAR)',
                financialChartLabelProfit: 'Profit (Million SAR)',
                financialChartLabels: ['2020', '2021', '2022', '2023', '2024', '2025 (Planned)'],
                loadingAnalysisText: "Analysis for Saudi Mais Co. in progress...",
                loadingQueryText: "Analyzing your query regarding Saudi Mais Co....",
                loadingComprehensiveAnalysisText: "Generating comprehensive business analysis for Saudi Mais Co....",
                comprehensiveAnalysisResultTitle: "Comprehensive Analysis for Saudi Mais Co.:",
                defaultFileName: "Uploaded File",
                simulatedDocxMessage: "Simulated DOCX content. Full parsing requires a dedicated library.",
                simulatedPdfMessage: "Simulated PDF reference. Full parsing requires a dedicated library."
            },
            ar: {
                pageTitle: "ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ÿßŸÑÿ£ÿπŸÖÿßŸÑ ÿßŸÑÿ∞ŸÉŸäÿ© - ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                apiStatusConnected: "üü¢ ŸÖÿ™ÿµŸÑ ÿ®ŸÄ Yazeed AI API",
                apiStatusDisconnected: "üî¥ ÿ∫Ÿäÿ± ŸÖÿ™ÿµŸÑ ÿ®ŸÄ Yazeed AI API",
                mainTitle: "üîç ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ÿßŸÑÿ£ÿπŸÖÿßŸÑ ÿßŸÑÿ∞ŸÉŸäÿ©",
                companyNameHeader: "ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©",
                headerSubtitle: "ŸÜÿ∏ÿßŸÖ ÿ™ÿ≠ŸÑŸäŸÑ ŸÖÿ™ŸÇÿØŸÖ ŸÖÿØÿπŸàŸÖ ÿ®ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä ŸÑÿ≠ŸÑ ÿßŸÑÿ£ÿ≤ŸÖÿßÿ™ ÿßŸÑŸÖÿßŸÑŸäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                navOverview: "üè† ŸÜÿ∏ÿ±ÿ© ÿπÿßŸÖÿ©",
                navAdvancedAnalysis: "üìä ÿ™ÿ≠ŸÑŸäŸÑ ŸÖÿ™ŸÇÿØŸÖ",
                navQualityManagement: "üè• ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ¨ŸàÿØÿ©",
                navDemandForecasting: "üìà ÿ™ŸàŸÇÿπÿßÿ™ ÿßŸÑÿ∑ŸÑÿ®",
                navCompetitorAnalysis: "üéØ ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜ",
                navAiAssistant: "ü§ñ ŸÖÿ≥ÿßÿπÿØ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä",
                companyInfoTitle: "üìã ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ¥ÿ±ŸÉÿ©",
                yearFounded: "ÿ≥ŸÜÿ© ÿßŸÑÿ™ÿ£ÿ≥Ÿäÿ≥",
                riyadh: "ÿßŸÑÿ±Ÿäÿßÿ∂",
                headquarters: "ÿßŸÑŸÖŸÇÿ± ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä",
                medical: "ÿ∑ÿ®Ÿäÿ©",
                specializedProducts: "ŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÖÿ™ÿÆÿµÿµÿ©",
                middleEast: "ÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑",
                targetMarket: "ÿßŸÑÿ≥ŸàŸÇ ÿßŸÑŸÖÿ≥ÿ™ŸáÿØŸÅ",
                overviewCompanyDesc: "ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸáŸä ÿ•ÿ≠ÿØŸâ ÿßŸÑÿ¥ÿ±ŸÉÿßÿ™ ÿßŸÑÿ±ÿßÿ¶ÿØÿ© ŸÅŸä ŸÖÿ¨ÿßŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©ÿå Ÿàÿ™ŸÑÿ™ÿ≤ŸÖ ÿ®ÿ™ÿπÿ≤Ÿäÿ≤ ŸÖÿπÿßŸäŸäÿ± ÿßŸÑÿ±ÿπÿßŸäÿ© ÿßŸÑÿµÿ≠Ÿäÿ© ŸÅŸä ÿßŸÑŸÖŸÜÿ∑ŸÇÿ© ŸÖŸÜ ÿÆŸÑÿßŸÑ ÿßŸÑÿßÿ®ÿ™ŸÉÿßÿ± ŸàÿßŸÑÿ¨ŸàÿØÿ©.",
                marketAnalysisTitle: "ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ≥ŸàŸÇ",
                financialAnalysisTitle: "ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖÿßŸÑŸä",
                advancedAnalyticsSystemTitle: "ŸÜÿ∏ÿßŸÖ ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ™ŸÇÿØŸÖ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                advancedAnalyticsSystemDesc: "ÿ™ÿ≠ŸÑŸäŸÑ ÿ¥ÿßŸÖŸÑ ŸÑÿßÿ™ÿ¨ÿßŸáÿßÿ™ ÿßŸÑÿ≥ŸàŸÇ ŸàÿßŸÑÿ£ÿØÿßÿ° ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑŸä ŸÖÿπ ÿ™ŸàÿµŸäÿßÿ™ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                textInputBtn: "üìù ÿ•ÿØÿÆÿßŸÑ ŸÜÿµŸä",
                fileUploadBtn: "üìÅ ÿ±ŸÅÿπ ŸÖŸÑŸÅ",
                advancedTextInputPlaceholder: "ÿ£ÿØÿÆŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÑŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖÿ™ŸÇÿØŸÖ (ÿ®ŸäÿßŸÜÿßÿ™ ŸÖÿßŸÑŸäÿ©ÿå ŸÖÿ®Ÿäÿπÿßÿ™ÿå ÿ•ŸÜÿ™ÿßÿ¨ÿå ÿ•ŸÑÿÆ...)",
                advancedFocusInputPlaceholder: "ŸÖÿ¨ÿßŸÑÿßÿ™ ÿ™ÿ±ŸÉŸäÿ≤ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© (ŸÖÿ´ÿßŸÑ: 'ÿ™ÿ≠ŸÑŸäŸÑ ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜ ŸÅŸä ŸÇÿ∑ÿßÿπ ŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ¨Ÿáÿßÿ≤ ÿßŸÑÿ™ŸÜŸÅÿ≥Ÿä'ÿå 'ÿ™ŸÇŸäŸäŸÖ ÿ¢ÿ´ÿßÿ± ÿßŸÑÿ™ŸÜÿ∏ŸäŸÖÿßÿ™ ÿßŸÑÿ¨ÿØŸäÿØÿ© ÿπŸÑŸâ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©')",
                dragFileHere: "üìÅ ÿßÿ≥ÿ≠ÿ® ÿßŸÑŸÖŸÑŸÅ ŸáŸÜÿß ÿ£Ÿà ÿßŸÜŸÇÿ± ŸÑŸÑÿßÿÆÿ™Ÿäÿßÿ±",
                supportedFileTypes: "ŸäÿØÿπŸÖ: Excel, CSV, PDF, Word, TXT",
                advancedFocusInputFilePlaceholder: "ŸÖÿ¨ÿßŸÑÿßÿ™ ÿ™ÿ±ŸÉŸäÿ≤ ŸÖÿ≠ÿØÿØÿ© ŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿÆÿßÿµ ÿ®ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                startAdvancedAnalysisBtn: "üöÄ ÿ®ÿØÿ° ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖÿ™ŸÇÿØŸÖ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                advancedStep1Text: "üìÑ ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ•ÿØÿÆÿßŸÑ/ÿßŸÑŸÖŸÑŸÅ ŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                advancedStep2Text: "üîÑ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ•ŸÑŸâ Yazeed AI ŸÑÿ≥ŸäÿßŸÇ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                advancedStep3Text: "üß† ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÇŸäÿØ ÿßŸÑÿ™ŸÇÿØŸÖ...",
                advancedStep4Text: "üìä ÿ™ŸÜÿ≥ŸäŸÇ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿÆÿßÿµÿ© ÿ®ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                advancedAnalysisResultsTitle: "üìä ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖÿ™ŸÇÿØŸÖ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                exportTxtBtn: "üìÑ ÿ™ÿµÿØŸäÿ± TXT",
                exportMdBtn: "üìù ÿ™ÿµÿØŸäÿ± MD",
                exportPdfBtn: "üìë ÿ™ÿµÿØŸäÿ± PDF",
                qualityManagementSystemTitle: "ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ¨ŸàÿØÿ© ÿßŸÑÿ∞ŸÉŸä ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                qualityManagementSystemDesc: "ŸÖÿ±ÿßŸÇÿ®ÿ© ÿßŸÑÿ¨ŸàÿØÿ© ŸàŸÅŸÇŸãÿß ŸÑŸÑŸÖÿπÿßŸäŸäÿ± ÿßŸÑÿØŸàŸÑŸäÿ© (ISO 13485) ŸàŸÖÿ™ÿ∑ŸÑÿ®ÿßÿ™ FDA ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                qualityTextInputPlaceholder: "ÿ£ÿØÿÆŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ¨ŸàÿØÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© (ÿπŸäŸàÿ® ÿßŸÑÿ•ŸÜÿ™ÿßÿ¨ÿå ÿ¥ŸÉÿßŸàŸâ ÿßŸÑÿπŸÖŸÑÿßÿ°ÿå ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±ÿßÿ™ÿå ÿ•ŸÑÿÆ...)",
                qualityFocusInputPlaceholder: "ŸÖÿ¨ÿßŸÑÿßÿ™ ÿ™ÿ±ŸÉŸäÿ≤ ÿßŸÑÿ¨ŸàÿØÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© (ŸÖÿ´ÿßŸÑ: 'ÿ™ŸÇŸäŸäŸÖ ÿßŸÑÿßŸÖÿ™ÿ´ÿßŸÑ ŸÑŸÄ ISO'ÿå 'ÿ™ÿ≠ŸÑŸäŸÑ ÿ±ÿ∂ÿß ÿßŸÑÿπŸÖŸÑÿßÿ°')",
                dragQualityFile: "üìÅ ÿßÿ≥ÿ≠ÿ® ŸÖŸÑŸÅ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ¨ŸàÿØÿ© ŸáŸÜÿß ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                qualityFileTypes: "ÿ™ŸÇÿßÿ±Ÿäÿ± ÿßŸÑÿ¨ŸàÿØÿ©ÿå ÿ≥ÿ¨ŸÑÿßÿ™ ÿßŸÑŸÅÿ≠ÿµÿå ÿ¥ŸÉÿßŸàŸâ ÿßŸÑÿπŸÖŸÑÿßÿ° (ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©)",
                qualityFocusInputFilePlaceholder: "ŸÖÿ¨ÿßŸÑÿßÿ™ ÿ™ÿ±ŸÉŸäÿ≤ ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ¨ŸàÿØÿ© ŸÖŸÜ ÿßŸÑŸÖŸÑŸÅ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                analyzeQualityBtn: "üîç ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ¨ŸàÿØÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                qualityStep1Text: "üìÑ ŸÇÿ±ÿßÿ°ÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ¨ŸàÿØÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                qualityStep2Text: "üîÑ ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿ•ŸÑŸâ ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä ŸÑÿ¨ŸàÿØÿ© ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                qualityStep3Text: "üè• ÿ™ŸÇŸäŸäŸÖ ÿßŸÑÿ¨ŸàÿØÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÇŸäÿØ ÿßŸÑÿ™ŸÇÿØŸÖ...",
                qualityStep4Text: "üìä ÿ•ŸÜÿ¥ÿßÿ° ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑÿ¨ŸàÿØÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                qualityAnalysisResultsTitle: "üè• ŸÜÿ™ÿßÿ¶ÿ¨ ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ¨ŸàÿØÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                demandForecastingSystemTitle: "ŸÜÿ∏ÿßŸÖ ÿ™ŸàŸÇÿπÿßÿ™ ÿßŸÑÿ∑ŸÑÿ® ŸàÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                demandForecastingSystemDesc: "ÿ™ŸàŸÇÿπ ÿßŸÑÿ∑ŸÑÿ® ÿßŸÑŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸä Ÿàÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖÿ≥ÿ™ŸàŸäÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä",
                demandTextInputPlaceholder: "ÿ£ÿØÿÆŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ ŸàÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ÿßŸÑÿ™ÿßÿ±ŸäÿÆŸäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© (ŸÅÿ™ÿ±ÿßÿ™ÿå ŸÉŸÖŸäÿßÿ™ÿå ŸÖŸàÿßÿ≥ŸÖÿå ÿ•ŸÑÿÆ...)",
                demandFocusInputPlaceholder: "ÿ™ÿ±ŸÉŸäÿ≤ ÿßŸÑÿ™ŸàŸÇÿπÿßÿ™ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© (ŸÖÿ´ÿßŸÑ: 'ÿßÿ™ÿ¨ÿßŸáÿßÿ™ ŸÖŸàÿ≥ŸÖŸäÿ© ŸÑŸÑÿ±ÿ®ÿπ ÿßŸÑÿ±ÿßÿ®ÿπ'ÿå 'ÿ™ŸàŸÇÿπ ÿßŸÑÿ∑ŸÑÿ® ÿπŸÑŸâ ŸÖŸÜÿ™ÿ¨ ÿ¨ÿØŸäÿØ')",
                dragDemandFile: "üìÅ ÿßÿ≥ÿ≠ÿ® ŸÖŸÑŸÅ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ ŸàÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                demandFileTypes: "ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ ÿßŸÑÿ™ÿßÿ±ŸäÿÆŸäÿ©ÿå ŸÖÿ≥ÿ™ŸàŸäÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ (ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©)",
                demandFocusInputFilePlaceholder: "ŸÖÿ¨ÿßŸÑÿßÿ™ ÿ™ÿ±ŸÉŸäÿ≤ ÿ™ŸàŸÇÿπÿßÿ™ ÿßŸÑÿ∑ŸÑÿ® ŸÖŸÜ ÿßŸÑŸÖŸÑŸÅ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                forecastDemandBtn: "üìä ÿ™ŸàŸÇÿπ ÿßŸÑÿ∑ŸÑÿ® ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                demandStep1Text: "üìÑ ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿßÿ±ŸäÿÆŸäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                demandStep2Text: "üîÑ ÿ•ÿπÿØÿßÿØ ŸÜŸÖŸàÿ∞ÿ¨ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä ŸÑÿ∑ŸÑÿ® ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                demandStep3Text: "üìà ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ™ŸàŸÇÿπÿßÿ™ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                demandStep4Text: "üìä ÿ•ŸÜÿ¥ÿßÿ° ÿ™ŸàÿµŸäÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                demandForecastingResultsTitle: "üìà ŸÜÿ™ÿßÿ¶ÿ¨ ÿ™ŸàŸÇÿπÿßÿ™ ÿßŸÑÿ∑ŸÑÿ® ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                competitorAnalysisSystemTitle: "ŸÜÿ∏ÿßŸÖ ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                competitorAnalysisSystemDesc: "ÿ™ÿ≠ŸÑŸäŸÑ ÿ™ŸÜÿßŸÅÿ≥Ÿä ÿ¥ÿßŸÖŸÑ ŸÅŸä ÿ≥ŸàŸÇ ÿßŸÑŸÖÿπÿØÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© Ÿàÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÅÿ±ÿµ ÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ©",
                competitorTextInputPlaceholder: "ÿ£ÿØÿÆŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜ ÿ∞ÿßÿ™ ÿßŸÑÿµŸÑÿ© ÿ®ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© (ÿ£ÿ≥ŸÖÿßÿ° ÿßŸÑÿ¥ÿ±ŸÉÿßÿ™ÿå ÿßŸÑÿ£ÿ≥ÿπÿßÿ±ÿå ÿßŸÑÿÆÿØŸÖÿßÿ™ÿå ŸÜŸÇÿßÿ∑ ÿßŸÑŸÇŸàÿ© ŸàÿßŸÑÿ∂ÿπŸÅÿå ÿ•ŸÑÿÆ...)",
                competitorFocusInputPlaceholder: "ÿ™ÿ±ŸÉŸäÿ≤ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ™ŸÜÿßŸÅÿ≥Ÿä ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© (ŸÖÿ´ÿßŸÑ: 'ŸÖŸÇÿßÿ±ŸÜÿ© ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ÿßŸÑÿ™ÿ≥ÿπŸäÿ±'ÿå 'ÿ™ÿ≠ŸÑŸäŸÑ ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ ŸÅŸä ÿßŸÑÿ≥ŸàŸÇ')",
                dragCompetitorFile: "üìÅ ÿßÿ≥ÿ≠ÿ® ŸÖŸÑŸÅ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜ ŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                competitorFileTypes: "ÿ™ŸÇÿßÿ±Ÿäÿ± ÿßŸÑÿ≥ŸàŸÇÿå ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜÿå ÿØÿ±ÿßÿ≥ÿßÿ™ ŸÖŸÇÿßÿ±ŸÜÿ© (ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©)",
                competitorFocusInputFilePlaceholder: "ŸÖÿ¨ÿßŸÑÿßÿ™ ÿ™ÿ±ŸÉŸäÿ≤ ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜ ŸÖŸÜ ÿßŸÑŸÖŸÑŸÅ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                analyzeCompetitionBtn: "üîé ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖŸÜÿßŸÅÿ≥ÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                competitorStep1Text: "üìÑ ŸÖÿπÿßŸÑÿ¨ÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜ ŸÑÿ≥ŸäÿßŸÇ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                competitorStep2Text: "üîÑ ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ≥ŸàŸÇ ŸÇŸäÿØ ÿßŸÑÿ™ŸÇÿØŸÖ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                competitorStep3Text: "üéØ ÿ™ÿ≠ŸÑŸäŸÑ ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑÿ™ŸÜÿßŸÅÿ≥Ÿä ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                competitorStep4Text: "üìä ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ™ŸàÿµŸäÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                competitorAnalysisResultsTitle: "üéØ ŸÜÿ™ÿßÿ¶ÿ¨ ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                aiAssistantTitle: "ü§ñ ŸÖÿ≥ÿßÿπÿØ Ÿäÿ≤ŸäÿØ ÿßŸÑÿ∞ŸÉŸä ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                aiAssistantName: "Ÿäÿ≤ŸäÿØ AI (ŸÖÿ™ÿÆÿµÿµ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©):",
                aiWelcomeMessage: "ŸÖÿ±ÿ≠ÿ®ÿßŸã! ÿ£ŸÜÿß ŸÖÿ≥ÿßÿπÿØŸÉ ÿßŸÑÿ∞ŸÉŸä ŸÑÿ™ÿ≠ŸÑŸäŸÑ Ÿàÿ∂ÿπ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©. ÿ£ŸÜÿß ŸÖÿ™ÿÆÿµÿµ ŸÅŸä ÿ™ŸÇÿØŸäŸÖ ÿ™ÿ≠ŸÑŸäŸÑ ÿ¥ÿßŸÖŸÑ ŸÑŸàÿ∂ÿπŸáÿß ÿßŸÑŸÖÿßŸÑŸä Ÿàÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿßÿ™ ÿßŸÑÿ™ÿπÿßŸÅŸä ŸÖŸÜ ÿßŸÑÿ£ÿ≤ŸÖÿßÿ™ÿå ŸÖÿπ ÿßŸÑÿßÿ≥ÿ™ŸÅÿßÿØÿ© ŸÖŸÜ ŸÖŸÑŸÅŸáÿß ÿßŸÑÿ™ÿπÿ±ŸäŸÅŸä ÿßŸÑŸÅÿ±ŸäÿØ.",
                aiChatInputPlaceholder: "ÿßÿ≥ÿ£ŸÑ ÿπŸÜ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖÿßŸÑŸä ÿ£Ÿà ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿßÿ™ ÿßŸÑÿ™ÿπÿßŸÅŸä ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                sendBtn: "ÿ•ÿ±ÿ≥ÿßŸÑ",
                comprehensiveAnalysisBtn: "ÿ™ÿ≠ŸÑŸäŸÑ ÿ¥ÿßŸÖŸÑ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©",
                fileProcessingMessage: "ŸÇÿ±ÿßÿ°ÿ© ÿßŸÑŸÖŸÑŸÅ:",
                fileReadSuccessMessage: "‚úÖ ÿßŸÑŸÖŸÑŸÅ ÿ¨ÿßŸáÿ≤:",
                fileSizeLabel: "ÿßŸÑÿ≠ÿ¨ŸÖ:",
                fileContentPreviewLabel: "ŸÖÿπÿßŸäŸÜÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ (ÿ£ŸàŸÑ 200 ÿ≠ÿ±ŸÅ):",
                removeFileBtn: "üóëÔ∏è ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑŸÖŸÑŸÅ",
                fileReadError: "‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ŸÇÿ±ÿßÿ°ÿ© ÿßŸÑŸÖŸÑŸÅ:",
                alertNoData: "ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿ£Ÿà ÿ±ŸÅÿπ ŸÖŸÑŸÅ ŸÑŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿÆÿßÿµ ÿ®ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©.",
                alertPdfExport: "ŸÖŸäÿ≤ÿ© ÿ™ÿµÿØŸäÿ± PDF ÿ™ÿ™ÿ∑ŸÑÿ® ŸÖŸÉÿ™ÿ®ÿ© ÿ•ÿ∂ÿßŸÅŸäÿ©. ÿ≥Ÿäÿ™ŸÖ ÿßŸÑÿ™ÿµÿØŸäÿ± ŸÉŸÜÿµ ÿ®ÿØŸÑÿßŸã ŸÖŸÜ ÿ∞ŸÑŸÉ.",
                analysisFailedMsg: '<div class="critical-box"><h4>ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ</h4><p>ÿπÿ∞ÿ±ÿßŸãÿå ŸÑŸÖ Ÿäÿ™ŸÖ ÿ•ŸÉŸÖÿßŸÑ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿÆÿßÿµ ÿ®ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ŸÖÿØÿÆŸÑÿßÿ™ŸÉ ÿ£Ÿà ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ ŸÑÿßÿ≠ŸÇÿßŸã. ÿ•ÿ∞ÿß ÿßÿ≥ÿ™ŸÖÿ±ÿ™ ÿßŸÑŸÖÿ¥ŸÉŸÑÿ©ÿå Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿØÿπŸÖ.</p></div>',
                marketChartLabelCurrent: 'ÿßŸÑŸàÿ∂ÿπ ÿßŸÑÿ≠ÿßŸÑŸä',
                marketChartLabelTarget: 'ÿßŸÑŸáÿØŸÅ ÿßŸÑŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸä',
                marketChartLabels: ['ÿ≠ÿ¨ŸÖ ÿßŸÑÿ≥ŸàŸÇ', 'ÿßŸÑŸÜŸÖŸà', 'ÿßŸÑŸÖŸÜÿßŸÅÿ≥ÿ©', 'ÿßŸÑÿ¨ŸàÿØÿ©', 'ÿßŸÑÿ≥ÿπÿ±', 'ÿßŸÑÿ™Ÿàÿ≤Ÿäÿπ'],
                financialChartLabelRevenue: 'ÿßŸÑÿ•Ÿäÿ±ÿßÿØÿßÿ™ (ŸÖŸÑŸäŸàŸÜ ÿ±ŸäÿßŸÑ)',
                financialChartLabelProfit: 'ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠ (ŸÖŸÑŸäŸàŸÜ ÿ±ŸäÿßŸÑ)',
                financialChartLabels: ['2020', '2021', '2022', '2023', '2024', '2025 (ŸÖÿÆÿ∑ÿ∑)'],
                loadingAnalysisText: "ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿÆÿßÿµ ÿ®ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÇŸäÿØ ÿßŸÑÿ™ŸÇÿØŸÖ...",
                loadingQueryText: "ÿ™ÿ≠ŸÑŸäŸÑ ÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ±ŸÉ ÿ®ÿÆÿµŸàÿµ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                loadingComprehensiveAnalysisText: "ÿ•ŸÜÿ¥ÿßÿ° ÿ™ÿ≠ŸÑŸäŸÑ ÿ¥ÿßŸÖŸÑ ŸÑŸÑÿ£ÿπŸÖÿßŸÑ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©...",
                comprehensiveAnalysisResultTitle: "ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ¥ÿßŸÖŸÑ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©:",
                defaultFileName: "ŸÖŸÑŸÅ ŸÖÿ±ŸÅŸàÿπ",
                simulatedDocxMessage: "ŸÖÿ≠ÿ™ŸàŸâ DOCX ŸÖÿ≠ÿßŸÉŸâ. ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÉÿßŸÖŸÑ Ÿäÿ™ÿ∑ŸÑÿ® ŸÖŸÉÿ™ÿ®ÿ© ŸÖÿ™ÿÆÿµÿµÿ©.",
                simulatedPdfMessage: "ÿ•ÿ¥ÿßÿ±ÿ© ŸÑŸÖŸÑŸÅ PDF ŸÖÿ≠ÿßŸÉÿßÿ©. ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÉÿßŸÖŸÑ Ÿäÿ™ÿ∑ŸÑÿ® ŸÖŸÉÿ™ÿ®ÿ© ŸÖÿ™ÿÆÿµÿµÿ©."
            }
        };

        function setLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('maisLang', lang);
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';

            document.querySelectorAll('[data-translate-key]').forEach(el => {
                const key = el.getAttribute('data-translate-key');
                if (translations[lang] && translations[lang][key]) {
                    if (el.tagName === 'TEXTAREA' || (el.tagName === 'INPUT' && (el.type === 'text' || el.type === 'search' /* for AI input */))) {
                        el.placeholder = translations[lang][key];
                    } else {
                        el.innerHTML = translations[lang][key];
                    }
                }
            });
            
            document.getElementById('lang-en').classList.toggle('active', lang === 'en');
            document.getElementById('lang-ar').classList.toggle('active', lang === 'ar');
            
            initializeCharts();
            checkAPIConnection(); 
            Object.keys(uploadedFiles).forEach(section => {
                if (uploadedFiles[section]) {
                    updateFileStatusDisplay(section, uploadedFiles[section].name, fileContents[section] || "");
                }
            });
        }

        const GEMINI_API_KEY = 'AIzaSyAquNVYw6VOmAKTtKtTPU7Tl3PVIG0sKhg'; 
        const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent';

        function checkAPIConnection() {
            const statusElement = document.getElementById('apiStatus');
            const isConnected = GEMINI_API_KEY !== 'YOUR_GEMINI_API_KEY_HERE' && GEMINI_API_KEY.startsWith('AIza');
            const statusTextKey = isConnected ? 'apiStatusConnected' : 'apiStatusDisconnected';
            
            statusElement.className = `api-status ${isConnected ? 'api-connected' : 'api-disconnected'}`;
            const span = statusElement.querySelector('span') || document.createElement('span');
            span.setAttribute('data-translate-key', statusTextKey);
            span.innerHTML = translations[currentLanguage][statusTextKey];
            if (!statusElement.querySelector('span')) {
                statusElement.appendChild(span);
            }
        }

        function initializeCharts() {
            const currentLangTranslations = translations[currentLanguage];
            if (marketChartInstance) marketChartInstance.destroy();
            if (financialChartInstance) financialChartInstance.destroy();
            
            const chartLabelColor = 'rgba(255, 255, 255, 0.8)';
            const gridColor = 'rgba(255, 255, 255, 0.15)';
            const tickColor = 'rgba(255, 255, 255, 0.7)';

            const marketCtx = document.getElementById('marketChart');
            if (marketCtx) {
                marketChartInstance = new Chart(marketCtx.getContext('2d'), {
                    type: 'radar',
                    data: {
                        labels: currentLangTranslations.marketChartLabels,
                        datasets: [{
                            label: currentLangTranslations.marketChartLabelCurrent,
                            data: [40, 30, 25, 70, 60, 45],
                            backgroundColor: 'rgba(255, 99, 132, 0.3)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 2,
                            pointBackgroundColor: 'rgba(255, 99, 132, 1)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgba(255, 99, 132, 1)'
                        }, {
                            label: currentLangTranslations.marketChartLabelTarget,
                            data: [80, 75, 70, 90, 85, 80],
                            backgroundColor: 'rgba(54, 162, 235, 0.3)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 2,
                            pointBackgroundColor: 'rgba(54, 162, 235, 1)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgba(54, 162, 235, 1)'
                        }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { labels: { color: chartLabelColor, font: { size: 13 } } } },
                        scales: {
                            r: {
                                angleLines: { color: gridColor },
                                grid: { color: gridColor },
                                pointLabels: { color: chartLabelColor, font: { size: currentLanguage === 'ar' ? 11 : 12} },
                                ticks: { backdropColor: 'transparent', color: tickColor, stepSize: 20 }
                            }
                        },
                        elements: { line: { tension: 0.1 } }
                    }
                });
            }

            const financialCtx = document.getElementById('financialChart');
            if (financialCtx) {
                financialChartInstance = new Chart(financialCtx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: currentLangTranslations.financialChartLabels,
                        datasets: [{
                            label: currentLangTranslations.financialChartLabelRevenue,
                            data: [50, 45, 40, 35, 30, 60],
                            borderColor: 'rgb(75, 192, 192)',
                            backgroundColor: 'rgba(75, 192, 192, 0.3)',
                            tension: 0.4, fill: true,
                            pointRadius: 4, pointHoverRadius: 6
                        }, {
                            label: currentLangTranslations.financialChartLabelProfit,
                            data: [10, 5, 0, -5, -10, 15],
                            borderColor: 'rgb(255, 99, 132)',
                            backgroundColor: 'rgba(255, 99, 132, 0.3)',
                            tension: 0.4, fill: true,
                            pointRadius: 4, pointHoverRadius: 6
                        }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { labels: { color: chartLabelColor, font: {size: 13} } } },
                        scales: {
                            y: { grid: { color: gridColor }, ticks: { color: tickColor } },
                            x: { grid: { color: gridColor }, ticks: { color: tickColor } }
                        },
                        interaction: { intersect: false, mode: 'index' }
                    }
                });
            }
        }

        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            
            const activeSection = document.getElementById(sectionId);
            if (activeSection) activeSection.classList.add('active');
            
            const activeButton = document.querySelector(`.nav-btn[onclick*="showSection('${sectionId}')"]`);
            if (activeButton) activeButton.classList.add('active');
            
            currentSection = sectionId;
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function toggleInputMode(section, mode) {
            const textInputArea = document.getElementById(`${section}-text`);
            const fileInputArea = document.getElementById(`${section}-file`);
            const buttons = document.querySelectorAll(`#${section}.section .input-options .option-btn`);
            
            buttons.forEach(btn => btn.classList.remove('active'));
            
            if (mode === 'text') {
                if(textInputArea) textInputArea.classList.add('active');
                if(fileInputArea) fileInputArea.classList.remove('active');
                if(buttons[0]) buttons[0].classList.add('active');
            } else {
                if(textInputArea) textInputArea.classList.remove('active');
                if(fileInputArea) fileInputArea.classList.add('active');
                if(buttons[1]) buttons[1].classList.add('active');
            }
        }

        function updateFileStatusDisplay(section, fileName, fileContentPreview) {
            const fileStatusDiv = document.getElementById(`${section}FileStatus`);
            if (!fileStatusDiv) return;

            fileStatusDiv.style.display = 'block';
            fileStatusDiv.innerHTML = `
                <p><span class="file-name">${translations[currentLanguage].fileReadSuccessMessage} ${fileName || translations[currentLanguage].defaultFileName}</span></p>
                <p style="font-size: 0.9em;">${translations[currentLanguage].fileSizeLabel} ${(uploadedFiles[section]?.size / 1024).toFixed(2)} KB</p>
                <div class="file-preview" lang="${currentLanguage}" dir="${currentLanguage === 'ar' ? 'rtl' : 'ltr'}">
                    <strong>${translations[currentLanguage].fileContentPreviewLabel}</strong><br>
                    ${fileContentPreview.substring(0, 200).replace(/</g, "&lt;").replace(/>/g, "&gt;")}${fileContentPreview.length > 200 ? '...' : ''}
                </div>
                <button class="btn" onclick="clearFile('${section}')" style="margin-top: 10px; padding: 8px 12px; font-size: 12px;">${translations[currentLanguage].removeFileBtn}</button>
            `;
        }

        async function handleFileUpload(section, inputElement) {
            const file = inputElement.files[0];
            if (!file) return;

            uploadedFiles[section] = file;
            const fileStatusDiv = document.getElementById(`${section}FileStatus`);
            if (fileStatusDiv) {
                 fileStatusDiv.style.display = 'block';
                 fileStatusDiv.innerHTML = `<div class="loading-enhanced" style="margin: 0 auto; width: fit-content;"><div class="loading-dots"><div class="loading-dot"></div><div class="loading-dot"></div><div class="loading-dot"></div></div> ${translations[currentLanguage].fileProcessingMessage} ${file.name}</div>`;
            }

            try {
                let content = '';
                if (file.type === 'text/plain' || file.name.endsWith('.txt') || file.type === 'text/csv' || file.name.endsWith('.csv')) {
                    content = await readTextFile(file);
                } else if (file.type === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' || file.name.endsWith('.docx')) {
                    content = `${translations[currentLanguage].simulatedDocxMessage} (File: ${file.name})`; 
                } else if (file.type === 'application/pdf' || file.name.endsWith('.pdf')) {
                    content = `${translations[currentLanguage].simulatedPdfMessage} (File: ${file.name})`;
                } else {
                    content = `Binary file or unsupported type: ${file.name}`;
                }
                fileContents[section] = content;
                updateFileStatusDisplay(section, file.name, content);

            } catch (error) {
                if (fileStatusDiv) {
                    fileStatusDiv.innerHTML = `
                        <div style="background: rgba(244, 67, 54, 0.2); border: 1px solid rgba(244, 67, 54, 0.5); padding: 15px; border-radius: 10px;">
                            <p>${translations[currentLanguage].fileReadError} ${error.message}</p>
                            <button class="btn" onclick="clearFile('${section}')" style="margin-top: 10px;">${translations[currentLanguage].removeFileBtn}</button>
                        </div>`;
                }
                console.error("Error reading file:", error);
            }
        }

        function readTextFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = e => resolve(e.target.result);
                reader.onerror = e => reject(new Error('Failed to read file content.'));
                reader.readAsText(file);
            });
        }

        function clearFile(section) {
            delete uploadedFiles[section];
            delete fileContents[section];
            const fileInput = document.getElementById(`${section}FileInput`);
            if (fileInput) fileInput.value = ''; 
            
            const fileStatusDiv = document.getElementById(`${section}FileStatus`);
            if (fileStatusDiv) {
                fileStatusDiv.style.display = 'none';
                fileStatusDiv.innerHTML = '';
            }
        }

        function showAnalysisStatus(section, stepsKeys) {
            const statusElement = document.getElementById(`${section}Status`);
            if (!statusElement) return;
            statusElement.style.display = 'block';
            
            stepsKeys.forEach((key, index) => {
                const stepEl = document.getElementById(`${section}Step${index + 1}`);
                if (stepEl) {
                    stepEl.classList.remove('active');
                    stepEl.innerHTML = `‚è≥ ${translations[currentLanguage][key] || `Step ${index + 1}...`}`;
                }
            });
            
            let delay = 0;
            stepsKeys.forEach((key, index) => {
                setTimeout(() => {
                    const stepEl = document.getElementById(`${section}Step${index + 1}`);
                    if (stepEl) {
                         stepEl.classList.add('active');
                         if (index < stepsKeys.length -1 ) {
                            stepEl.innerHTML = `‚úÖ ${translations[currentLanguage][key] || `Step ${index + 1} Done`}`;
                         } else {
                            stepEl.innerHTML = `üèÅ ${translations[currentLanguage][key] || `Step ${index + 1} Done`}`;
                         }
                    }
                }, delay);
                delay += 700; 
            });
            
            setTimeout(() => {
                 if (statusElement) statusElement.style.display = 'none';
            }, delay + 1500);
        }

        async function callGeminiAPI(prompt, dataToConsider = "") {
            const langInstruction = currentLanguage === 'ar' ? "ÿßŸÑÿ±ÿ¨ÿßÿ° ÿßŸÑÿ±ÿØ ÿ®ÿßŸÑŸÑÿ∫ÿ© ÿßŸÑÿπÿ±ÿ®Ÿäÿ© ÿßŸÑŸÅÿµÿ≠Ÿâ ÿ®ÿ¥ŸÉŸÑ ŸÉÿßŸÖŸÑ ŸàŸÖŸÅÿµŸÑ ŸàŸÖŸÜÿ≥ŸÇ." : "Please respond in English fully, in detail, and well-formatted.";
            
            let contextDataInfo = "";
            if (dataToConsider) {
                contextDataInfo = currentLanguage === 'ar' ? 
                    `\n\nÿÆÿ∞ ŸÅŸä ÿßŸÑÿßÿπÿ™ÿ®ÿßÿ± ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿßŸÑŸäÿ© (ŸÖÿπÿßŸäŸÜÿ© ŸÖŸÜ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑŸÖÿ±ŸÅŸÇ: "${dataToConsider.substring(0, 100).replace(/\n/g, " ")}...") ŸÅŸä ÿ™ÿ≠ŸÑŸäŸÑŸÉÿå ŸÖÿπ ÿßŸÑÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸâ Ÿáÿ∞Ÿá ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ÿ¥ŸÉŸÑ ÿ£ÿ≥ÿßÿ≥Ÿä.` :
                    `\n\nConsider the following data (preview from attached file: "${dataToConsider.substring(0, 100).replace(/\n/g, " ")}...") in your analysis, focusing primarily on this data.`;
            }

            const fullPrompt = `${langInstruction}${contextDataInfo}\n\n${prompt}`;

            if (GEMINI_API_KEY === 'YOUR_GEMINI_API_KEY_HERE' || !GEMINI_API_KEY.startsWith('AIza')) {
                console.warn("Using simulated API response.");
                return await simulateGeminiResponse(prompt, dataToConsider);
            }

            try {
                const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: fullPrompt }] }]
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('Gemini API Error:', errorData);
                    throw new Error(`API Error: ${errorData.error?.message || response.statusText}`);
                }
                
                const data = await response.json();
                if (data.candidates && data.candidates[0]?.content?.parts?.[0]?.text) {
                    return data.candidates[0].content.parts[0].text;
                } else {
                     console.error('Unexpected API response structure:', data);
                     throw new Error('Invalid API response structure.');
                }
            } catch (error) {
                console.error('Error calling Gemini API:', error);
                return await simulateGeminiResponse(prompt, dataToConsider); 
            }
        }
        
        function formatContent(content) {
            let formatted = content;
            formatted = formatted.replace(/^#\s(.*?)$/gm, (match, p1) => p1.includes('<') ? match : `<h1>${p1}</h1>`);
            formatted = formatted.replace(/^##\s(.*?)$/gm, (match, p1) => p1.includes('<') ? match : `<h2>${p1}</h2>`);
            formatted = formatted.replace(/^###\s(.*?)$/gm, (match, p1) => p1.includes('<') ? match : `<h3>${p1}</h3>`);
            formatted = formatted.replace(/^####\s(.*?)$/gm, (match, p1) => p1.includes('<') ? match : `<h4>${p1}</h4>`);

            formatted = formatted.replace(/^\s*-\s(.*?)$/gm, (match, p1) => p1.includes('<') ? match : `<li>${p1}</li>`);
            formatted = formatted.replace(/^\s*\*\s(.*?)$/gm, (match, p1) => p1.includes('<') ? match : `<li>${p1}</li>`);
            formatted = formatted.replace(/(<li>.*?<\/li>(?:\s*<li>.*?<\/li>)*)/gs, (match) => {
                if (match.startsWith('<ul>') || match.startsWith('<ol>')) return match;
                return `<ul>${match}</ul>`;
            });

            formatted = formatted.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            formatted = formatted.replace(/\*(.*?)\*/g, '<em>$1</em>');
            
            const lines = formatted.split('\n');
            const newLines = lines.map(line => {
                const trimmedLine = line.trim();
                if (trimmedLine.length === 0) return ''; 
                if (trimmedLine.startsWith('<') && trimmedLine.endsWith('>')) { 
                    if (trimmedLine.match(/^<(ul|ol|li|h[1-6]|p|div|table|blockquote|pre|hr|br)/i) ||
                        trimmedLine.match(/<\/(ul|ol|li|h[1-6]|p|div|table|blockquote|pre)>$/i)) {
                        return line;
                    }
                }
                if (!trimmedLine.startsWith('<p>') && !trimmedLine.endsWith('</p>')) {
                     return `<p>${line}</p>`;
                }
                return line;
            });
            formatted = newLines.join('\n');

            return formatted;
        }

        async function simulateGeminiResponse(prompt, dataContent = "") {
            await new Promise(resolve => setTimeout(resolve, 1200)); 
            
            let dataMention = "";
            if (dataContent) {
                const preview = dataContent.substring(0, 70).replace(/\n/g, " ").replace(/</g, "&lt;");
                dataMention = currentLanguage === 'ar' ? 
                    `<div class="analysis-result-card"><p><em>(ŸÖŸÑÿßÿ≠ÿ∏ÿ©: Ÿäÿ≥ÿ™ŸÜÿØ Ÿáÿ∞ÿß ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖÿ≠ÿßŸÉŸâ ÿ•ŸÑŸâ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖŸÇÿØŸÖÿ© ŸÖŸÜ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ∞Ÿä Ÿäÿ®ÿØÿ£ ÿ®ŸÄ: "${preview}..." ŸÖÿπ ÿßŸÑÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸäŸáÿß ÿ®ÿ¥ŸÉŸÑ ÿ£ÿ≥ÿßÿ≥Ÿä.)</em></p></div>` :
                    `<div class="analysis-result-card"><p><em>(Note: This simulated analysis is primarily based on the provided file data starting with: "${preview}...")</em></p></div>`;
            }

            // Extracting simplified prompt identifiers for routing
            const lowerPrompt = prompt.toLowerCase();
            if (lowerPrompt.includes('advanced business analysis') || lowerPrompt.includes('ÿ™ÿ≠ŸÑŸäŸÑ ÿ£ÿπŸÖÿßŸÑ ŸÖÿ™ŸÇÿØŸÖ')) {
                return dataMention + (currentLanguage === 'ar' ? generateAdvancedAnalysisResponseAr(dataContent) : generateAdvancedAnalysisResponseEn(dataContent));
            } else if (lowerPrompt.includes('quality management system') || lowerPrompt.includes('ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ¨ŸàÿØÿ©')) {
                return dataMention + (currentLanguage === 'ar' ? generateQualityAnalysisResponseAr(dataContent) : generateQualityAnalysisResponseEn(dataContent));
            } else if (lowerPrompt.includes('demand forecasting') || lowerPrompt.includes('ÿ™ŸàŸÇÿπÿßÿ™ ÿßŸÑÿ∑ŸÑÿ®')) {
                return dataMention + (currentLanguage === 'ar' ? generateDemandForecastResponseAr(dataContent) : generateDemandForecastResponseEn(dataContent));
            } else if (lowerPrompt.includes('competitor analysis') || lowerPrompt.includes('ÿ™ÿ≠ŸÑŸäŸÑ ÿ™ŸÜÿßŸÅÿ≥Ÿä')) {
                return dataMention + (currentLanguage === 'ar' ? generateCompetitorAnalysisResponseAr(dataContent) : generateCompetitorAnalysisResponseEn(dataContent));
            } else if (lowerPrompt.includes('comprehensive strategic business analysis') || lowerPrompt.includes('ÿ™ÿ≠ŸÑŸäŸÑ ÿ£ÿπŸÖÿßŸÑ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿä ÿ¥ÿßŸÖŸÑ')) { // For AI Assistant
                return dataMention + (currentLanguage === 'ar' ? generateComprehensiveAnalysisResponseAr() : generateComprehensiveAnalysisResponseEn());
            }
             else { 
                return dataMention + (currentLanguage === 'ar' ? generateDefaultResponseAr(prompt) : generateDefaultResponseEn(prompt));
            }
        }

        // --- English Simulated Responses ---
        function generateAdvancedAnalysisResponseEn(data) {
            return `
                <h1>Advanced Business Analysis for Saudi Mais Co.</h1>
                ${data ? `<div class="analysis-result-card"><p><strong>Data Insight:</strong> Analysis incorporates provided data points from the uploaded file for Saudi Mais Co.</p></div>` : '<div class="analysis-result-card"><p><strong>Data Insight:</strong> Analysis based on general knowledge of Saudi Mais Co.</p></div>'}
                <div class="analysis-result-card">
                    <h2>1. Market Snapshot for Medical Consumables</h2>
                    <p>The Saudi medical device market, particularly for single-use consumables, is poised for significant expansion, heavily influenced by Vision 2030's healthcare infrastructure development. Key opportunities for Saudi Mais Co. lie in specialized sterile products and locally manufactured items aligning with IKTVA (In-Kingdom Total Value Add) program goals.</p>
                    <div class="metric-card">
                        <div class="metric-label">Projected Market Growth (CAGR - Medical Consumables KSA)</div>
                        <div class="metric-value">9.2% <span class="quality-indicator quality-excellent">Excellent</span></div>
                    </div>
                </div>
                <div class="analysis-result-card">
                    <h2>2. Financial Health Assessment of Saudi Mais Co.</h2>
                    <p>Current financials, potentially detailed in uploaded documents, likely indicate a need for strategic cost optimization, improved working capital management, and diversification of revenue streams beyond traditional products. Attention to liquidity ratios and gross profit margins on core product lines is critical.</p>
                    <div class="warning-box">
                        <h4>Liquidity & Profitability Focus</h4>
                        <p>If data indicates, the Quick Ratio and Net Profit Margin should be benchmarked against industry averages for Saudi medical manufacturers. Improving cash flow through better inventory turnover for consumables is a key recommendation.</p>
                    </div>
                </div>
                <div class="analysis-result-card">
                    <h2>3. Strategic Imperatives for Saudi Mais Co.</h2>
                    <ul>
                        <li>Enhance local manufacturing capabilities for a wider range of single-use medical devices to increase IKTVA contribution and reduce import reliance.</li>
                        <li>Invest in a robust digital QMS and ERP system to improve traceability, compliance (ISO 13485, SFDA), and operational efficiency.</li>
                        <li>Explore strategic partnerships with major hospital groups and governmental healthcare procurement agencies.</li>
                        <li>Develop or source innovative, cost-effective medical consumables tailored to regional needs.</li>
                    </ul>
                </div>
                <div class="recommendation-box">
                    <h4>Primary Recommendation for Saudi Mais Co.</h4>
                    <p>Prioritize strengthening local manufacturing excellence and achieving competitive cost structures for core single-use medical products. Simultaneously, explore niche, high-margin consumables and invest in digital tools to enhance market responsiveness and operational control, directly supporting Saudi Mais Co.'s commitment to quality and growth in the Middle East.</p>
                </div>
            `;
        }

        function generateQualityAnalysisResponseEn(data) {
            return `
                <h1>Quality Management System Review for Saudi Mais Co.</h1>
                ${data ? `<div class="analysis-result-card"><p><strong>Data Insight:</strong> Quality metrics from the provided data/document for Saudi Mais Co. have been central to this assessment.</p></div>` : '<div class="analysis-result-card"><p><strong>Data Insight:</strong> Assessment based on general QMS principles for medical device manufacturers like Saudi Mais Co.</p></div>'}
                <div class="analysis-result-card">
                    <h2>Overall Compliance & Effectiveness (ISO 13485 & SFDA)</h2>
                    <p>Saudi Mais Co. aims for the highest international quality standards. The QMS review, based on available information, suggests foundational adherence to ISO 13485. Continuous improvement efforts should focus on rigorous documentation for design controls (if applicable to their product development), risk management (ISO 14971), and post-market surveillance to ensure full alignment with SFDA requirements for medical consumables.</p>
                    <div class="metric-card">
                        <div class="metric-label">Internal Audit Non-Conformance Rate (Target <1%)</div>
                        <div class="metric-value">1.5% <span class="quality-indicator quality-warning">Needs Improvement</span></div>
                        <p style="font-size:0.8em; opacity:0.7;">(Example metric if data was provided)</p>
                    </div>
                </div>
                <div class="analysis-result-card">
                    <h2>Key Findings & Corrective/Preventive Actions (CAPA)</h2>
                    <ol>
                        <li><strong>Finding (Example):</strong> Inconsistent traceability in batch records for a specific consumable product line. <strong>Action:</strong> Implement enhanced digital batch recording with mandatory field entries; conduct targeted retraining for production staff at Saudi Mais Co.</li>
                        <li><strong>Finding (Example):</strong> Supplier quality audit schedule adherence below target. <strong>Action:</strong> Revise supplier audit plan based on risk; allocate dedicated resources for timely execution.</li>
                        <li><strong>Finding (Example):</strong> Customer complaint resolution times for defective consumables exceed internal KPIs. <strong>Action:</strong> Streamline complaint intake and investigation process; implement stricter CAPA timelines.</li>
                    </ol>
                </div>
                <div class="recommendation-box">
                    <h4>Quality Enhancement Initiative for Saudi Mais Co.</h4>
                    <p>Launch a "Zero Defect" initiative for critical single-use medical products, focusing on proactive risk mitigation in manufacturing processes. Strengthen the supplier quality assurance program, ensuring raw material and component quality aligns with Saudi Mais Co.'s high standards. Invest in advanced training for QA/QC personnel on latest regulatory updates and quality tools.</p>
                </div>
            `;
        }
        function generateDemandForecastResponseEn(data) {
             return `
                <h1>Demand Forecasting & Inventory Optimization for Saudi Mais Co.</h1>
                ${data ? `<div class="analysis-result-card"><p><strong>Data Insight:</strong> Historical sales and inventory data from the provided file for Saudi Mais Co. have shaped this forecast for its single-use medical consumables.</p></div>` : '<div class="analysis-result-card"><p><strong>Data Insight:</strong> Forecast based on general market trends for medical consumables in the Middle East, applied to Saudi Mais Co.</p></div>'}
                <div class="analysis-result-card">
                    <h2>Demand Projections (Next 12 Months - Saudi Mais Co. Consumables)</h2>
                    <p>A seasonal uplift is anticipated for certain respiratory-related consumables in Q4/Q1. Overall demand for general surgical and infection control single-use products manufactured by Saudi Mais Co. shows a steady 6-8% upward trend, driven by increased healthcare activity and population growth in the region.</p>
                    <div class="metric-card">
                        <div class="metric-label">Forecast Accuracy (MAPE - Previous Year)</div>
                        <div class="metric-value">18% <span class="quality-indicator quality-good">Good (Target <15%)</span></div>
                         <p style="font-size:0.8em; opacity:0.7;">(Example metric if data was provided)</p>
                    </div>
                    <h4>Example Product Category Forecast:</h4>
                    <table>
                        <thead><tr><th>Product Category (Saudi Mais Co.)</th><th>Forecasted Units (Next 12m)</th><th>Key Drivers</th></tr></thead>
                        <tbody>
                            <tr><td>Sterile Surgical Gloves</td><td>5,000,000 pairs</td><td>Increased surgical procedures, hospital demand</td></tr>
                            <tr><td>Disposable Face Masks (Type IIR)</td><td>10,000,000 units</td><td>Ongoing public health awareness, institutional use</td></tr>
                            <tr><td>IV Cannulas</td><td>2,500,000 units</td><td>Hospital admissions, outpatient services</td></tr>
                        </tbody>
                    </table>
                </div>
                <div class="analysis-result-card">
                    <h2>Inventory Recommendations for Saudi Mais Co.</h2>
                    <p>Implement a segmented inventory strategy for Saudi Mais Co.'s diverse range of medical consumables. For high-volume, predictable demand items (e.g., standard gloves, masks), consider more aggressive JIT or lean inventory approaches. For critical, less predictable, or long-lead-time imported components/products, maintain higher safety stock levels. Regularly review and update reorder points and EOQ based on refreshed forecasts and supplier reliability.</p>
                    <div class="critical-box">
                        <h4>Stockout Risk Alert (Example from Data)</h4>
                        <p>If data shows: Current inventory for 'Specialized Suture Kit XYZ' is at 5 days of supply, while the typical supplier lead time is 15 days. Immediate action to expedite an order and review safety stock for this item is critical to prevent disruption for Saudi Mais Co.'s customers.</p>
                    </div>
                </div>
            `;
        }
        function generateCompetitorAnalysisResponseEn(data) {
            return `
                <h1>Competitive Landscape Analysis for Saudi Mais Co.</h1>
                ${data ? `<div class="analysis-result-card"><p><strong>Data Insight:</strong> Competitor information from the provided file has been integrated into this analysis of Saudi Mais Co.'s market position.</p></div>` : '<div class="analysis-result-card"><p><strong>Data Insight:</strong> Analysis based on general knowledge of the medical consumables market in the Middle East relevant to Saudi Mais Co.</p></div>'}
                <div class="analysis-result-card">
                    <h2>Market Positioning of Saudi Mais Co. (Single-Use Medical Consumables)</h2>
                    <p>Saudi Mais Co. (founded 1994, Riyadh) is an established local manufacturer known for quality in single-use medical consumables. It competes with larger multinational corporations (MNCs) and emerging regional players. Key competitive factors include product quality/certifications (ISO, SFDA), price, breadth of product line, distribution network, and relationships with major healthcare providers (public and private sectors).</p>
                    <div class="metric-card">
                        <div class="metric-label">Estimated Market Share (KSA - Selected Consumables)</div>
                        <div class="metric-value">12-15% <span class="quality-indicator quality-good">Solid Local Player</span></div>
                         <p style="font-size:0.8em; opacity:0.7;">(Illustrative metric)</p>
                    </div>
                </div>
                <div class="analysis-result-card">
                    <h2>SWOT Analysis Summary (Saudi Mais Co. vs. Key Competitors)</h2>
                    <p><strong>Strengths:</strong> Local manufacturing presence (potential for IKTVA benefits, faster supply for some items), established reputation for quality, understanding of regional needs.</p>
                    <p><strong>Weaknesses:</strong> Potentially higher cost structure compared to some large-scale MNCs or low-cost importers, narrower R&D pipeline for highly innovative products, reliance on some imported raw materials.</p>
                    <p><strong>Opportunities:</strong> Growing healthcare market (Vision 2030), increasing demand for local content, potential for export to other GCC/MENA countries, product line expansion into adjacent consumable categories.</p>
                    <p><strong>Threats:</strong> Intense price competition, particularly in tender-based procurement; rapid technological advancements by global players; supply chain vulnerabilities for imported components.</p>
                </div>
                <h4>Key Competitors (Illustrative):</h4>
                 <ul><li>GlobalMed Devices (MNC - broad portfolio, strong R&D)</li><li>Arabian HealthTech (Regional Distributor/Importer - aggressive pricing)</li><li>Emerging Local Manufacturers (Focus on specific high-volume items)</li></ul>
                <div class="recommendation-box">
                    <h4>Competitive Strategy for Saudi Mais Co.</h4>
                    <p>Saudi Mais Co. should leverage its strengths in local manufacturing and quality assurance. Focus on a hybrid strategy:
                    1.  <strong>Cost Leadership for Core Products:</strong> Optimize manufacturing for high-volume consumables to compete effectively on price while maintaining quality.
                    2.  <strong>Differentiation for Specialized Products:</strong> Develop or source specialized consumables where quality, reliability, and local support can command a premium.
                    3.  <strong>Strengthen Relationships:</strong> Enhance partnerships with key governmental and private healthcare institutions, emphasizing reliability and responsiveness.
                    4.  <strong>Explore Niche Exports:</strong> Target specific GCC/MENA markets where Saudi-made quality products have an advantage.</p>
                </div>
            `;
        }
        function generateComprehensiveAnalysisResponseEn() {
            return `
                <h1>Comprehensive Strategic Analysis: Saudi Mais Co. for Medical Products</h1>
                <div class="analysis-result-card">
                    <h2>1. Executive Summary</h2>
                    <p>Saudi Mais Co. for Medical Products, a Riyadh-based manufacturer of single-use medical consumables since 1994, stands as a key local player committed to high international quality standards. While possessing a solid foundation, the company faces significant business and financial challenges that necessitate immediate and decisive strategic actions. This analysis outlines critical areas for transformation to ensure sustainable growth and enhanced market leadership in the evolving Saudi and Middle Eastern healthcare landscape.</p>
                </div>
                <div class="analysis-result-card">
                    <h2>2. Financial Situation & Recovery Strategies</h2>
                    <p>The company is likely experiencing pressures on liquidity and profitability. A robust recovery plan must focus on:
                    <ul>
                        <li><strong>Aggressive Cost Management:</strong> Implementing lean manufacturing principles to reduce waste and improve efficiency in the production of medical consumables. Target a 10-15% reduction in operational costs over 18 months.</li>
                        <li><strong>Working Capital Optimization:</strong> Improving inventory turnover for its single-use products, renegotiating payment terms with suppliers, and streamlining receivables collection.</li>
                        <li><strong>Debt Restructuring (if applicable):</strong> Exploring options to manage existing debt obligations more effectively.</li>
                        <li><strong>Revenue Enhancement:</strong> Identifying new, higher-margin product niches within medical consumables or exploring value-added services.</li>
                    </ul></p>
                    <div class="critical-box">
                        <h4>Urgent Action: Cash Flow Fortification</h4>
                        <p>Implement immediate measures to improve the cash conversion cycle. This includes a rigorous review of inventory holding costs for all single-use medical products and proactive management of trade receivables and payables.</p>
                    </div>
                </div>
                <div class="analysis-result-card">
                    <h2>3. Market Position & Competitive Dynamics (Medical Consumables)</h2>
                    <p>Saudi Mais Co. benefits from its local manufacturing base and adherence to quality (e.g., ISO 13485). However, it faces competition from MNCs and other regional players in the single-use medical device market. Vision 2030's healthcare expansion and IKTVA (local content) initiatives present significant opportunities.
                    Strategies should include:
                    <ul>
                        <li>Strengthening brand positioning around "Saudi-made quality".</li>
                        <li>Focusing on product categories where local manufacturing offers a distinct advantage (e.g., responsiveness, customization for regional needs).</li>
                        <li>Developing deeper relationships with key public and private healthcare procurement bodies.</li>
                    </ul></p>
                    <div class="metric-card">
                        <div class="metric-label">Customer Retention Rate (Target >85%)</div>
                        <div class="metric-value">78% <span class="quality-indicator quality-warning">Needs Attention</span></div>
                        <p style="font-size:0.8em; opacity:0.7;">(Illustrative)</p>
                    </div>
                </div>
                <div class="analysis-result-card">
                    <h2>4. Operational Assessment & Enhancement</h2>
                    <p>Saudi Mais Co.'s commitment to "highest international quality standards" is a core asset. Operational enhancements should focus on:
                    <ul>
                        <li><strong>QMS Digitization:</strong> Implementing digital tools for better quality control, traceability, and compliance reporting (SFDA, ISO).</li>
                        <li><strong>Supply Chain Resilience:</strong> Diversifying supplier base for critical raw materials for medical consumables and optimizing logistics.</li>
                        <li><strong>Manufacturing Efficiency:</strong> Investing in automation where feasible and continuous process improvement programs.</li>
                    </ul></p>
                </div>
                <div class="analysis-result-card">
                    <h2>5. Strategic Growth Opportunities for Saudi Mais Co.</h2>
                    <ul>
                        <li><strong>IKTVA Alignment:</strong> Maximizing local content in its single-use medical products to gain preference in governmental tenders.</li>
                        <li><strong>Product Line Expansion:</strong> Cautiously expanding into adjacent, high-demand medical consumable categories.</li>
                        <li><strong>Regional Export Development:</strong> Targeting specific GCC and MENA markets with its quality-certified, competitively priced products.</li>
                        <li><strong>Digital Health Integration (Long-term):</strong> Exploring how its consumables can integrate with or support digital health solutions.</li>
                    </ul>
                </div>
                <div class="recommendation-box">
                    <h4>Overarching Strategic Roadmap for Saudi Mais Co.</h4>
                    <p><strong>Phase 1 (0-12 Months): Financial Stabilization & Operational Excellence.</strong> Focus on cost reduction, cash flow improvement, and enhancing QMS efficiency for core medical consumables.</p>
                    <p><strong>Phase 2 (12-24 Months): Market Strengthening & Product Optimization.</strong> Deepen market penetration in KSA, optimize product portfolio based on profitability, and begin targeted export initiatives for its single-use devices.</p>
                    <p><strong>Phase 3 (24+ Months): Sustainable Growth & Diversification.</strong> Scale successful product lines, expand regional footprint, and explore strategic alliances or new technology adoption relevant to medical consumables manufacturing.</p>
                </div>
            `;
        }
        function generateDefaultResponseEn(query) {
             return `
                <div class="analysis-result-card">
                    <h2>Regarding your query for Saudi Mais Co.: "${query.substring(0,50)}..."</h2>
                    <p>As Yazeed AI, your consultant for Saudi Mais Co. (a Riyadh-based manufacturer of single-use medical consumables since 1994, committed to high quality and currently addressing business challenges), I will provide insights based on this context.</p>
                    <p>Saudi Mais Co.'s operations are significantly influenced by the Saudi Vision 2030 healthcare transformation, stringent quality standards (ISO 13485, SFDA), the competitive medical device market, and the drive for local content (IKTVA). For specific data-driven analysis, please utilize the dedicated sections or upload relevant documents. How can I further assist you regarding Saudi Mais Co.'s specific situation or its market for medical consumables?</p>
                </div>
            `;
        }

        // --- Arabic Simulated Responses ---
        function generateAdvancedAnalysisResponseAr(data) {
            return `
                <h1>ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ£ÿπŸÖÿßŸÑ ÿßŸÑŸÖÿ™ŸÇÿØŸÖ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©</h1>
                ${data ? `<div class="analysis-result-card"><p><strong>ÿ±ÿ§Ÿäÿ© ŸÖŸÜ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:</strong> Ÿäÿ™ÿ∂ŸÖŸÜ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ŸÜŸÇÿßÿ∑ ÿ®ŸäÿßŸÜÿßÿ™ ŸÖŸÜ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑŸÖÿ±ŸÅŸàÿπ ÿßŸÑÿÆÿßÿµ ÿ®ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©.</p></div>` : '<div class="analysis-result-card"><p><strong>ÿ±ÿ§Ÿäÿ© ŸÖŸÜ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:</strong> ÿ™ÿ≠ŸÑŸäŸÑ ŸÖÿ®ŸÜŸä ÿπŸÑŸâ ÿßŸÑŸÖÿπÿ±ŸÅÿ© ÿßŸÑÿπÿßŸÖÿ© ÿ®ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©.</p></div>'}
                <div class="analysis-result-card">
                    <h2>1. ŸÑŸÖÿ≠ÿ© ÿπŸÜ ÿ≥ŸàŸÇ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©</h2>
                    <p>ŸÖŸÜ ÿßŸÑŸÖÿ™ŸàŸÇÿπ ÿ£ŸÜ Ÿäÿ¥ŸáÿØ ÿ≥ŸàŸÇ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäÿå ŸàÿÆÿßÿµÿ© ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØÿå ÿ™Ÿàÿ≥ÿπŸãÿß ŸÉÿ®Ÿäÿ±Ÿãÿßÿå ŸÖÿ™ÿ£ÿ´ÿ±Ÿãÿß ÿ®ÿ¥ŸÉŸÑ ŸÉÿ®Ÿäÿ± ÿ®ÿ™ÿ∑ŸàŸäÿ± ÿßŸÑÿ®ŸÜŸäÿ© ÿßŸÑÿ™ÿ≠ÿ™Ÿäÿ© ŸÑŸÑÿ±ÿπÿßŸäÿ© ÿßŸÑÿµÿ≠Ÿäÿ© ÿ∂ŸÖŸÜ ÿ±ÿ§Ÿäÿ© 2030. ÿ™ŸÉŸÖŸÜ ÿßŸÑŸÅÿ±ÿµ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÅŸä ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑŸÖÿπŸÇŸÖÿ© ÿßŸÑŸÖÿ™ÿÆÿµÿµÿ© ŸàÿßŸÑŸÖŸàÿßÿØ ÿßŸÑŸÖÿµŸÜÿπÿ© ŸÖÿ≠ŸÑŸäŸãÿß ŸàÿßŸÑÿ™Ÿä ÿ™ÿ™ŸÖÿßÿ¥Ÿâ ŸÖÿπ ÿ£ŸáÿØÿßŸÅ ÿ®ÿ±ŸÜÿßŸÖÿ¨ ÿßŸÉÿ™ŸÅÿßÿ° (ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑŸÖÿ∂ÿßŸÅÿ© ŸÅŸä ÿßŸÑŸÖŸÖŸÑŸÉÿ©).</p>
                    <div class="metric-card">
                        <div class="metric-label">ŸÜŸÖŸà ÿßŸÑÿ≥ŸàŸÇ ÿßŸÑŸÖÿ™ŸàŸÇÿπ (CAGR - ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©)</div>
                        <div class="metric-value">9.2% <span class="quality-indicator quality-excellent">ŸÖŸÖÿ™ÿßÿ≤</span></div>
                    </div>
                </div>
                <div class="analysis-result-card">
                    <h2>2. ÿ™ŸÇŸäŸäŸÖ ÿßŸÑÿµÿ≠ÿ© ÿßŸÑŸÖÿßŸÑŸäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©</h2>
                    <p>ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿßŸÑŸäÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ©ÿå ŸàÿßŸÑÿ™Ÿä ŸÇÿØ ÿ™ŸÉŸàŸÜ ŸÖŸÅÿµŸÑÿ© ŸÅŸä ÿßŸÑŸÖÿ≥ÿ™ŸÜÿØÿßÿ™ ÿßŸÑŸÖÿ±ŸÅŸàÿπÿ©ÿå ŸÖŸÜ ÿßŸÑŸÖÿ≠ÿ™ŸÖŸÑ ÿ£ŸÜ ÿ™ÿ¥Ÿäÿ± ÿ•ŸÑŸâ ÿßŸÑÿ≠ÿßÿ¨ÿ© ÿ•ŸÑŸâ ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿä ŸÑŸÑÿ™ŸÉÿßŸÑŸäŸÅÿå Ÿàÿ™ÿ≠ÿ≥ŸäŸÜ ÿ•ÿØÿßÿ±ÿ© ÿ±ÿ£ÿ≥ ÿßŸÑŸÖÿßŸÑ ÿßŸÑÿπÿßŸÖŸÑÿå Ÿàÿ™ŸÜŸàŸäÿπ ŸÖÿµÿßÿØÿ± ÿßŸÑÿ•Ÿäÿ±ÿßÿØÿßÿ™ ÿ®ÿÆŸÑÿßŸÅ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ™ŸÇŸÑŸäÿØŸäÿ©. ŸÖŸÜ ÿßŸÑÿ∂ÿ±Ÿàÿ±Ÿä ÿßŸÑÿßŸáÿ™ŸÖÿßŸÖ ÿ®ŸÜÿ≥ÿ® ÿßŸÑÿ≥ŸäŸàŸÑÿ© ŸàŸáŸàÿßŸÖÿ¥ ÿßŸÑÿ±ÿ®ÿ≠ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸäÿ© ÿπŸÑŸâ ÿÆÿ∑Ÿàÿ∑ ÿßŸÑÿ•ŸÜÿ™ÿßÿ¨ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©.</p>
                    <div class="warning-box">
                        <h4>ÿßŸÑÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸâ ÿßŸÑÿ≥ŸäŸàŸÑÿ© ŸàÿßŸÑÿ±ÿ®ÿ≠Ÿäÿ©</h4>
                        <p>ÿ•ÿ∞ÿß ÿ£ÿ¥ÿßÿ±ÿ™ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ÿå Ÿäÿ¨ÿ® ŸÖŸÇÿßÿ±ŸÜÿ© ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿ≥ŸäŸàŸÑÿ© ÿßŸÑÿ≥ÿ±Ÿäÿπÿ© ŸàŸáÿßŸÖÿ¥ ÿßŸÑÿ±ÿ®ÿ≠ ÿßŸÑÿµÿßŸÅŸä ÿ®ŸÖÿ™Ÿàÿ≥ÿ∑ÿßÿ™ ÿßŸÑÿµŸÜÿßÿπÿ© ŸÑŸÖÿµŸÜÿπŸä ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäŸäŸÜ. ŸäÿπÿØ ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ÿØŸÅŸÇ ÿßŸÑŸÜŸÇÿØŸä ŸÖŸÜ ÿÆŸÑÿßŸÑ ÿ™ÿ≠ÿ≥ŸäŸÜ ÿØŸàÿ±ÿßŸÜ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ŸÑŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿ™ŸàÿµŸäÿ© ÿ±ÿ¶Ÿäÿ≥Ÿäÿ©.</p>
                    </div>
                </div>
                <div class="analysis-result-card">
                    <h2>3. ÿßŸÑÿ∂ÿ±Ÿàÿ±ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©</h2>
                    <ul>
                        <li>ÿ™ÿπÿ≤Ÿäÿ≤ ŸÇÿØÿ±ÿßÿ™ ÿßŸÑÿ™ÿµŸÜŸäÿπ ÿßŸÑŸÖÿ≠ŸÑŸä ŸÑŸÖÿ¨ŸÖŸàÿπÿ© ÿ£Ÿàÿ≥ÿπ ŸÖŸÜ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ ŸÑÿ≤ŸäÿßÿØÿ© ŸÖÿ≥ÿßŸáŸÖÿ© ÿßŸÉÿ™ŸÅÿßÿ° Ÿàÿ™ŸÇŸÑŸäŸÑ ÿßŸÑÿßÿπÿ™ŸÖÿßÿØ ÿπŸÑŸâ ÿßŸÑÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ.</li>
                        <li>ÿßŸÑÿßÿ≥ÿ™ÿ´ŸÖÿßÿ± ŸÅŸä ŸÜÿ∏ÿßŸÖ ÿ±ŸÇŸÖŸä ŸÇŸàŸä ŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ¨ŸàÿØÿ© ŸàŸÜÿ∏ÿßŸÖ ÿ™ÿÆÿ∑Ÿäÿ∑ ŸÖŸàÿßÿ±ÿØ ÿßŸÑŸÖÿ§ÿ≥ÿ≥ÿßÿ™ ŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ÿ™ÿ®ÿπ ŸàÿßŸÑÿßŸÖÿ™ÿ´ÿßŸÑ (ISO 13485 ÿå SFDA) ŸàÿßŸÑŸÉŸÅÿßÿ°ÿ© ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑŸäÿ©.</li>
                        <li>ÿßÿ≥ÿ™ŸÉÿ¥ÿßŸÅ ÿ¥ÿ±ÿßŸÉÿßÿ™ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ŸÖÿπ ŸÖÿ¨ŸÖŸàÿπÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ÿ¥ŸÅŸäÿßÿ™ ÿßŸÑŸÉÿ®ÿ±Ÿâ ŸàŸàŸÉÿßŸÑÿßÿ™ ÿ¥ÿ±ÿßÿ° ÿßŸÑÿ±ÿπÿßŸäÿ© ÿßŸÑÿµÿ≠Ÿäÿ© ÿßŸÑÿ≠ŸÉŸàŸÖŸäÿ©.</li>
                        <li>ÿ™ÿ∑ŸàŸäÿ± ÿ£Ÿà ÿ™ŸàŸÅŸäÿ± ŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿ∑ÿ®Ÿäÿ© ŸÖÿ®ÿ™ŸÉÿ±ÿ© ŸàŸÅÿπÿßŸÑÿ© ŸÖŸÜ ÿ≠Ÿäÿ´ ÿßŸÑÿ™ŸÉŸÑŸÅÿ© ŸÖÿµŸÖŸÖÿ© ÿÆÿµŸäÿµŸãÿß ŸÑŸÑÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™ ÿßŸÑÿ•ŸÇŸÑŸäŸÖŸäÿ©.</li>
                    </ul>
                </div>
                <div class="recommendation-box">
                    <h4>ÿßŸÑÿ™ŸàÿµŸäÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©</h4>
                    <p>ÿ•ÿπÿ∑ÿßÿ° ÿßŸÑÿ£ŸàŸÑŸàŸäÿ© ŸÑÿ™ÿπÿ≤Ÿäÿ≤ ÿßŸÑÿ™ŸÖŸäÿ≤ ŸÅŸä ÿßŸÑÿ™ÿµŸÜŸäÿπ ÿßŸÑŸÖÿ≠ŸÑŸä Ÿàÿ™ÿ≠ŸÇŸäŸÇ ŸáŸäÿßŸÉŸÑ ÿ™ŸÉŸÑŸÅÿ© ÿ™ŸÜÿßŸÅÿ≥Ÿäÿ© ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ. ŸÅŸä ÿßŸÑŸàŸÇÿ™ ŸÜŸÅÿ≥Ÿáÿå ÿßÿ≥ÿ™ŸÉÿ¥ÿßŸÅ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑŸÖÿ™ÿÆÿµÿµÿ© ÿ∞ÿßÿ™ ÿßŸÑŸáÿßŸÖÿ¥ ÿßŸÑŸÖÿ±ÿ™ŸÅÿπ ŸàÿßŸÑÿßÿ≥ÿ™ÿ´ŸÖÿßÿ± ŸÅŸä ÿßŸÑÿ£ÿØŸàÿßÿ™ ÿßŸÑÿ±ŸÇŸÖŸäÿ© ŸÑÿ™ÿπÿ≤Ÿäÿ≤ ÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ© ÿßŸÑÿ≥ŸàŸÇ ŸàÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑŸäÿå ŸÖŸÖÿß ŸäÿØÿπŸÖ ÿ®ÿ¥ŸÉŸÑ ŸÖÿ®ÿßÿ¥ÿ± ÿßŸÑÿ™ÿ≤ÿßŸÖ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿ®ÿßŸÑÿ¨ŸàÿØÿ© ŸàÿßŸÑŸÜŸÖŸà ŸÅŸä ÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑.</p>
                </div>
            `;
        }
        function generateQualityAnalysisResponseAr(data) {
             return `
                <h1>ŸÖÿ±ÿßÿ¨ÿπÿ© ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ¨ŸàÿØÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©</h1>
                ${data ? `<div class="analysis-result-card"><p><strong>ÿ±ÿ§Ÿäÿ© ŸÖŸÜ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:</strong> ŸÉÿßŸÜÿ™ ŸÖŸÇÿßŸäŸäÿ≥ ÿßŸÑÿ¨ŸàÿØÿ© ŸÖŸÜ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™/ÿßŸÑŸÖÿ≥ÿ™ŸÜÿØÿßÿ™ ÿßŸÑŸÖŸÇÿØŸÖÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÖÿ≠Ÿàÿ±Ÿäÿ© ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑÿ™ŸÇŸäŸäŸÖ.</p></div>` : '<div class="analysis-result-card"><p><strong>ÿ±ÿ§Ÿäÿ© ŸÖŸÜ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:</strong> ÿ™ŸÇŸäŸäŸÖ ŸÖÿ®ŸÜŸä ÿπŸÑŸâ ŸÖÿ®ÿßÿØÿ¶ QMS ÿßŸÑÿπÿßŸÖÿ© ŸÑŸÖÿµŸÜÿπŸä ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ© ŸÖÿ´ŸÑ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©.</p></div>'}
                <div class="analysis-result-card">
                    <h2>ÿßŸÑÿßŸÖÿ™ÿ´ÿßŸÑ ŸàÿßŸÑŸÅÿπÿßŸÑŸäÿ© ÿßŸÑÿπÿßŸÖÿ© (ISO 13485 Ÿà SFDA)</h2>
                    <p>ÿ™ŸáÿØŸÅ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿ•ŸÑŸâ ÿ™ÿ≠ŸÇŸäŸÇ ÿ£ÿπŸÑŸâ ŸÖÿπÿßŸäŸäÿ± ÿßŸÑÿ¨ŸàÿØÿ© ÿßŸÑÿπÿßŸÑŸÖŸäÿ©. ÿ™ÿ¥Ÿäÿ± ŸÖÿ±ÿßÿ¨ÿπÿ© ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ¨ŸàÿØÿ©ÿå ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖÿ™ÿßÿ≠ÿ©ÿå ÿ•ŸÑŸâ ÿßŸÑÿßŸÑÿ™ÿ≤ÿßŸÖ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿä ÿ®ŸÄ ISO 13485. Ÿäÿ¨ÿ® ÿ£ŸÜ ÿ™ÿ±ŸÉÿ≤ ÿ¨ŸáŸàÿØ ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÖÿ≥ÿ™ŸÖÿ± ÿπŸÑŸâ ÿßŸÑÿ™Ÿàÿ´ŸäŸÇ ÿßŸÑÿµÿßÿ±ŸÖ ŸÑÿ∂Ÿàÿßÿ®ÿ∑ ÿßŸÑÿ™ÿµŸÖŸäŸÖ (ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿπŸÑŸâ ÿ™ÿ∑ŸàŸäÿ± ŸÖŸÜÿ™ÿ¨ÿßÿ™ŸáŸÖ)ÿå Ÿàÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿÆÿßÿ∑ÿ± (ISO 14971)ÿå ŸàÿßŸÑŸÖÿ±ÿßŸÇÿ®ÿ© ÿ®ÿπÿØ ÿßŸÑÿ™ÿ≥ŸàŸäŸÇ ŸÑÿ∂ŸÖÿßŸÜ ÿßŸÑÿ™ŸàÿßŸÅŸÇ ÿßŸÑŸÉÿßŸÖŸÑ ŸÖÿπ ŸÖÿ™ÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑŸáŸäÿ¶ÿ© ÿßŸÑÿπÿßŸÖÿ© ŸÑŸÑÿ∫ÿ∞ÿßÿ° ŸàÿßŸÑÿØŸàÿßÿ° ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÑŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©.</p>
                    <div class="metric-card">
                        <div class="metric-label">ŸÖÿπÿØŸÑ ÿπÿØŸÖ ÿßŸÑŸÖÿ∑ÿßÿ®ŸÇÿ© ŸÅŸä ÿßŸÑÿ™ÿØŸÇŸäŸÇ ÿßŸÑÿØÿßÿÆŸÑŸä (ÿßŸÑŸÖÿ≥ÿ™ŸáÿØŸÅ <1%)</div>
                        <div class="metric-value">1.5% <span class="quality-indicator quality-warning">Ÿäÿ≠ÿ™ÿßÿ¨ ŸÑÿ™ÿ≠ÿ≥ŸäŸÜ</span></div>
                        <p style="font-size:0.8em; opacity:0.7;">(ŸÖÿ´ÿßŸÑ ÿπŸÑŸâ ŸÖŸÇŸäÿßÿ≥ ÿ•ÿ∞ÿß ÿ™ŸÖ ÿ™ŸÇÿØŸäŸÖ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™)</p>
                    </div>
                </div>
                <div class="analysis-result-card">
                    <h2>ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ŸàÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™ ÿßŸÑÿ™ÿµÿ≠Ÿäÿ≠Ÿäÿ©/ÿßŸÑŸàŸÇÿßÿ¶Ÿäÿ© (CAPA)</h2>
                    <ol>
                        <li><strong>ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ© (ŸÖÿ´ÿßŸÑ):</strong> ÿπÿØŸÖ ÿßÿ™ÿ≥ÿßŸÇ ÿßŸÑÿ™ÿ™ÿ®ÿπ ŸÅŸä ÿ≥ÿ¨ŸÑÿßÿ™ ÿßŸÑÿØŸèŸÅÿπÿßÿ™ ŸÑÿÆÿ∑ ÿ•ŸÜÿ™ÿßÿ¨ ŸÖÿ≥ÿ™ŸáŸÑŸÉ ŸÖÿπŸäŸÜ. <strong>ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°:</strong> ÿ™ÿ∑ÿ®ŸäŸÇ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿ±ŸÇŸÖŸä ŸÖŸèÿ≠ÿ≥ŸéŸëŸÜ ŸÑŸÑÿØŸèŸÅÿπÿßÿ™ ŸÖÿπ ÿ•ÿØÿÆÿßŸÑÿßÿ™ ÿ≠ŸÇŸÑ ÿ•ŸÑÿ≤ÿßŸÖŸäÿ©ÿõ ÿ•ÿ¨ÿ±ÿßÿ° ÿ•ÿπÿßÿØÿ© ÿ™ÿØÿ±Ÿäÿ® ŸÖÿ≥ÿ™ŸáÿØŸÅ ŸÑŸÖŸàÿ∏ŸÅŸä ÿßŸÑÿ•ŸÜÿ™ÿßÿ¨ ŸÅŸä ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©.</li>
                        <li><strong>ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ© (ŸÖÿ´ÿßŸÑ):</strong> ÿßŸÑÿßŸÑÿ™ÿ≤ÿßŸÖ ÿ®ÿ¨ÿØŸàŸÑ ÿ™ÿØŸÇŸäŸÇ ÿ¨ŸàÿØÿ© ÿßŸÑŸÖŸàÿ±ÿØŸäŸÜ ÿ£ŸÇŸÑ ŸÖŸÜ ÿßŸÑŸÖÿ≥ÿ™ŸáÿØŸÅ. <strong>ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°:</strong> ŸÖÿ±ÿßÿ¨ÿπÿ© ÿÆÿ∑ÿ© ÿ™ÿØŸÇŸäŸÇ ÿßŸÑŸÖŸàÿ±ÿØŸäŸÜ ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿßŸÑŸÖÿÆÿßÿ∑ÿ±ÿõ ÿ™ÿÆÿµŸäÿµ ŸÖŸàÿßÿ±ÿØ ŸÖÿÆÿµÿµÿ© ŸÑŸÑÿ™ŸÜŸÅŸäÿ∞ ŸÅŸä ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÖŸÜÿßÿ≥ÿ®.</li>
                        <li><strong>ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ© (ŸÖÿ´ÿßŸÑ):</strong> ÿ™ÿ¨ÿßŸàÿ≤ ÿ£ŸàŸÇÿßÿ™ ÿ≠ŸÑ ÿ¥ŸÉÿßŸàŸâ ÿßŸÑÿπŸÖŸÑÿßÿ° ÿ®ÿ¥ÿ£ŸÜ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑŸÖÿπŸäÿ®ÿ© ŸÑŸÖÿ§ÿ¥ÿ±ÿßÿ™ ÿßŸÑÿ£ÿØÿßÿ° ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ÿßŸÑÿØÿßÿÆŸÑŸäÿ©. <strong>ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°:</strong> ÿ™ÿ®ÿ≥Ÿäÿ∑ ÿπŸÖŸÑŸäÿ© ÿßÿ≥ÿ™ŸÇÿ®ÿßŸÑ ÿßŸÑÿ¥ŸÉÿßŸàŸâ ŸàÿßŸÑÿ™ÿ≠ŸÇŸäŸÇ ŸÅŸäŸáÿßÿõ ÿ™ÿ∑ÿ®ŸäŸÇ ÿ¨ÿØÿßŸàŸÑ ÿ≤ŸÖŸÜŸäÿ© ÿ£ŸÉÿ´ÿ± ÿµÿ±ÿßŸÖÿ© ŸÑŸÄ CAPA.</li>
                    </ol>
                </div>
                <div class="recommendation-box">
                    <h4>ŸÖÿ®ÿßÿØÿ±ÿ© ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ¨ŸàÿØÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©</h4>
                    <p>ÿ•ÿ∑ŸÑÿßŸÇ ŸÖÿ®ÿßÿØÿ±ÿ© "ÿµŸÅÿ± ÿπŸäŸàÿ®" ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿßŸÑÿ≠ÿ±ÿ¨ÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØÿå ŸÖÿπ ÿßŸÑÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸâ ÿßŸÑÿ™ÿÆŸÅŸäŸÅ ÿßŸÑÿßÿ≥ÿ™ÿ®ÿßŸÇŸä ŸÑŸÑŸÖÿÆÿßÿ∑ÿ± ŸÅŸä ÿπŸÖŸÑŸäÿßÿ™ ÿßŸÑÿ™ÿµŸÜŸäÿπ. ÿ™ÿπÿ≤Ÿäÿ≤ ÿ®ÿ±ŸÜÿßŸÖÿ¨ ÿ∂ŸÖÿßŸÜ ÿ¨ŸàÿØÿ© ÿßŸÑŸÖŸàÿ±ÿØŸäŸÜÿå Ÿàÿ∂ŸÖÿßŸÜ ÿ™ŸàÿßŸÅŸÇ ÿ¨ŸàÿØÿ© ÿßŸÑŸÖŸàÿßÿØ ÿßŸÑÿÆÿßŸÖ ŸàÿßŸÑŸÖŸÉŸàŸÜÿßÿ™ ŸÖÿπ ŸÖÿπÿßŸäŸäÿ± ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿßŸÑÿπÿßŸÑŸäÿ©. ÿßŸÑÿßÿ≥ÿ™ÿ´ŸÖÿßÿ± ŸÅŸä ÿßŸÑÿ™ÿØÿ±Ÿäÿ® ÿßŸÑŸÖÿ™ŸÇÿØŸÖ ŸÑŸÖŸàÿ∏ŸÅŸä ÿ∂ŸÖÿßŸÜ ŸàŸÖÿ±ÿßŸÇÿ®ÿ© ÿßŸÑÿ¨ŸàÿØÿ© ÿπŸÑŸâ ÿ£ÿ≠ÿØÿ´ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ÿßÿ™ ÿßŸÑÿ™ŸÜÿ∏ŸäŸÖŸäÿ© Ÿàÿ£ÿØŸàÿßÿ™ ÿßŸÑÿ¨ŸàÿØÿ©.</p>
                </div>
            `;
        }
        function generateDemandForecastResponseAr(data) {
            return `
                <h1>ÿ™ŸàŸÇÿπÿßÿ™ ÿßŸÑÿ∑ŸÑÿ® Ÿàÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©</h1>
                ${data ? `<div class="analysis-result-card"><p><strong>ÿ±ÿ§Ÿäÿ© ŸÖŸÜ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:</strong> ÿ≥ÿßŸáŸÖÿ™ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ ŸàÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ÿßŸÑÿ™ÿßÿ±ŸäÿÆŸäÿ© ŸÖŸÜ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑŸÖŸÇÿØŸÖ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÅŸä ÿ™ÿ¥ŸÉŸäŸÑ Ÿáÿ∞Ÿá ÿßŸÑÿ™ŸàŸÇÿπÿßÿ™ ŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™Ÿáÿß ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ.</p></div>` : '<div class="analysis-result-card"><p><strong>ÿ±ÿ§Ÿäÿ© ŸÖŸÜ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:</strong> ÿ™ŸàŸÇÿπÿßÿ™ ŸÖÿ®ŸÜŸäÿ© ÿπŸÑŸâ ÿßÿ™ÿ¨ÿßŸáÿßÿ™ ÿßŸÑÿ≥ŸàŸÇ ÿßŸÑÿπÿßŸÖÿ© ŸÑŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ŸÅŸä ÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ÿå ŸÖÿ∑ÿ®ŸÇÿ© ÿπŸÑŸâ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©.</p></div>'}
                <div class="analysis-result-card">
                    <h2>ÿ™ŸàŸÇÿπÿßÿ™ ÿßŸÑÿ∑ŸÑÿ® (ŸÑŸÑÿ£ÿ¥Ÿáÿ± ÿßŸÑŸÄ 12 ÿßŸÑŸÇÿßÿØŸÖÿ© - ŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©)</h2>
                    <p>ŸÖŸÜ ÿßŸÑŸÖÿ™ŸàŸÇÿπ ÿ≠ÿØŸàÿ´ ÿßÿ±ÿ™ŸÅÿßÿπ ŸÖŸàÿ≥ŸÖŸä ŸÑÿ®ÿπÿ∂ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑŸÖÿ™ÿπŸÑŸÇÿ© ÿ®ÿßŸÑÿ¨Ÿáÿßÿ≤ ÿßŸÑÿ™ŸÜŸÅÿ≥Ÿä ŸÅŸä ÿßŸÑÿ±ÿ®ÿπ ÿßŸÑÿ±ÿßÿ®ÿπ/ÿßŸÑÿ£ŸàŸÑ. ŸäŸèÿ∏Ÿáÿ± ÿßŸÑÿ∑ŸÑÿ® ÿßŸÑÿπÿßŸÖ ÿπŸÑŸâ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ¨ÿ±ÿßÿ≠Ÿäÿ© ŸàŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÖŸÉÿßŸÅÿ≠ÿ© ÿßŸÑÿπÿØŸàŸâ ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ ÿßŸÑÿ™Ÿä ÿ™ÿµŸÜÿπŸáÿß ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿßÿ™ÿ¨ÿßŸáŸãÿß ÿ™ÿµÿßÿπÿØŸäŸãÿß ÿ´ÿßÿ®ÿ™Ÿãÿß ÿ®ŸÜÿ≥ÿ®ÿ© 6-8Ÿ™ÿå ŸÖÿØŸÅŸàÿπŸãÿß ÿ®ÿ≤ŸäÿßÿØÿ© ŸÜÿ¥ÿßÿ∑ ÿßŸÑÿ±ÿπÿßŸäÿ© ÿßŸÑÿµÿ≠Ÿäÿ© ŸàÿßŸÑŸÜŸÖŸà ÿßŸÑÿ≥ŸÉÿßŸÜŸä ŸÅŸä ÿßŸÑŸÖŸÜÿ∑ŸÇÿ©.</p>
                    <div class="metric-card">
                        <div class="metric-label">ÿØŸÇÿ© ÿßŸÑÿ™ŸàŸÇÿπÿßÿ™ (MAPE - ÿßŸÑÿ≥ŸÜÿ© ÿßŸÑÿ≥ÿßÿ®ŸÇÿ©)</div>
                        <div class="metric-value">18% <span class="quality-indicator quality-good">ÿ¨ŸäÿØ (ÿßŸÑŸÖÿ≥ÿ™ŸáÿØŸÅ <15%)</span></div>
                         <p style="font-size:0.8em; opacity:0.7;">(ŸÖÿ´ÿßŸÑ ÿπŸÑŸâ ŸÖŸÇŸäÿßÿ≥ ÿ•ÿ∞ÿß ÿ™ŸÖ ÿ™ŸÇÿØŸäŸÖ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™)</p>
                    </div>
                    <h4>ŸÖÿ´ÿßŸÑ ÿπŸÑŸâ ÿ™ŸàŸÇÿπÿßÿ™ ŸÅÿ¶ÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨:</h4>
                    <table>
                        <thead><tr><th>ŸÅÿ¶ÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ (ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©)</th><th>ÿßŸÑŸàÿ≠ÿØÿßÿ™ ÿßŸÑŸÖÿ™ŸàŸÇÿπÿ© (12 ÿ¥Ÿáÿ±Ÿãÿß ŸÇÿßÿØŸÖÿ©)</th><th>ÿßŸÑŸÖÿ≠ÿ±ŸÉÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©</th></tr></thead>
                        <tbody>
                            <tr><td>ŸÇŸÅÿßÿ≤ÿßÿ™ ÿ¨ÿ±ÿßÿ≠Ÿäÿ© ŸÖÿπŸÇŸÖÿ©</td><td>5,000,000 ÿ≤Ÿàÿ¨</td><td>ÿ≤ŸäÿßÿØÿ© ÿßŸÑÿπŸÖŸÑŸäÿßÿ™ ÿßŸÑÿ¨ÿ±ÿßÿ≠Ÿäÿ©ÿå ÿ∑ŸÑÿ® ÿßŸÑŸÖÿ≥ÿ™ÿ¥ŸÅŸäÿßÿ™</td></tr>
                            <tr><td>ŸÉŸÖÿßŸÖÿßÿ™ Ÿàÿ¨Ÿá ŸÑŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ŸÖÿ±ÿ© Ÿàÿßÿ≠ÿØÿ© (ÿßŸÑŸÜŸàÿπ IIR)</td><td>10,000,000 Ÿàÿ≠ÿØÿ©</td><td>ÿßŸÑŸàÿπŸä ÿßŸÑÿµÿ≠Ÿä ÿßŸÑÿπÿßŸÖ ÿßŸÑŸÖÿ≥ÿ™ŸÖÿ±ÿå ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸÖÿ§ÿ≥ÿ≥Ÿä</td></tr>
                            <tr><td>ŸÇÿ≥ÿßÿ∑ÿ± Ÿàÿ±ŸäÿØŸäÿ©</td><td>2,500,000 Ÿàÿ≠ÿØÿ©</td><td>ÿ≠ÿßŸÑÿßÿ™ ÿØÿÆŸàŸÑ ÿßŸÑŸÖÿ≥ÿ™ÿ¥ŸÅŸäÿßÿ™ÿå ÿÆÿØŸÖÿßÿ™ ÿßŸÑÿπŸäÿßÿØÿßÿ™ ÿßŸÑÿÆÿßÿ±ÿ¨Ÿäÿ©</td></tr>
                        </tbody>
                    </table>
                </div>
                <div class="analysis-result-card">
                    <h2>ÿ™ŸàÿµŸäÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©</h2>
                    <p>ÿ™ÿ∑ÿ®ŸäŸÇ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ŸÖÿÆÿ≤ŸàŸÜ ŸÖÿ¨ÿ≤ÿ£ÿ© ŸÑŸÖÿ¨ŸÖŸàÿπÿ© ŸÖÿ™ŸÜŸàÿπÿ© ŸÖŸÜ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©. ÿ®ÿßŸÑŸÜÿ≥ÿ®ÿ© ŸÑŸÑŸÖŸàÿßÿØ ÿ∞ÿßÿ™ ÿßŸÑÿ≠ÿ¨ŸÖ ÿßŸÑŸÉÿ®Ÿäÿ± ŸàÿßŸÑÿ∑ŸÑÿ® ÿßŸÑŸÖÿ™ŸàŸÇÿπ (ŸÖÿ´ŸÑ ÿßŸÑŸÇŸÅÿßÿ≤ÿßÿ™ ÿßŸÑŸÇŸäÿßÿ≥Ÿäÿ© ŸàÿßŸÑŸÉŸÖÿßŸÖÿßÿ™)ÿå ÿ∂ÿπ ŸÅŸä ÿßÿπÿ™ÿ®ÿßÿ±ŸÉ ŸÖŸÜÿßŸáÿ¨ JIT ÿ£Ÿà ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ÿßŸÑÿÆÿßŸÑŸä ŸÖŸÜ ÿßŸÑŸáÿØÿ± ÿßŸÑÿ£ŸÉÿ´ÿ± ÿ¨ÿ±ÿ£ÿ©. ÿ®ÿßŸÑŸÜÿ≥ÿ®ÿ© ŸÑŸÑŸÖŸÉŸàŸÜÿßÿ™/ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™Ÿàÿ±ÿØÿ© ÿßŸÑÿ≠ÿ±ÿ¨ÿ© ŸàÿßŸÑÿ£ŸÇŸÑ ŸÇÿßÿ®ŸÑŸäÿ© ŸÑŸÑÿ™ŸÜÿ®ÿ§ ÿ®Ÿáÿß ÿ£Ÿà ÿ∞ÿßÿ™ ÿßŸÑŸÖŸáŸÑÿ© ÿßŸÑÿ∑ŸàŸäŸÑÿ©ÿå ÿ≠ÿßŸÅÿ∏ ÿπŸÑŸâ ŸÖÿ≥ÿ™ŸàŸäÿßÿ™ ŸÖÿÆÿ≤ŸàŸÜ ÿ£ŸÖÿßŸÜ ÿ£ÿπŸÑŸâ. ŸÇŸÖ ÿ®ŸÖÿ±ÿßÿ¨ÿπÿ© Ÿàÿ™ÿ≠ÿØŸäÿ´ ŸÜŸÇÿßÿ∑ ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ∑ŸÑÿ® Ÿà EOQ ÿ®ÿßŸÜÿ™ÿ∏ÿßŸÖ ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿßŸÑÿ™ŸàŸÇÿπÿßÿ™ ÿßŸÑŸÖÿ≠ÿØÿ´ÿ© ŸàŸÖŸàÿ´ŸàŸÇŸäÿ© ÿßŸÑŸÖŸàÿ±ÿØŸäŸÜ.</p>
                    <div class="critical-box">
                        <h4>ÿ™ŸÜÿ®ŸäŸá ÿ®ŸÖÿÆÿßÿ∑ÿ± ŸÜŸÅÿßÿØ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ (ŸÖÿ´ÿßŸÑ ŸÖŸÜ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™)</h4>
                        <p>ÿ•ÿ∞ÿß ÿ£ÿ∏Ÿáÿ±ÿ™ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™: ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ÿßŸÑÿ≠ÿßŸÑŸä ŸÖŸÜ 'ÿ∑ŸÇŸÖ ÿßŸÑÿÆŸäŸàÿ∑ ÿßŸÑÿ¨ÿ±ÿßÿ≠Ÿäÿ© ÿßŸÑŸÖÿ™ÿÆÿµÿµÿ© XYZ' ŸäŸÉŸÅŸä ŸÑŸÖÿØÿ© 5 ÿ£ŸäÿßŸÖÿå ÿ®ŸäŸÜŸÖÿß ÿ™ÿ®ŸÑÿ∫ ŸÖŸáŸÑÿ© ÿßŸÑÿ™Ÿàÿ±ŸäÿØ ÿßŸÑŸÖÿπÿ™ÿßÿØÿ© 15 ŸäŸàŸÖŸãÿß. ŸÖŸÜ ÿßŸÑÿ∂ÿ±Ÿàÿ±Ÿä ÿßÿ™ÿÆÿßÿ∞ ÿ•ÿ¨ÿ±ÿßÿ° ŸÅŸàÿ±Ÿä ŸÑÿ™ÿ≥ÿ±Ÿäÿπ ÿßŸÑÿ∑ŸÑÿ® ŸàŸÖÿ±ÿßÿ¨ÿπÿ© ŸÖÿÆÿ≤ŸàŸÜ ÿßŸÑÿ£ŸÖÿßŸÜ ŸÑŸáÿ∞ÿß ÿßŸÑÿπŸÜÿµÿ± ŸÑŸÖŸÜÿπ ÿ™ÿπÿ∑ŸäŸÑ ÿπŸÖŸÑÿßÿ° ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©.</p>
                    </div>
                </div>
            `;
        }
        function generateCompetitorAnalysisResponseAr(data) {
            return `
                <h1>ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖÿ¥ŸáÿØ ÿßŸÑÿ™ŸÜÿßŸÅÿ≥Ÿä ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©</h1>
                ${data ? `<div class="analysis-result-card"><p><strong>ÿ±ÿ§Ÿäÿ© ŸÖŸÜ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:</strong> ÿ™ŸÖ ÿØŸÖÿ¨ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜ ŸÖŸÜ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑŸÖŸÇÿØŸÖ ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ŸÑŸàÿ∂ÿπ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÅŸä ÿßŸÑÿ≥ŸàŸÇ.</p></div>` : '<div class="analysis-result-card"><p><strong>ÿ±ÿ§Ÿäÿ© ŸÖŸÜ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:</strong> ÿ™ÿ≠ŸÑŸäŸÑ ŸÖÿ®ŸÜŸä ÿπŸÑŸâ ÿßŸÑŸÖÿπÿ±ŸÅÿ© ÿßŸÑÿπÿßŸÖÿ© ÿ®ÿ≥ŸàŸÇ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ŸÅŸä ÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ ÿ∞ÿßÿ™ ÿßŸÑÿµŸÑÿ© ÿ®ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©.</p></div>'}
                <div class="analysis-result-card">
                    <h2>ÿßŸÑÿ™ŸÖŸàÿ∂ÿπ ÿßŸÑÿ≥ŸàŸÇŸä ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© (ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ)</h2>
                    <p>ÿ™ŸèÿπÿØ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© (ÿ™ÿ£ÿ≥ÿ≥ÿ™ ÿπÿßŸÖ 1994ÿå ÿßŸÑÿ±Ÿäÿßÿ∂) ŸÖŸèÿµŸÜÿπŸãÿß ŸÖÿ≠ŸÑŸäŸãÿß ÿ±ÿßÿ≥ÿÆŸãÿß ŸÖÿπÿ±ŸàŸÅŸãÿß ÿ®ÿßŸÑÿ¨ŸàÿØÿ© ŸÅŸä ŸÖÿ¨ÿßŸÑ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ. ÿ™ŸÜÿßŸÅÿ≥ ÿßŸÑÿ¥ÿ±ŸÉÿ© ŸÖÿπ ÿ¥ÿ±ŸÉÿßÿ™ ŸÉÿ®ÿ±Ÿâ ŸÖÿ™ÿπÿØÿØÿ© ÿßŸÑÿ¨ŸÜÿ≥Ÿäÿßÿ™ (MNCs) ŸàŸÑÿßÿπÿ®ŸäŸÜ ÿ•ŸÇŸÑŸäŸÖŸäŸäŸÜ ŸÜÿßÿ¥ÿ¶ŸäŸÜ. ÿ™ÿ¥ŸÖŸÑ ÿßŸÑÿπŸàÿßŸÖŸÑ ÿßŸÑÿ™ŸÜÿßŸÅÿ≥Ÿäÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ÿ¨ŸàÿØÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨/ÿßŸÑÿ¥ŸáÿßÿØÿßÿ™ (ISOÿå SFDA)ÿå ŸàÿßŸÑÿ≥ÿπÿ±ÿå Ÿàÿßÿ™ÿ≥ÿßÿπ ÿÆÿ∑ ÿßŸÑÿ•ŸÜÿ™ÿßÿ¨ÿå Ÿàÿ¥ÿ®ŸÉÿ© ÿßŸÑÿ™Ÿàÿ≤Ÿäÿπÿå ŸàÿßŸÑÿπŸÑÿßŸÇÿßÿ™ ŸÖÿπ ŸÉÿ®ÿßÿ± ŸÖŸÇÿØŸÖŸä ÿßŸÑÿ±ÿπÿßŸäÿ© ÿßŸÑÿµÿ≠Ÿäÿ© (ÿßŸÑŸÇÿ∑ÿßÿπŸäŸÜ ÿßŸÑÿπÿßŸÖ ŸàÿßŸÑÿÆÿßÿµ).</p>
                    <div class="metric-card">
                        <div class="metric-label">ÿßŸÑÿ≠ÿµÿ© ÿßŸÑÿ≥ŸàŸÇŸäÿ© ÿßŸÑÿ™ŸÇÿØŸäÿ±Ÿäÿ© (ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© - ŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ŸÖÿÆÿ™ÿßÿ±ÿ©)</div>
                        <div class="metric-value">12-15% <span class="quality-indicator quality-good">ŸÑÿßÿπÿ® ŸÖÿ≠ŸÑŸä ŸÇŸàŸä</span></div>
                         <p style="font-size:0.8em; opacity:0.7;">(ŸÖŸÇŸäÿßÿ≥ ÿ™Ÿàÿ∂Ÿäÿ≠Ÿä)</p>
                    </div>
                </div>
                <div class="analysis-result-card">
                    <h2>ŸÖŸÑÿÆÿµ ÿ™ÿ≠ŸÑŸäŸÑ SWOT (ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÖŸÇÿßÿ®ŸÑ ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜ ÿßŸÑÿ±ÿ¶Ÿäÿ≥ŸäŸäŸÜ)</h2>
                    <p><strong>ŸÜŸÇÿßÿ∑ ÿßŸÑŸÇŸàÿ©:</strong> Ÿàÿ¨ŸàÿØ ÿ™ÿµŸÜŸäÿπ ŸÖÿ≠ŸÑŸä (ÿ•ŸÖŸÉÿßŸÜŸäÿ© ÿßŸÑÿßÿ≥ÿ™ŸÅÿßÿØÿ© ŸÖŸÜ ÿ®ÿ±ŸÜÿßŸÖÿ¨ ÿßŸÉÿ™ŸÅÿßÿ°ÿå ÿ™Ÿàÿ±ŸäÿØ ÿ£ÿ≥ÿ±ÿπ ŸÑÿ®ÿπÿ∂ ÿßŸÑŸÖŸàÿßÿØ)ÿå ÿ≥ŸÖÿπÿ© ÿ±ÿßÿ≥ÿÆÿ© ÿ®ÿßŸÑÿ¨ŸàÿØÿ©ÿå ŸÅŸáŸÖ ŸÑŸÑÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™ ÿßŸÑÿ•ŸÇŸÑŸäŸÖŸäÿ©.</p>
                    <p><strong>ŸÜŸÇÿßÿ∑ ÿßŸÑÿ∂ÿπŸÅ:</strong> ŸáŸäŸÉŸÑ ÿ™ŸÉŸÑŸÅÿ© ÿ£ÿπŸÑŸâ ŸÖÿ≠ÿ™ŸÖŸÑ ŸÖŸÇÿßÿ±ŸÜÿ© ÿ®ÿ®ÿπÿ∂ ÿßŸÑÿ¥ÿ±ŸÉÿßÿ™ ÿßŸÑŸÉÿ®ÿ±Ÿâ ŸÖÿ™ÿπÿØÿØÿ© ÿßŸÑÿ¨ŸÜÿ≥Ÿäÿßÿ™ ÿ£Ÿà ÿßŸÑŸÖÿ≥ÿ™Ÿàÿ±ÿØŸäŸÜ ŸÖŸÜÿÆŸÅÿ∂Ÿä ÿßŸÑÿ™ŸÉŸÑŸÅÿ©ÿå ÿÆÿ∑ ÿ£ŸÜÿßÿ®Ÿäÿ® ÿ®ÿ≠ÿ´ Ÿàÿ™ÿ∑ŸàŸäÿ± ÿ£ÿ∂ŸäŸÇ ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑŸÖÿ®ÿ™ŸÉÿ±ÿ© ŸÑŸÑÿ∫ÿßŸäÿ©ÿå ÿßŸÑÿßÿπÿ™ŸÖÿßÿØ ÿπŸÑŸâ ÿ®ÿπÿ∂ ÿßŸÑŸÖŸàÿßÿØ ÿßŸÑÿÆÿßŸÖ ÿßŸÑŸÖÿ≥ÿ™Ÿàÿ±ÿØÿ©.</p>
                    <p><strong>ÿßŸÑŸÅÿ±ÿµ:</strong> ÿ≥ŸàŸÇ ÿ±ÿπÿßŸäÿ© ÿµÿ≠Ÿäÿ© ŸÖÿ™ŸÜÿßŸÖŸä (ÿ±ÿ§Ÿäÿ© 2030)ÿå ÿ≤ŸäÿßÿØÿ© ÿßŸÑÿ∑ŸÑÿ® ÿπŸÑŸâ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÖÿ≠ŸÑŸäÿå ÿ•ŸÖŸÉÿßŸÜŸäÿ© ÿßŸÑÿ™ÿµÿØŸäÿ± ÿ•ŸÑŸâ ÿØŸàŸÑ ŸÖÿ¨ŸÑÿ≥ ÿßŸÑÿ™ÿπÿßŸàŸÜ ÿßŸÑÿÆŸÑŸäÿ¨Ÿä/ÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ Ÿàÿ¥ŸÖÿßŸÑ ÿ£ŸÅÿ±ŸäŸÇŸäÿß ÿßŸÑÿ£ÿÆÿ±Ÿâÿå ÿ™Ÿàÿ≥Ÿäÿπ ÿÆÿ∑ ÿßŸÑÿ•ŸÜÿ™ÿßÿ¨ ŸÑŸäÿ¥ŸÖŸÑ ŸÅÿ¶ÿßÿ™ ŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ŸÖÿ¨ÿßŸàÿ±ÿ©.</p>
                    <p><strong>ÿßŸÑÿ™ŸáÿØŸäÿØÿßÿ™:</strong> ŸÖŸÜÿßŸÅÿ≥ÿ© ÿ≥ÿπÿ±Ÿäÿ© ÿ¥ÿØŸäÿØÿ©ÿå ÿÆÿßÿµÿ© ŸÅŸä ÿßŸÑŸÖÿ¥ÿ™ÿ±Ÿäÿßÿ™ ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿπŸÑŸâ ÿßŸÑŸÖŸÜÿßŸÇÿµÿßÿ™ÿõ ÿßŸÑÿ™ÿ∑Ÿàÿ±ÿßÿ™ ÿßŸÑÿ™ŸÉŸÜŸàŸÑŸàÿ¨Ÿäÿ© ÿßŸÑÿ≥ÿ±Ÿäÿπÿ© ŸÖŸÜ ŸÇÿ®ŸÑ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑÿπÿßŸÑŸÖŸäŸäŸÜÿõ ŸÜŸÇÿßÿ∑ ÿ∂ÿπŸÅ ÿ≥ŸÑÿ≥ŸÑÿ© ÿßŸÑÿ™Ÿàÿ±ŸäÿØ ŸÑŸÑŸÖŸÉŸàŸÜÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™Ÿàÿ±ÿØÿ©.</p>
                </div>
                <h4>ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸàŸÜ ÿßŸÑÿ±ÿ¶Ÿäÿ≥ŸäŸàŸÜ (ÿ™Ÿàÿ∂Ÿäÿ≠Ÿä):</h4>
                 <ul><li>ÿ¨ŸÑŸàÿ®ÿßŸÑ ŸÖŸäÿØ ŸÑŸÑÿ£ÿ¨Ÿáÿ≤ÿ© (ÿ¥ÿ±ŸÉÿ© ŸÖÿ™ÿπÿØÿØÿ© ÿßŸÑÿ¨ŸÜÿ≥Ÿäÿßÿ™ - ŸÖÿ≠ŸÅÿ∏ÿ© Ÿàÿßÿ≥ÿπÿ©ÿå ÿ®ÿ≠ÿ´ Ÿàÿ™ÿ∑ŸàŸäÿ± ŸÇŸàŸä)</li><li>ÿ¢ÿ±ÿßÿ®ŸäÿßŸÜ ŸáŸäŸÑÿ´ ÿ™ŸÉ (ŸÖŸàÿ≤ÿπ/ŸÖÿ≥ÿ™Ÿàÿ±ÿØ ÿ•ŸÇŸÑŸäŸÖŸä - ÿ™ÿ≥ÿπŸäÿ± ŸÇŸàŸä)</li><li>ÿßŸÑŸÖÿµŸÜÿπŸàŸÜ ÿßŸÑŸÖÿ≠ŸÑŸäŸàŸÜ ÿßŸÑŸÜÿßÿ¥ÿ¶ŸàŸÜ (ÿßŸÑÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸâ ŸÖŸàÿßÿØ ŸÖÿπŸäŸÜÿ© ÿ∞ÿßÿ™ ÿ≠ÿ¨ŸÖ ŸÉÿ®Ÿäÿ±)</li></ul>
                <div class="recommendation-box">
                    <h4>ÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ÿßŸÑÿ™ŸÜÿßŸÅÿ≥Ÿäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©</h4>
                    <p>Ÿäÿ¨ÿ® ÿπŸÑŸâ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿßŸÑÿßÿ≥ÿ™ŸÅÿßÿØÿ© ŸÖŸÜ ŸÜŸÇÿßÿ∑ ŸÇŸàÿ™Ÿáÿß ŸÅŸä ÿßŸÑÿ™ÿµŸÜŸäÿπ ÿßŸÑŸÖÿ≠ŸÑŸä Ÿàÿ∂ŸÖÿßŸÜ ÿßŸÑÿ¨ŸàÿØÿ©. ÿßŸÑÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸâ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© Ÿáÿ¨ŸäŸÜÿ©:
                    1.  <strong>ŸÇŸäÿßÿØÿ© ÿßŸÑÿ™ŸÉŸÑŸÅÿ© ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©:</strong> ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ÿµŸÜŸäÿπ ŸÑŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿ∞ÿßÿ™ ÿßŸÑÿ≠ÿ¨ŸÖ ÿßŸÑŸÉÿ®Ÿäÿ± ŸÑŸÑÿ™ŸÜÿßŸÅÿ≥ ÿ®ŸÅÿπÿßŸÑŸäÿ© ÿπŸÑŸâ ÿßŸÑÿ≥ÿπÿ± ŸÖÿπ ÿßŸÑÿ≠ŸÅÿßÿ∏ ÿπŸÑŸâ ÿßŸÑÿ¨ŸàÿØÿ©.
                    2.  <strong>ÿßŸÑÿ™ŸÖŸäŸäÿ≤ ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑŸÖÿ™ÿÆÿµÿµÿ©:</strong> ÿ™ÿ∑ŸàŸäÿ± ÿ£Ÿà ÿ™ŸàŸÅŸäÿ± ŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ŸÖÿ™ÿÆÿµÿµÿ© ÿ≠Ÿäÿ´ ŸäŸÖŸÉŸÜ ŸÑŸÑÿ¨ŸàÿØÿ© ŸàÿßŸÑŸÖŸàÿ´ŸàŸÇŸäÿ© ŸàÿßŸÑÿØÿπŸÖ ÿßŸÑŸÖÿ≠ŸÑŸä ÿ£ŸÜ ÿ™ÿ®ÿ±ÿ± ÿ≥ÿπÿ±Ÿãÿß ÿ£ÿπŸÑŸâ.
                    3.  <strong>ÿ™ÿπÿ≤Ÿäÿ≤ ÿßŸÑÿπŸÑÿßŸÇÿßÿ™:</strong> ÿ™ÿπÿ≤Ÿäÿ≤ ÿßŸÑÿ¥ÿ±ÿßŸÉÿßÿ™ ŸÖÿπ ÿßŸÑŸÖÿ§ÿ≥ÿ≥ÿßÿ™ ÿßŸÑÿµÿ≠Ÿäÿ© ÿßŸÑÿ≠ŸÉŸàŸÖŸäÿ© ŸàÿßŸÑÿÆÿßÿµÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©ÿå ŸÖÿπ ÿßŸÑÿ™ÿ£ŸÉŸäÿØ ÿπŸÑŸâ ÿßŸÑŸÖŸàÿ´ŸàŸÇŸäÿ© ŸàÿßŸÑÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ©.
                    4.  <strong>ÿßÿ≥ÿ™ŸÉÿ¥ÿßŸÅ ÿßŸÑÿµÿßÿØÿ±ÿßÿ™ ÿßŸÑŸÖÿ™ÿÆÿµÿµÿ©:</strong> ÿßÿ≥ÿ™ŸáÿØÿßŸÅ ÿ£ÿ≥ŸàÿßŸÇ ŸÖÿπŸäŸÜÿ© ŸÅŸä ÿØŸàŸÑ ŸÖÿ¨ŸÑÿ≥ ÿßŸÑÿ™ÿπÿßŸàŸÜ ÿßŸÑÿÆŸÑŸäÿ¨Ÿä/ÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ Ÿàÿ¥ŸÖÿßŸÑ ÿ£ŸÅÿ±ŸäŸÇŸäÿß ÿ≠Ÿäÿ´ ÿ™ÿ™ŸÖÿ™ÿπ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿπÿßŸÑŸäÿ© ÿßŸÑÿ¨ŸàÿØÿ© ÿ®ŸÖŸäÿ≤ÿ©.</p>
                </div>
            `;
        }
        function generateComprehensiveAnalysisResponseAr() {
            return `
                <h1>ÿ™ÿ≠ŸÑŸäŸÑ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿä ÿ¥ÿßŸÖŸÑ: ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©</h1>
                <div class="analysis-result-card">
                    <h2>1. ŸÖŸÑÿÆÿµ ÿ™ŸÜŸÅŸäÿ∞Ÿä</h2>
                    <p>ÿ™Ÿèÿπÿ™ÿ®ÿ± ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©ÿå ŸàŸáŸä ÿ¥ÿ±ŸÉÿ© ŸÖÿµŸÜÿπÿ© ŸÑŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ ŸÖŸÇÿ±Ÿáÿß ÿßŸÑÿ±Ÿäÿßÿ∂ ŸÖŸÜÿ∞ ÿπÿßŸÖ 1994ÿå ŸÑÿßÿπÿ®Ÿãÿß ŸÖÿ≠ŸÑŸäŸãÿß ÿ±ÿ¶Ÿäÿ≥ŸäŸãÿß ŸÖŸÑÿ™ÿ≤ŸÖŸãÿß ÿ®ŸÖÿπÿßŸäŸäÿ± ÿßŸÑÿ¨ŸàÿØÿ© ÿßŸÑÿπÿßŸÑŸÖŸäÿ© ÿßŸÑÿπÿßŸÑŸäÿ©. Ÿàÿ±ÿ∫ŸÖ ÿßŸÖÿ™ŸÑÿßŸÉŸáÿß ÿ£ÿ≥ÿßÿ≥Ÿãÿß ŸÖÿ™ŸäŸÜŸãÿßÿå ÿ™Ÿàÿßÿ¨Ÿá ÿßŸÑÿ¥ÿ±ŸÉÿ© ÿ™ÿ≠ÿØŸäÿßÿ™ ŸÉÿ®Ÿäÿ±ÿ© ŸÅŸä ÿßŸÑÿ£ÿπŸÖÿßŸÑ ŸàÿßŸÑÿ¨ŸàÿßŸÜÿ® ÿßŸÑŸÖÿßŸÑŸäÿ© ÿ™ÿ≥ÿ™ŸÑÿ≤ŸÖ ÿßÿ™ÿÆÿßÿ∞ ÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ŸÅŸàÿ±Ÿäÿ© Ÿàÿ≠ÿßÿ≥ŸÖÿ©. ŸäŸàÿ∂ÿ≠ Ÿáÿ∞ÿß ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖÿ¨ÿßŸÑÿßÿ™ ÿßŸÑÿ≠ŸäŸàŸäÿ© ŸÑŸÑÿ™ÿ≠ŸàŸÑ ŸÑÿ∂ŸÖÿßŸÜ ÿßŸÑŸÜŸÖŸà ÿßŸÑŸÖÿ≥ÿ™ÿØÿßŸÖ Ÿàÿ™ÿπÿ≤Ÿäÿ≤ ÿßŸÑÿ±ŸäÿßÿØÿ© ŸÅŸä ÿßŸÑÿ≥ŸàŸÇ ŸÅŸä ÿßŸÑŸÖÿ¥ŸáÿØ ÿßŸÑÿµÿ≠Ÿä ÿßŸÑŸÖÿ™ÿ∑Ÿàÿ± ŸÅŸä ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸàÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑.</p>
                </div>
                <div class="analysis-result-card">
                    <h2>2. ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÖÿßŸÑŸä Ÿàÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿßÿ™ ÿßŸÑÿ™ÿπÿßŸÅŸä</h2>
                    <p>ŸÖŸÜ ÿßŸÑŸÖÿ±ÿ¨ÿ≠ ÿ£ŸÜ ÿßŸÑÿ¥ÿ±ŸÉÿ© ÿ™ÿπÿßŸÜŸä ŸÖŸÜ ÿ∂ÿ∫Ÿàÿ∑ ÿπŸÑŸâ ÿßŸÑÿ≥ŸäŸàŸÑÿ© ŸàÿßŸÑÿ±ÿ®ÿ≠Ÿäÿ©. Ÿäÿ¨ÿ® ÿ£ŸÜ ÿ™ÿ±ŸÉÿ≤ ÿÆÿ∑ÿ© ÿßŸÑÿ™ÿπÿßŸÅŸä ÿßŸÑŸÇŸàŸäÿ© ÿπŸÑŸâ:
                    <ul>
                        <li><strong>ÿ•ÿØÿßÿ±ÿ© ÿµÿßÿ±ŸÖÿ© ŸÑŸÑÿ™ŸÉÿßŸÑŸäŸÅ:</strong> ÿ™ÿ∑ÿ®ŸäŸÇ ŸÖÿ®ÿßÿØÿ¶ ÿßŸÑÿ™ÿµŸÜŸäÿπ ÿßŸÑÿÆÿßŸÑŸä ŸÖŸÜ ÿßŸÑŸáÿØÿ± ŸÑÿ™ŸÇŸÑŸäŸÑ ÿßŸÑŸÅÿßŸÇÿØ Ÿàÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÉŸÅÿßÿ°ÿ© ŸÅŸä ÿ•ŸÜÿ™ÿßÿ¨ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©. ÿßÿ≥ÿ™ŸáÿØÿßŸÅ ÿÆŸÅÿ∂ ÿßŸÑÿ™ŸÉÿßŸÑŸäŸÅ ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑŸäÿ© ÿ®ŸÜÿ≥ÿ®ÿ© 10-15Ÿ™ ÿπŸÑŸâ ŸÖÿØŸâ 18 ÿ¥Ÿáÿ±Ÿãÿß.</li>
                        <li><strong>ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ±ÿ£ÿ≥ ÿßŸÑŸÖÿßŸÑ ÿßŸÑÿπÿßŸÖŸÑ:</strong> ÿ™ÿ≠ÿ≥ŸäŸÜ ÿØŸàÿ±ÿßŸÜ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™Ÿáÿß ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØÿå Ÿàÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™ŸÅÿßŸàÿ∂ ÿπŸÑŸâ ÿ¥ÿ±Ÿàÿ∑ ÿßŸÑÿØŸÅÿπ ŸÖÿπ ÿßŸÑŸÖŸàÿ±ÿØŸäŸÜÿå Ÿàÿ™ÿ®ÿ≥Ÿäÿ∑ ÿ™ÿ≠ÿµŸäŸÑ ÿßŸÑŸÖÿ≥ÿ™ÿ≠ŸÇÿßÿ™.</li>
                        <li><strong>ÿ•ÿπÿßÿØÿ© ŸáŸäŸÉŸÑÿ© ÿßŸÑÿØŸäŸàŸÜ (ÿ•ŸÜ Ÿàÿ¨ÿØÿ™):</strong> ÿßÿ≥ÿ™ŸÉÿ¥ÿßŸÅ ÿÆŸäÿßÿ±ÿßÿ™ ŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ™ÿ≤ÿßŸÖÿßÿ™ ÿßŸÑÿØŸäŸàŸÜ ÿßŸÑÿ≠ÿßŸÑŸäÿ© ÿ®ÿ¥ŸÉŸÑ ÿ£ŸÉÿ´ÿ± ŸÅÿπÿßŸÑŸäÿ©.</li>
                        <li><strong>ÿ™ÿπÿ≤Ÿäÿ≤ ÿßŸÑÿ•Ÿäÿ±ÿßÿØÿßÿ™:</strong> ÿ™ÿ≠ÿØŸäÿØ ŸÖÿ¨ÿßŸÑÿßÿ™ ŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿ¨ÿØŸäÿØÿ© ÿ∞ÿßÿ™ ŸáÿßŸÖÿ¥ ÿ±ÿ®ÿ≠ ÿ£ÿπŸÑŸâ ÿ∂ŸÖŸÜ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ£Ÿà ÿßÿ≥ÿ™ŸÉÿ¥ÿßŸÅ ÿÆÿØŸÖÿßÿ™ ÿ∞ÿßÿ™ ŸÇŸäŸÖÿ© ŸÖÿ∂ÿßŸÅÿ©.</li>
                    </ul></p>
                    <div class="critical-box">
                        <h4>ÿ•ÿ¨ÿ±ÿßÿ° ÿπÿßÿ¨ŸÑ: ÿ™ÿπÿ≤Ÿäÿ≤ ÿßŸÑÿ™ÿØŸÅŸÇ ÿßŸÑŸÜŸÇÿØŸä</h4>
                        <p>ÿ™ŸÜŸÅŸäÿ∞ ÿ™ÿØÿßÿ®Ÿäÿ± ŸÅŸàÿ±Ÿäÿ© ŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ÿØŸàÿ±ÿ© ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑŸÜŸÇÿØ. ŸàŸäÿ¥ŸÖŸÑ ÿ∞ŸÑŸÉ ŸÖÿ±ÿßÿ¨ÿπÿ© ÿµÿßÿ±ŸÖÿ© ŸÑÿ™ŸÉÿßŸÑŸäŸÅ ÿßŸÑÿßÿ≠ÿ™ŸÅÿßÿ∏ ÿ®ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ŸÑÿ¨ŸÖŸäÿπ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ ŸàÿßŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿßÿ≥ÿ™ÿ®ÿßŸÇŸäÿ© ŸÑŸÑÿ∞ŸÖŸÖ ÿßŸÑÿ™ÿ¨ÿßÿ±Ÿäÿ© ÿßŸÑŸÖÿØŸäŸÜÿ© ŸàÿßŸÑÿØÿßÿ¶ŸÜÿ©.</p>
                    </div>
                </div>
                <div class="analysis-result-card">
                    <h2>3. ÿßŸÑŸÖÿ±ŸÉÿ≤ ÿßŸÑÿ≥ŸàŸÇŸä ŸàÿØŸäŸÜÿßŸÖŸäŸÉŸäÿßÿ™ ÿßŸÑŸÖŸÜÿßŸÅÿ≥ÿ© (ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©)</h2>
                    <p>ÿ™ÿ≥ÿ™ŸÅŸäÿØ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÖŸÜ ŸÇÿßÿπÿØÿ™Ÿáÿß ÿßŸÑÿ™ÿµŸÜŸäÿπŸäÿ© ÿßŸÑŸÖÿ≠ŸÑŸäÿ© ŸàÿßŸÑÿ™ÿ≤ÿßŸÖŸáÿß ÿ®ÿßŸÑÿ¨ŸàÿØÿ© (ŸÖÿ´ŸÑ ISO 13485). ŸàŸÖÿπ ÿ∞ŸÑŸÉÿå ÿ™Ÿàÿßÿ¨Ÿá ŸÖŸÜÿßŸÅÿ≥ÿ© ŸÖŸÜ ÿßŸÑÿ¥ÿ±ŸÉÿßÿ™ ŸÖÿ™ÿπÿØÿØÿ© ÿßŸÑÿ¨ŸÜÿ≥Ÿäÿßÿ™ ŸàÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑÿ•ŸÇŸÑŸäŸÖŸäŸäŸÜ ÿßŸÑÿ¢ÿÆÿ±ŸäŸÜ ŸÅŸä ÿ≥ŸàŸÇ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ. ÿ™ŸÖÿ´ŸÑ ŸÖÿ®ÿßÿØÿ±ÿßÿ™ ÿ™Ÿàÿ≥Ÿäÿπ ÿßŸÑÿ±ÿπÿßŸäÿ© ÿßŸÑÿµÿ≠Ÿäÿ© ÿ∂ŸÖŸÜ ÿ±ÿ§Ÿäÿ© 2030 ŸàŸÖÿ®ÿßÿØÿ±ÿßÿ™ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÖÿ≠ŸÑŸä (ÿßŸÉÿ™ŸÅÿßÿ°) ŸÅÿ±ÿµŸãÿß ŸÉÿ®Ÿäÿ±ÿ©.
                    Ÿäÿ¨ÿ® ÿ£ŸÜ ÿ™ÿ¥ŸÖŸÑ ÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿßÿ™:
                    <ul>
                        <li>ÿ™ÿπÿ≤Ÿäÿ≤ ŸÖŸÉÿßŸÜÿ© ÿßŸÑÿπŸÑÿßŸÖÿ© ÿßŸÑÿ™ÿ¨ÿßÿ±Ÿäÿ© ÿ≠ŸàŸÑ "ÿßŸÑÿ¨ŸàÿØÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿßŸÑÿµŸÜÿπ".</li>
                        <li>ÿßŸÑÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸâ ŸÅÿ¶ÿßÿ™ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ™Ÿä ŸäŸàŸÅÿ± ŸÅŸäŸáÿß ÿßŸÑÿ™ÿµŸÜŸäÿπ ÿßŸÑŸÖÿ≠ŸÑŸä ŸÖŸäÿ≤ÿ© Ÿàÿßÿ∂ÿ≠ÿ© (ŸÖÿ´ŸÑ ÿßŸÑÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ©ÿå ÿßŸÑÿ™ÿÆÿµŸäÿµ ŸÑŸÑÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™ ÿßŸÑÿ•ŸÇŸÑŸäŸÖŸäÿ©).</li>
                        <li>ÿ™ÿ∑ŸàŸäÿ± ÿπŸÑÿßŸÇÿßÿ™ ÿ£ÿπŸÖŸÇ ŸÖÿπ ŸáŸäÿ¶ÿßÿ™ ÿßŸÑÿ¥ÿ±ÿßÿ° ÿßŸÑÿµÿ≠Ÿä ÿßŸÑÿ≠ŸÉŸàŸÖŸäÿ© ŸàÿßŸÑÿÆÿßÿµÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©.</li>
                    </ul></p>
                    <div class="metric-card">
                        <div class="metric-label">ŸÖÿπÿØŸÑ ÿßŸÑÿßÿ≠ÿ™ŸÅÿßÿ∏ ÿ®ÿßŸÑÿπŸÖŸÑÿßÿ° (ÿßŸÑŸÖÿ≥ÿ™ŸáÿØŸÅ >85%)</div>
                        <div class="metric-value">78% <span class="quality-indicator quality-warning">Ÿäÿ≠ÿ™ÿßÿ¨ ŸÑÿßŸáÿ™ŸÖÿßŸÖ</span></div>
                        <p style="font-size:0.8em; opacity:0.7;">(ÿ™Ÿàÿ∂Ÿäÿ≠Ÿä)</p>
                    </div>
                </div>
                <div class="analysis-result-card">
                    <h2>4. ÿßŸÑÿ™ŸÇŸäŸäŸÖ ŸàÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑŸä</h2>
                    <p>ŸäŸèÿπÿØ ÿßŸÑÿ™ÿ≤ÿßŸÖ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© "ÿ®ÿ£ÿπŸÑŸâ ŸÖÿπÿßŸäŸäÿ± ÿßŸÑÿ¨ŸàÿØÿ© ÿßŸÑÿπÿßŸÑŸÖŸäÿ©" ÿ±ÿµŸäÿØŸãÿß ÿ£ÿ≥ÿßÿ≥ŸäŸãÿß. Ÿäÿ¨ÿ® ÿ£ŸÜ ÿ™ÿ±ŸÉÿ≤ ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑŸäÿ© ÿπŸÑŸâ:
                    <ul>
                        <li><strong>ÿ±ŸÇŸÖŸÜÿ© ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ¨ŸàÿØÿ©:</strong> ÿ™ÿ∑ÿ®ŸäŸÇ ÿ£ÿØŸàÿßÿ™ ÿ±ŸÇŸÖŸäÿ© ŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖÿ±ÿßŸÇÿ®ÿ© ÿßŸÑÿ¨ŸàÿØÿ© ŸàÿßŸÑÿ™ÿ™ÿ®ÿπ Ÿàÿ™ŸÇÿßÿ±Ÿäÿ± ÿßŸÑÿßŸÖÿ™ÿ´ÿßŸÑ (ÿßŸÑŸáŸäÿ¶ÿ© ÿßŸÑÿπÿßŸÖÿ© ŸÑŸÑÿ∫ÿ∞ÿßÿ° ŸàÿßŸÑÿØŸàÿßÿ°ÿå ISO).</li>
                        <li><strong>ŸÖÿ±ŸàŸÜÿ© ÿ≥ŸÑÿ≥ŸÑÿ© ÿßŸÑÿ™Ÿàÿ±ŸäÿØ:</strong> ÿ™ŸÜŸàŸäÿπ ŸÇÿßÿπÿØÿ© ÿßŸÑŸÖŸàÿ±ÿØŸäŸÜ ŸÑŸÑŸÖŸàÿßÿØ ÿßŸÑÿÆÿßŸÖ ÿßŸÑÿ≠ÿ±ÿ¨ÿ© ŸÑŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© Ÿàÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿÆÿØŸÖÿßÿ™ ÿßŸÑŸÑŸàÿ¨ÿ≥ÿ™Ÿäÿ©.</li>
                        <li><strong>ŸÉŸÅÿßÿ°ÿ© ÿßŸÑÿ™ÿµŸÜŸäÿπ:</strong> ÿßŸÑÿßÿ≥ÿ™ÿ´ŸÖÿßÿ± ŸÅŸä ÿßŸÑÿ£ÿ™ŸÖÿ™ÿ© ÿ≠Ÿäÿ´ŸÖÿß ŸÉÿßŸÜ ÿ∞ŸÑŸÉ ŸÖŸÖŸÉŸÜŸãÿß Ÿàÿ®ÿ±ÿßŸÖÿ¨ ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÖÿ≥ÿ™ŸÖÿ± ŸÑŸÑÿπŸÖŸÑŸäÿßÿ™.</li>
                    </ul></p>
                </div>
                <div class="analysis-result-card">
                    <h2>5. ŸÅÿ±ÿµ ÿßŸÑŸÜŸÖŸà ÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©</h2>
                    <ul>
                        <li><strong>ÿßŸÑÿ™ŸàÿßŸÅŸÇ ŸÖÿπ ÿ®ÿ±ŸÜÿßŸÖÿ¨ ÿßŸÉÿ™ŸÅÿßÿ°:</strong> ÿ™ÿπÿ∏ŸäŸÖ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÖÿ≠ŸÑŸä ŸÅŸä ŸÖŸÜÿ™ÿ¨ÿßÿ™Ÿáÿß ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿßŸÑÿ£ŸÅÿ∂ŸÑŸäÿ© ŸÅŸä ÿßŸÑŸÖŸÜÿßŸÇÿµÿßÿ™ ÿßŸÑÿ≠ŸÉŸàŸÖŸäÿ©.</li>
                        <li><strong>ÿ™Ÿàÿ≥Ÿäÿπ ÿÆÿ∑ ÿßŸÑÿ•ŸÜÿ™ÿßÿ¨:</strong> ÿßŸÑÿ™Ÿàÿ≥ÿπ ÿ®ÿ≠ÿ∞ÿ± ŸÅŸä ŸÅÿ¶ÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿßŸÑŸÖÿ¨ÿßŸàÿ±ÿ© ÿ∞ÿßÿ™ ÿßŸÑÿ∑ŸÑÿ® ÿßŸÑŸÖÿ±ÿ™ŸÅÿπ.</li>
                        <li><strong>ÿ™ŸÜŸÖŸäÿ© ÿßŸÑÿµÿßÿØÿ±ÿßÿ™ ÿßŸÑÿ•ŸÇŸÑŸäŸÖŸäÿ©:</strong> ÿßÿ≥ÿ™ŸáÿØÿßŸÅ ÿ£ÿ≥ŸàÿßŸÇ ŸÖÿπŸäŸÜÿ© ŸÅŸä ÿØŸàŸÑ ŸÖÿ¨ŸÑÿ≥ ÿßŸÑÿ™ÿπÿßŸàŸÜ ÿßŸÑÿÆŸÑŸäÿ¨Ÿä ŸàÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ Ÿàÿ¥ŸÖÿßŸÑ ÿ£ŸÅÿ±ŸäŸÇŸäÿß ÿ®ŸÖŸÜÿ™ÿ¨ÿßÿ™Ÿáÿß ÿßŸÑŸÖÿπÿ™ŸÖÿØÿ© ÿ®ÿßŸÑÿ¨ŸàÿØÿ© Ÿàÿ®ÿ£ÿ≥ÿπÿßÿ± ÿ™ŸÜÿßŸÅÿ≥Ÿäÿ©.</li>
                        <li><strong>ÿ™ŸÉÿßŸÖŸÑ ÿßŸÑÿµÿ≠ÿ© ÿßŸÑÿ±ŸÇŸÖŸäÿ© (ÿπŸÑŸâ ÿßŸÑŸÖÿØŸâ ÿßŸÑÿ∑ŸàŸäŸÑ):</strong> ÿßÿ≥ÿ™ŸÉÿ¥ÿßŸÅ ŸÉŸäŸÅ ŸäŸÖŸÉŸÜ ŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™Ÿáÿß ÿ£ŸÜ ÿ™ÿ™ŸÉÿßŸÖŸÑ ŸÖÿπ ÿ≠ŸÑŸàŸÑ ÿßŸÑÿµÿ≠ÿ© ÿßŸÑÿ±ŸÇŸÖŸäÿ© ÿ£Ÿà ÿ™ÿØÿπŸÖŸáÿß.</li>
                    </ul>
                </div>
                <div class="recommendation-box">
                    <h4>ÿÆÿßÿ±ÿ∑ÿ© ÿ∑ÿ±ŸäŸÇ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ÿ¥ÿßŸÖŸÑÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©</h4>
                    <p><strong>ÿßŸÑŸÖÿ±ÿ≠ŸÑÿ© ÿßŸÑÿ£ŸàŸÑŸâ (0-12 ÿ¥Ÿáÿ±Ÿãÿß): ÿßŸÑÿßÿ≥ÿ™ŸÇÿ±ÿßÿ± ÿßŸÑŸÖÿßŸÑŸä ŸàÿßŸÑÿ™ŸÖŸäÿ≤ ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑŸä.</strong> ÿßŸÑÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸâ ÿÆŸÅÿ∂ ÿßŸÑÿ™ŸÉÿßŸÑŸäŸÅÿå Ÿàÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ÿØŸÅŸÇ ÿßŸÑŸÜŸÇÿØŸäÿå Ÿàÿ™ÿπÿ≤Ÿäÿ≤ ŸÉŸÅÿßÿ°ÿ© ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ¨ŸàÿØÿ© ŸÑŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©.</p>
                    <p><strong>ÿßŸÑŸÖÿ±ÿ≠ŸÑÿ© ÿßŸÑÿ´ÿßŸÜŸäÿ© (12-24 ÿ¥Ÿáÿ±Ÿãÿß): ÿ™ÿπÿ≤Ÿäÿ≤ ÿßŸÑÿ≥ŸàŸÇ Ÿàÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÖŸÜÿ™ÿ¨.</strong> ÿ™ÿπŸÖŸäŸÇ ÿßÿÆÿ™ÿ±ÿßŸÇ ÿßŸÑÿ≥ŸàŸÇ ŸÅŸä ÿßŸÑŸÖŸÖŸÑŸÉÿ© ÿßŸÑÿπÿ±ÿ®Ÿäÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©ÿå Ÿàÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖÿ≠ŸÅÿ∏ÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿßŸÑÿ±ÿ®ÿ≠Ÿäÿ©ÿå Ÿàÿ®ÿØÿ° ŸÖÿ®ÿßÿØÿ±ÿßÿ™ ÿ™ÿµÿØŸäÿ± ŸÖÿ≥ÿ™ŸáÿØŸÅÿ© ŸÑÿ£ÿ¨Ÿáÿ≤ÿ™Ÿáÿß ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ.</p>
                    <p><strong>ÿßŸÑŸÖÿ±ÿ≠ŸÑÿ© ÿßŸÑÿ´ÿßŸÑÿ´ÿ© (24+ ÿ¥Ÿáÿ±Ÿãÿß): ÿßŸÑŸÜŸÖŸà ÿßŸÑŸÖÿ≥ÿ™ÿØÿßŸÖ ŸàÿßŸÑÿ™ŸÜŸàŸäÿπ.</strong> ÿ™Ÿàÿ≥Ÿäÿπ ŸÜÿ∑ÿßŸÇ ÿÆÿ∑Ÿàÿ∑ ÿßŸÑÿ•ŸÜÿ™ÿßÿ¨ ÿßŸÑŸÜÿßÿ¨ÿ≠ÿ©ÿå Ÿàÿ™Ÿàÿ≥Ÿäÿπ ÿßŸÑÿ®ÿµŸÖÿ© ÿßŸÑÿ•ŸÇŸÑŸäŸÖŸäÿ©ÿå Ÿàÿßÿ≥ÿ™ŸÉÿ¥ÿßŸÅ ÿßŸÑÿ™ÿ≠ÿßŸÑŸÅÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ÿ£Ÿà ÿßÿπÿ™ŸÖÿßÿØ ÿßŸÑÿ™ŸÉŸÜŸàŸÑŸàÿ¨Ÿäÿß ÿßŸÑÿ¨ÿØŸäÿØÿ© ÿ∞ÿßÿ™ ÿßŸÑÿµŸÑÿ© ÿ®ÿ™ÿµŸÜŸäÿπ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©.</p>
                </div>
            `;
        }
        function generateDefaultResponseAr(query) {
            return `
                <div class="analysis-result-card">
                    <h2>ÿ®ÿÆÿµŸàÿµ ÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ±ŸÉ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©: "${query.substring(0,50)}..."</h2>
                    <p>ÿ®ÿµŸÅÿ™Ÿä Ÿäÿ≤ŸäÿØ AIÿå ŸÖÿ≥ÿ™ÿ¥ÿßÿ±ŸÉ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© (ÿ¥ÿ±ŸÉÿ© ŸÖÿµŸÜÿπÿ© ŸÑŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ ŸÖŸÇÿ±Ÿáÿß ÿßŸÑÿ±Ÿäÿßÿ∂ ŸÖŸÜÿ∞ ÿπÿßŸÖ 1994ÿå ŸÖŸÑÿ™ÿ≤ŸÖÿ© ÿ®ÿßŸÑÿ¨ŸàÿØÿ© ÿßŸÑÿπÿßŸÑŸäÿ© Ÿàÿ™Ÿàÿßÿ¨Ÿá ÿ≠ÿßŸÑŸäŸãÿß ÿ™ÿ≠ÿØŸäÿßÿ™ ŸÅŸä ÿßŸÑÿ£ÿπŸÖÿßŸÑ)ÿå ÿ≥ÿ£ŸÇÿØŸÖ ÿ±ÿ§Ÿâ ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ Ÿáÿ∞ÿß ÿßŸÑÿ≥ŸäÿßŸÇ.</p>
                    <p>ÿ™ÿ™ÿ£ÿ´ÿ± ÿπŸÖŸÑŸäÿßÿ™ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿ®ÿ¥ŸÉŸÑ ŸÉÿ®Ÿäÿ± ÿ®ÿ™ÿ≠ŸàŸÑ ÿßŸÑÿ±ÿπÿßŸäÿ© ÿßŸÑÿµÿ≠Ÿäÿ© ÿ∂ŸÖŸÜ ÿ±ÿ§Ÿäÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© 2030ÿå ŸàŸÖÿπÿßŸäŸäÿ± ÿßŸÑÿ¨ŸàÿØÿ© ÿßŸÑÿµÿßÿ±ŸÖÿ© (ISO 13485ÿå ÿßŸÑŸáŸäÿ¶ÿ© ÿßŸÑÿπÿßŸÖÿ© ŸÑŸÑÿ∫ÿ∞ÿßÿ° ŸàÿßŸÑÿØŸàÿßÿ°)ÿå Ÿàÿ≥ŸàŸÇ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿßŸÑÿ™ŸÜÿßŸÅÿ≥Ÿäÿå ŸàÿßŸÑÿ™Ÿàÿ¨Ÿá ŸÜÿ≠Ÿà ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÖÿ≠ŸÑŸä (ÿßŸÉÿ™ŸÅÿßÿ°). ŸÑÿ™ÿ≠ŸÑŸäŸÑ ŸÖÿ≠ÿØÿØ Ÿäÿπÿ™ŸÖÿØ ÿπŸÑŸâ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ÿå Ÿäÿ±ÿ¨Ÿâ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ£ŸÇÿ≥ÿßŸÖ ÿßŸÑŸÖÿÆÿµÿµÿ© ÿ£Ÿà ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÖÿ≥ÿ™ŸÜÿØÿßÿ™ ÿ∞ÿßÿ™ ÿßŸÑÿµŸÑÿ©. ŸÉŸäŸÅ ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ÿ®ÿ¥ŸÉŸÑ ÿ£ŸÉÿ®ÿ± ŸÅŸäŸÖÿß Ÿäÿ™ÿπŸÑŸÇ ÿ®Ÿàÿ∂ÿπ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿßŸÑŸÖÿ≠ÿØÿØ ÿ£Ÿà ÿ≥ŸàŸÇŸáÿß ŸÑŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©ÿü</p>
                </div>
            `;
        }

        function exportResults(section, format) {
            const contentElement = document.getElementById(`${section}AnalysisContent`);
            if (!contentElement) return;
            
            const rawHtmlContent = contentElement.innerHTML; 
            let textContent = new DOMParser().parseFromString(rawHtmlContent, "text/html").documentElement.textContent; 

            const timestamp = new Date().toISOString().replace(/:/g, '-').split('.')[0];
            const filename = `${section}_analysis_SaudiMaisCo_${timestamp}.${format}`;
            
            let exportContent = textContent;
            if (format === 'md') {
                exportContent = convertToMarkdown(rawHtmlContent); 
            } else if (format === 'pdf') {
                exportToPDF(rawHtmlContent, filename);
                return;
            }
            
            const blob = new Blob([exportContent], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function convertToMarkdown(htmlContent) {
            let md = htmlContent;
            md = md.replace(/<h1>(.*?)<\/h1>/gi, "# $1\n")
                   .replace(/<h2>(.*?)<\/h2>/gi, "## $1\n")
                   .replace(/<h3>(.*?)<\/h3>/gi, "### $1\n")
                   .replace(/<h4>(.*?)<\/h4>/gi, "#### $1\n")
                   .replace(/<p>(.*?)<\/p>/gi, "$1\n\n")
                   .replace(/<ul>/gi, "").replace(/<\/ul>/gi, "")
                   .replace(/<ol>/gi, "").replace(/<\/ol>/gi, "")
                   .replace(/<li>(.*?)<\/li>/gi, "- $1\n")
                   .replace(/<strong>(.*?)<\/strong>/gi, "**$1**")
                   .replace(/<em>(.*?)<\/em>/gi, "*$1*")
                   .replace(/<br\s*\/?>/gi, "\n")
                   .replace(/<[^>]+>/g, '') 
                   .replace(/\n{3,}/g, '\n\n'); 
            
            md = `# ${translations[currentLanguage].pageTitle}\n## ${translations[currentLanguage].companyNameHeader}\n\n${md}`;
            md += `\n\n---\n*${translations[currentLanguage].generatedOn || 'Generated on'} ${new Date().toLocaleString(currentLanguage === 'ar' ? 'ar-SA' : 'en-US')}*`;
            return md;
        }


        function exportToPDF(htmlContent, filename) {
            alert(translations[currentLanguage].alertPdfExport);
            const section = filename.split('_')[0];
            const textContent = new DOMParser().parseFromString(htmlContent, "text/html").documentElement.textContent;
            const blob = new Blob([textContent], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${section}_analysis_SaudiMaisCo_fallback.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        async function startAnalysis(sectionName, promptBuilder) {
            const textInputEl = document.getElementById(`${sectionName}TextInput`);
            const textInput = textInputEl ? textInputEl.value : '';
            
            const focusInputEl = document.getElementById(`${sectionName}FocusInput`);
            const focusInputFileEl = document.getElementById(`${sectionName}FocusInputFile`);
            const focusInput = (focusInputEl && focusInputEl.value) ? focusInputEl.value : (focusInputFileEl ? focusInputFileEl.value : '');
            
            const fileDataContent = fileContents[sectionName] || ""; 
            const resultsContainer = document.getElementById(`${sectionName}Results`);
            const contentContainer = document.getElementById(`${sectionName}AnalysisContent`);

            if (!textInput && !fileDataContent && sectionName !== 'ai-chat') {
                alert(translations[currentLanguage].alertNoData);
                return;
            }

            const statusKeysMap = {
                'advanced': ['advancedStep1Text', 'advancedStep2Text', 'advancedStep3Text', 'advancedStep4Text'],
                'quality': ['qualityStep1Text', 'qualityStep2Text', 'qualityStep3Text', 'qualityStep4Text'],
                'demand': ['demandStep1Text', 'demandStep2Text', 'demandStep3Text', 'demandStep4Text'],
                'competitor': ['competitorStep1Text', 'competitorStep2Text', 'competitorStep3Text', 'competitorStep4Text']
            };
            
            if (statusKeysMap[sectionName]) {
                showAnalysisStatus(sectionName, statusKeysMap[sectionName]);
            }
            
            if (resultsContainer) resultsContainer.style.display = 'block';
            if (contentContainer) contentContainer.innerHTML = `<div class="loading-enhanced" style="margin: 20px auto; width: fit-content;"><div class="loading-dots"><div class="loading-dot"></div><div class="loading-dot"></div><div class="loading-dot"></div></div>${translations[currentLanguage].loadingAnalysisText}</div>`;
            
            const primaryDataForAnalysis = fileDataContent || textInput;
            const prompt = promptBuilder(primaryDataForAnalysis, focusInput, currentLanguage); 
            
            try {
                const response = await callGeminiAPI(prompt, primaryDataForAnalysis); 
                if (contentContainer) contentContainer.innerHTML = formatContent(response); 
                saveAnalysisResults(sectionName, response);
            } catch (error) {
                if (contentContainer) contentContainer.innerHTML = translations[currentLanguage].analysisFailedMsg;
                console.error("Analysis failed:", error);
            }
        }
        
        function startAdvancedAnalysis() {
            startAnalysis('advanced', (data, focus, lang) => {
                const companyContextEn = "As an expert business analyst for Saudi Mais Co. for Medical Products (a leading manufacturer of single-use medical consumables in the Middle East, founded in 1994 in Riyadh, committed to highest international quality standards):";
                const companyContextAr = "ÿ®ÿµŸÅÿ™ŸÉ ÿÆÿ®Ÿäÿ± ÿ™ÿ≠ŸÑŸäŸÑ ÿ£ÿπŸÖÿßŸÑ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© (ÿ¥ÿ±ŸÉÿ© ÿ±ÿßÿ¶ÿØÿ© ŸÅŸä ÿ™ÿµŸÜŸäÿπ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ ŸÅŸä ÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ÿå ÿ™ÿ£ÿ≥ÿ≥ÿ™ ÿπÿßŸÖ 1994 ŸÅŸä ÿßŸÑÿ±Ÿäÿßÿ∂ÿå ŸàŸÖŸÑÿ™ÿ≤ŸÖÿ© ÿ®ÿ£ÿπŸÑŸâ ŸÖÿπÿßŸäŸäÿ± ÿßŸÑÿ¨ŸàÿØÿ© ÿßŸÑÿπÿßŸÑŸÖŸäÿ©):";
                
                const fileInfoEn = data ? "Based *primarily* on the provided data/document content for Saudi Mais Co., and supplementing with your general knowledge where appropriate:" : "Based on your general knowledge of Saudi Mais Co. and the medical device market:";
                const fileInfoAr = data ? "ÿ®ÿßŸÑÿßÿπÿ™ŸÖÿßÿØ *ÿ®ÿ¥ŸÉŸÑ ÿ£ÿ≥ÿßÿ≥Ÿä* ÿπŸÑŸâ ŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™/ÿßŸÑŸÖÿ≥ÿ™ŸÜÿØ ÿßŸÑŸÖŸÇÿØŸÖ ÿßŸÑÿÆÿßÿµ ÿ®ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©ÿå ŸÖÿπ ÿßŸÑÿßÿ≥ÿ™ÿπÿßŸÜÿ© ÿ®ŸÖÿπÿ±ŸÅÿ™ŸÉ ÿßŸÑÿπÿßŸÖÿ© ÿπŸÜÿØ ÿßŸÑÿßŸÇÿ™ÿ∂ÿßÿ°:" : "ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ŸÖÿπÿ±ŸÅÿ™ŸÉ ÿßŸÑÿπÿßŸÖÿ© ÿ®ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© Ÿàÿ≥ŸàŸÇ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ©:";

                if (lang === 'ar') {
                    return `
                        ${companyContextAr}
                        ${fileInfoAr}
                        ŸÇŸÖ ÿ®ÿ•ÿ¨ÿ±ÿßÿ° ÿ™ÿ≠ŸÑŸäŸÑ ÿ£ÿπŸÖÿßŸÑ ŸÖÿ™ŸÇÿØŸÖ Ÿàÿ¥ÿßŸÖŸÑ.
                        Ÿäÿ¨ÿ® ÿ£ŸÜ ÿ™ÿ¥ŸÖŸÑ ÿßŸÑÿßÿπÿ™ÿ®ÿßÿ±ÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ÿßÿ™ÿ¨ÿßŸáÿßÿ™ ÿßŸÑÿ≥ŸàŸÇ ÿßŸÑÿ≠ÿßŸÑŸäÿ©ÿå ŸàÿßŸÑÿ£ÿØÿßÿ° ÿßŸÑŸÖÿßŸÑŸä ŸÑŸÑÿ¥ÿ±ŸÉÿ©ÿå ŸàÿßŸÑŸÉŸÅÿßÿ°ÿ© ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑŸäÿ©ÿå ŸàŸÅÿ±ÿµ ÿßŸÑŸÜŸÖŸà ÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ©ÿå ŸÑÿß ÿ≥ŸäŸÖÿß ŸÅŸä ÿ≥ŸäÿßŸÇ ÿÆÿ∑ÿ∑ ÿ™ÿ∑ŸàŸäÿ± ÿßŸÑÿ±ÿπÿßŸäÿ© ÿßŸÑÿµÿ≠Ÿäÿ© ÿ∂ŸÖŸÜ ÿ±ÿ§Ÿäÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© 2030 Ÿàÿ™ÿÆÿµÿµ ÿßŸÑÿ¥ÿ±ŸÉÿ© ŸÅŸä ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ.
                        ${focus ? `Ÿäÿ¨ÿ® ÿ•ŸäŸÑÿßÿ° ÿ™ÿ±ŸÉŸäÿ≤ ÿÆÿßÿµ ÿπŸÑŸâ: ${focus}\n` : ''}
                        Ÿäÿ±ÿ¨Ÿâ ÿ™ŸÇÿØŸäŸÖ ÿ™ŸÇÿ±Ÿäÿ± ŸÖŸÅÿµŸÑ ŸÖŸÜÿ∏ŸÖ ÿ®ÿßŸÑÿ£ŸÇÿ≥ÿßŸÖ ÿßŸÑÿ™ÿßŸÑŸäÿ©:
                        1.  ÿ™ÿ≠ŸÑŸäŸÑ ÿ®Ÿäÿ¶ÿ© ÿßŸÑÿ≥ŸàŸÇ (ÿ®ŸÖÿß ŸÅŸä ÿ∞ŸÑŸÉ ÿßŸÑÿßÿ™ÿ¨ÿßŸáÿßÿ™ ŸàÿßŸÑŸÖŸÜÿßŸÅÿ≥ÿ© ŸàÿßŸÑŸÖÿ¥ŸáÿØ ÿßŸÑÿ™ŸÜÿ∏ŸäŸÖŸä ÿßŸÑŸÖÿ™ÿπŸÑŸÇ ÿ®ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©).
                        2.  ÿ™ŸÇŸäŸäŸÖ ŸÖÿ™ÿπŸÖŸÇ ŸÑŸÑÿµÿ≠ÿ© ÿßŸÑŸÖÿßŸÑŸäÿ© (ÿ™ŸÇŸäŸäŸÖ ÿßŸÑÿ±ÿ®ÿ≠Ÿäÿ© ŸàÿßŸÑÿ≥ŸäŸàŸÑÿ© ŸàÿßŸÑŸÖŸÑÿßÿ°ÿ© ŸàÿßŸÑŸÉŸÅÿßÿ°ÿ©).
                        3.  ŸÖÿ±ÿßÿ¨ÿπÿ© ÿßŸÑÿ£ÿØÿßÿ° ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑŸä (ÿßŸÑÿ™ÿµŸÜŸäÿπÿå ÿ≥ŸÑÿ≥ŸÑÿ© ÿßŸÑÿ™Ÿàÿ±ŸäÿØÿå ÿ±Ÿàÿßÿ®ÿ∑ ŸÖÿ±ÿßŸÇÿ®ÿ© ÿßŸÑÿ¨ŸàÿØÿ©).
                        4.  ÿ™ŸàÿµŸäÿßÿ™ ŸÜŸÖŸà ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© (ŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ™ŸÜŸÅŸäÿ∞ÿå ÿ∞ÿßÿ™ ÿ£ŸàŸÑŸàŸäÿ©ÿå ŸàŸÖÿ±ÿ™ÿ®ÿ∑ÿ© ÿ®ÿ±ÿ§Ÿäÿ© 2030).
                        5.  ÿ™ŸÇŸäŸäŸÖ ÿ¥ÿßŸÖŸÑ ŸÑŸÑŸÖÿÆÿßÿ∑ÿ± Ÿàÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿßÿ™ ÿßŸÑÿ™ÿÆŸÅŸäŸÅ.
                        ÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ£ŸÜ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ŸÇÿßÿ®ŸÑ ŸÑŸÑÿ™ŸÜŸÅŸäÿ∞ ŸàŸÖÿµŸÖŸÖ ÿÆÿµŸäÿµŸãÿß ŸÑÿ¥ÿ±ŸÉÿ© ŸÖÿµŸÜÿπÿ© ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ŸÖÿ´ŸÑ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©.
                    `;
                }
                return `
                    ${companyContextEn}
                    ${fileInfoEn}
                    Conduct a comprehensive advanced business analysis.
                    Key considerations should include current market trends, the company's financial performance, operational efficiency, and strategic growth opportunities, particularly within the context of Saudi Vision 2030's healthcare development plans and the company's specialization in single-use medical devices.
                    ${focus ? `Specific focus should be given to: ${focus}\n` : ''}
                    Please provide a detailed report structured with the following sections:
                    1.  Market Environment Analysis (including trends, competition, and regulatory landscape relevant to medical consumables).
                    2.  In-depth Financial Health Assessment (evaluating profitability, liquidity, solvency, and efficiency).
                    3.  Operational Performance Review (manufacturing, supply chain, quality control links).
                    4.  Strategic Growth Recommendations (actionable, prioritized, and linked to Vision 2030).
                    5.  Comprehensive Risk Assessment and Mitigation Strategies.
                    Ensure the analysis is actionable and tailored to a medical products manufacturer like Saudi Mais Co.
                `;
            });
        }

        function startQualityAnalysis() {
             startAnalysis('quality', (data, focus, lang) => {
                const companyContextEn = "As a specialized quality assurance consultant for Saudi Mais Co. for Medical Products (a leading manufacturer of single-use medical consumables in the Middle East, founded in 1994 in Riyadh, committed to highest international quality standards and adhering to standards like ISO 13485):";
                const companyContextAr = "ÿ®ÿµŸÅÿ™ŸÉ ÿßÿ≥ÿ™ÿ¥ÿßÿ±Ÿä ÿ∂ŸÖÿßŸÜ ÿ¨ŸàÿØÿ© ŸÖÿ™ÿÆÿµÿµ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© (ÿ¥ÿ±ŸÉÿ© ÿ±ÿßÿ¶ÿØÿ© ŸÅŸä ÿ™ÿµŸÜŸäÿπ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ ŸÅŸä ÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ÿå ÿ™ÿ£ÿ≥ÿ≥ÿ™ ÿπÿßŸÖ 1994 ŸÅŸä ÿßŸÑÿ±Ÿäÿßÿ∂ÿå ŸàŸÖŸÑÿ™ÿ≤ŸÖÿ© ÿ®ÿ£ÿπŸÑŸâ ŸÖÿπÿßŸäŸäÿ± ÿßŸÑÿ¨ŸàÿØÿ© ÿßŸÑÿπÿßŸÑŸÖŸäÿ© Ÿàÿ™ÿ∑ÿ®ŸäŸÇ ŸÖÿπÿßŸäŸäÿ± ŸÖÿ´ŸÑ ISO 13485):";

                const fileInfoEn = data ? "Based *primarily* on the provided quality data/documentation for Saudi Mais Co., and supplementing with your expertise:" : "Based on your expertise in medical device quality management systems and general knowledge of Saudi Mais Co.:";
                const fileInfoAr = data ? "ÿ®ÿßŸÑÿßÿπÿ™ŸÖÿßÿØ *ÿ®ÿ¥ŸÉŸÑ ÿ£ÿ≥ÿßÿ≥Ÿä* ÿπŸÑŸâ ÿ®ŸäÿßŸÜÿßÿ™/Ÿàÿ´ÿßÿ¶ŸÇ ÿßŸÑÿ¨ŸàÿØÿ© ÿßŸÑŸÖŸÇÿØŸÖÿ© ÿßŸÑÿÆÿßÿµÿ© ÿ®ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©ÿå ŸÖÿπ ÿßŸÑÿßÿ≥ÿ™ÿπÿßŸÜÿ© ÿ®ÿÆÿ®ÿ±ÿ™ŸÉ:" : "ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿÆÿ®ÿ±ÿ™ŸÉ ŸÅŸä ÿ£ŸÜÿ∏ŸÖÿ© ÿ•ÿØÿßÿ±ÿ© ÿ¨ŸàÿØÿ© ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ© ŸàŸÖÿπÿ±ŸÅÿ™ŸÉ ÿßŸÑÿπÿßŸÖÿ© ÿ®ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©:";
                
                if (lang === 'ar') {
                    return `
                        ${companyContextAr}
                        ${fileInfoAr}
                        ŸÇŸÖ ÿ®ÿ•ÿ¨ÿ±ÿßÿ° ÿ™ÿ≠ŸÑŸäŸÑ ÿ¥ÿßŸÖŸÑ ŸÑŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ¨ŸàÿØÿ© (QMS) ÿ®ÿßŸÑÿ¥ÿ±ŸÉÿ©.
                        ŸÇŸäŸëŸÖ ŸÅÿπÿßŸÑŸäÿ™Ÿá ŸàÿßŸÖÿ™ÿ´ÿßŸÑŸáÿå ÿÆÿßÿµÿ©Ÿã ŸÑŸÖÿπŸäÿßÿ± ISO 13485ÿå ŸàŸÑŸàÿßÿ¶ÿ≠ ÿßŸÑŸáŸäÿ¶ÿ© ÿßŸÑÿπÿßŸÖÿ© ŸÑŸÑÿ∫ÿ∞ÿßÿ° ŸàÿßŸÑÿØŸàÿßÿ° ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿµŸÑÿ©ÿå ŸàÿßŸÑŸÖÿπÿßŸäŸäÿ± ÿßŸÑÿØŸàŸÑŸäÿ© ÿßŸÑÿ£ÿÆÿ±Ÿâ ÿßŸÑŸÖÿ∑ÿ®ŸÇÿ© ÿπŸÑŸâ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ©.
                        Ÿäÿ¨ÿ® ÿ£ŸÜ Ÿäÿ±ŸÉÿ≤ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿπŸÑŸâ ŸÖÿπÿØŸÑÿßÿ™ ÿßŸÑÿπŸäŸàÿ®ÿå Ÿàÿßÿ™ÿ¨ÿßŸáÿßÿ™ ÿπÿØŸÖ ÿßŸÑŸÖÿ∑ÿßÿ®ŸÇÿ©ÿå Ÿàÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ£ÿ≥ÿ®ÿßÿ® ÿßŸÑÿ¨ÿ∞ÿ±Ÿäÿ© ŸÑŸÖÿ¥ŸÉŸÑÿßÿ™ ÿßŸÑÿ¨ŸàÿØÿ©ÿå ŸàŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ÿßŸÑÿπŸÖŸÑÿßÿ°, Ÿàÿ•ÿØÿßÿ±ÿ© ÿ¨ŸàÿØÿ© ÿßŸÑŸÖŸàÿ±ÿØŸäŸÜ.
                        ${focus ? `Ÿäÿ¨ÿ® ÿ•ŸäŸÑÿßÿ° ÿ™ÿ±ŸÉŸäÿ≤ ÿÆÿßÿµ ÿπŸÑŸâ: ${focus}\n` : ''}
                        Ÿäÿ±ÿ¨Ÿâ ÿ™ŸÇÿØŸäŸÖ ÿ™ŸÇÿ±Ÿäÿ± ÿ¥ÿßŸÖŸÑ Ÿäÿ™ÿ∂ŸÖŸÜ:
                        1.  ÿßŸÑŸÅÿπÿßŸÑŸäÿ© ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸäÿ© ŸÑŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ¨ŸàÿØÿ© Ÿàÿ≠ÿßŸÑÿ© ÿßŸÑÿßŸÖÿ™ÿ´ÿßŸÑ.
                        2.  ÿ™ÿ≠ŸÑŸäŸÑ ŸÖŸÅÿµŸÑ ŸÑŸÑÿπŸäŸàÿ® Ÿàÿßÿ™ÿ¨ÿßŸáÿßÿ™ ÿπÿØŸÖ ÿßŸÑŸÖÿ∑ÿßÿ®ŸÇÿ©.
                        3.  ÿ™ŸÇŸäŸäŸÖ ÿßŸÑÿßŸÑÿ™ÿ≤ÿßŸÖ ÿ®ŸÖÿ™ÿ∑ŸÑÿ®ÿßÿ™ ISO 13485 ŸàÿßŸÑŸáŸäÿ¶ÿ© ÿßŸÑÿπÿßŸÖÿ© ŸÑŸÑÿ∫ÿ∞ÿßÿ° ŸàÿßŸÑÿØŸàÿßÿ°.
                        4.  ÿ™ŸÇŸäŸäŸÖ ÿßŸÑÿ™ÿπÿßŸÖŸÑ ŸÖÿπ ÿ¥ŸÉÿßŸàŸâ ÿßŸÑÿπŸÖŸÑÿßÿ° ŸàŸÖŸÇÿßŸäŸäÿ≥ ÿßŸÑÿ±ÿ∂ÿß.
                        5.  ÿÆÿ∑ÿ© ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ¨ŸàÿØÿ© ŸÇŸàŸäÿ© ŸàŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ™ŸÜŸÅŸäÿ∞ ŸÖÿπ ÿ™ŸàÿµŸäÿßÿ™ ÿ∞ÿßÿ™ ÿ£ŸàŸÑŸàŸäÿ©.
                        ÿßŸÑŸáÿØŸÅ ŸáŸà ÿ™ÿπÿ≤Ÿäÿ≤ ÿ¨ŸàÿØÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ ŸàÿßŸÑÿßŸÖÿ™ÿ´ÿßŸÑ ÿßŸÑÿ™ŸÜÿ∏ŸäŸÖŸä ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©.
                    `;
                }
                return `
                    ${companyContextEn}
                    ${fileInfoEn}
                    Conduct a thorough analysis of the company's Quality Management System (QMS).
                    Evaluate its effectiveness and compliance, particularly against ISO 13485, relevant Saudi Food and Drug Authority (SFDA) regulations, and other applicable international standards for medical devices.
                    The analysis should emphasize defect rates, non-conformance trends, root cause analysis of quality issues, customer feedback, and supplier quality management.
                    ${focus ? `Specific focus should be given to: ${focus}\n` : ''}
                    Please deliver a comprehensive report including:
                    1.  Overall QMS Effectiveness and Compliance Status.
                    2.  Detailed Defect Analysis and Non-Conformance Trends.
                    3.  Assessment of Adherence to ISO 13485 and SFDA Requirements.
                    4.  Evaluation of Customer Complaint Handling and Satisfaction Metrics.
                    5.  A robust, actionable Quality Improvement Plan with prioritized recommendations.
                    The aim is to enhance product quality and regulatory compliance for Saudi Mais Co.
                `;
            });
        }

        function startDemandForecasting() {
            startAnalysis('demand', (data, focus, lang) => {
                const companyContextEn = "As an expert demand planner and inventory strategist for Saudi Mais Co. for Medical Products (a leading manufacturer of single-use medical consumables in the Middle East, founded in 1994 in Riyadh, aiming to meet increasing regional demand):";
                const companyContextAr = "ÿ®ÿµŸÅÿ™ŸÉ ÿÆÿ®Ÿäÿ± ÿ™ÿÆÿ∑Ÿäÿ∑ ÿ∑ŸÑÿ® Ÿàÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿä ŸÖÿÆÿ≤ŸàŸÜ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© (ÿ¥ÿ±ŸÉÿ© ÿ±ÿßÿ¶ÿØÿ© ŸÅŸä ÿ™ÿµŸÜŸäÿπ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ ŸÅŸä ÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ÿå ÿ™ÿ£ÿ≥ÿ≥ÿ™ ÿπÿßŸÖ 1994 ŸÅŸä ÿßŸÑÿ±Ÿäÿßÿ∂ÿå Ÿàÿ™ŸáÿØŸÅ ÿ•ŸÑŸâ ÿ™ŸÑÿ®Ÿäÿ© ÿßŸÑÿ∑ŸÑÿ® ÿßŸÑÿ•ŸÇŸÑŸäŸÖŸä ÿßŸÑŸÖÿ™ÿ≤ÿßŸäÿØ):";

                const fileInfoEn = data ? "Based *primarily* on the provided historical sales, inventory, and market data for Saudi Mais Co.:" : "Using your analytical expertise and general knowledge of demand patterns for medical consumables in the Middle East, specifically for Saudi Mais Co.:";
                const fileInfoAr = data ? "ÿ®ÿßŸÑÿßÿπÿ™ŸÖÿßÿØ *ÿ®ÿ¥ŸÉŸÑ ÿ£ÿ≥ÿßÿ≥Ÿä* ÿπŸÑŸâ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ ŸàÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ŸàÿßŸÑÿ≥ŸàŸÇ ÿßŸÑÿ™ÿßÿ±ŸäÿÆŸäÿ© ÿßŸÑŸÖŸÇÿØŸÖÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©:" : "ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿÆÿ®ÿ±ÿ™ŸÉ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑŸäÿ© ŸàŸÖÿπÿ±ŸÅÿ™ŸÉ ÿßŸÑÿπÿßŸÖÿ© ÿ®ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ∑ŸÑÿ® ÿπŸÑŸâ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ŸÅŸä ÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ÿå Ÿàÿ™ÿ≠ÿØŸäÿØÿßŸã ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©:";

                if (lang === 'ar') {
                    return `
                        ${companyContextAr}
                        ${fileInfoAr}
                        ŸÇŸÖ ÿ®ÿ•ÿ¨ÿ±ÿßÿ° ÿ™ÿ≠ŸÑŸäŸÑ ŸÖŸÅÿµŸÑ ŸÑÿ™ŸàŸÇÿπÿßÿ™ ÿßŸÑÿ∑ŸÑÿ® ŸàŸàÿ∂ÿπ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ.
                        ÿ≠ŸÑŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿßÿ±ŸäÿÆŸäÿ© ŸÑÿ™ÿ≠ÿØŸäÿØ ÿßŸÑÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑŸÖŸàÿ≥ŸÖŸäÿ©ÿå Ÿàÿßÿ™ÿ¨ÿßŸáÿßÿ™ ÿßŸÑŸÜŸÖŸàÿå Ÿàÿ™ÿ£ÿ´Ÿäÿ± ÿπŸàÿßŸÖŸÑ ŸÖÿ´ŸÑ ŸÖÿ®ÿßÿØÿ±ÿßÿ™ ÿ™Ÿàÿ≥Ÿäÿπ ÿßŸÑÿ±ÿπÿßŸäÿ© ÿßŸÑÿµÿ≠Ÿäÿ© (ŸÖÿ´ŸÑ ÿ±ÿ§Ÿäÿ© 2030)ÿå ŸàÿßŸÑÿ£ÿ≠ÿØÿßÿ´ ÿßŸÑÿµÿ≠Ÿäÿ© ÿßŸÑÿπÿßŸÖÿ©ÿå Ÿàÿ•ÿ∑ŸÑÿßŸÇ ŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿ¨ÿØŸäÿØÿ© ŸÑŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ.
                        ${focus ? `Ÿäÿ¨ÿ® ÿ•ŸäŸÑÿßÿ° ÿ™ÿ±ŸÉŸäÿ≤ ÿÆÿßÿµ ÿπŸÑŸâ: ${focus}\n` : ''}
                        Ÿäÿ¨ÿ® ÿ£ŸÜ Ÿäÿ™ÿ∂ŸÖŸÜ ÿ™ŸÇÿ±Ÿäÿ±ŸÉ ŸÖÿß ŸäŸÑŸä:
                        1.  ÿ™ÿ≠ŸÑŸäŸÑ ÿ¥ÿßŸÖŸÑ ŸÑŸÑÿ∑ŸÑÿ®: ŸÖÿ±ÿßÿ¨ÿπÿ© ÿßÿ™ÿ¨ÿßŸáÿßÿ™ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ ÿßŸÑÿ™ÿßÿ±ŸäÿÆŸäÿ© ŸàŸÖÿ≠ÿ±ŸÉÿßÿ™ ÿßŸÑÿ∑ŸÑÿ® ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©.
                        2.  ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ™ŸàŸÇÿπÿßÿ™: ÿ™ŸàŸÇÿπÿßÿ™ ÿ∑ŸÑÿ® ŸÑŸÖÿØÿ© 12 ÿ¥Ÿáÿ±Ÿãÿß ÿ≠ÿ≥ÿ® ŸÅÿ¶ÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ (ÿ•ŸÜ ÿ£ŸÖŸÉŸÜ)ÿå ŸÖÿπ ŸÅÿ™ÿ±ÿßÿ™ ÿ´ŸÇÿ©.
                        3.  ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ: ÿ™ŸàÿµŸäÿßÿ™ ŸÑŸÖÿ≥ÿ™ŸàŸäÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ÿßŸÑŸÖÿ´ŸÑŸâÿå ŸàŸÜŸÇÿßÿ∑ ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ∑ŸÑÿ®ÿå Ÿàÿ≠ÿ≥ÿßÿ®ÿßÿ™ ŸÖÿÆÿ≤ŸàŸÜ ÿßŸÑÿ£ŸÖÿßŸÜÿå Ÿàÿ™ŸÇŸÜŸäÿßÿ™ ÿßŸÑÿ™ÿ≠ŸÉŸÖ ŸÅŸä ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ (ŸÖÿ´ŸÑ ÿ™ÿ≠ŸÑŸäŸÑ ABCÿå ÿßÿπÿ™ÿ®ÿßÿ±ÿßÿ™ JIT) ŸÑŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©.
                        4.  ÿÆÿßÿ±ÿ∑ÿ© ÿ∑ÿ±ŸäŸÇ ŸÑŸÑÿ™ŸÜŸÅŸäÿ∞: ÿßŸÑÿÆÿ∑Ÿàÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÑÿ™ŸÜŸÅŸäÿ∞ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿßÿ™ ÿßŸÑÿ™ŸÜÿ®ÿ§ ŸàÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ÿßŸÑŸÖŸÇÿ™ÿ±ÿ≠ÿ©.
                        ÿßŸÑŸáÿØŸÅ ŸáŸà ÿ™ÿ≠ÿ≥ŸäŸÜ ÿØŸÇÿ© ÿßŸÑÿ™ŸàŸÇÿπÿßÿ™ÿå Ÿàÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖÿ≥ÿ™ŸàŸäÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜÿå Ÿàÿ™ŸÇŸÑŸäŸÑ ÿ™ŸÉÿßŸÑŸäŸÅ ÿßŸÑÿßÿ≠ÿ™ŸÅÿßÿ∏ÿå Ÿàÿ™ŸÇŸÑŸäŸÑ ÿ≠ÿßŸÑÿßÿ™ ŸÜŸÅÿßÿØ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ.
                    `;
                }
                return `
                    ${companyContextEn}
                    ${fileInfoEn}
                    Conduct a detailed demand forecasting analysis and develop an inventory optimization strategy.
                    Analyze historical data to identify seasonal patterns, growth trends, and the impact of factors such as healthcare expansion initiatives (e.g., Vision 2030), public health events, and new product introductions for single-use medical devices.
                    ${focus ? `Specific focus should be given to: ${focus}\n` : ''}
                    Your report should include:
                    1.  Comprehensive Demand Analysis: Review of historical sales trends and key demand drivers.
                    2.  Forecasting Results: A 12-month demand projection by product category (if possible), with confidence intervals.
                    3.  Inventory Optimization Strategy: Recommendations for optimal inventory levels, reorder points, safety stock calculations, and inventory control techniques (e.g., ABC analysis, JIT considerations) for medical consumables.
                    4.  Implementation Roadmap: Key steps for Saudi Mais Co. to implement the proposed forecasting and inventory strategies.
                    The goal is to improve forecast accuracy, optimize stock levels, reduce holding costs, and minimize stockouts.
                `;
            });
        }

        function startCompetitorAnalysis() {
             startAnalysis('competitor', (data, focus, lang) => {
                const companyContextEn = "As a market intelligence analyst specializing in the medical device sector for Saudi Mais Co. for Medical Products (a leading manufacturer of single-use medical consumables in the Middle East, founded in 1994 in Riyadh, operating in a competitive market):";
                const companyContextAr = "ÿ®ÿµŸÅÿ™ŸÉ ŸÖÿ≠ŸÑŸÑ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ≥ŸàŸÇ ŸÖÿ™ÿÆÿµÿµ ŸÅŸä ŸÇÿ∑ÿßÿπ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ© ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© (ÿ¥ÿ±ŸÉÿ© ÿ±ÿßÿ¶ÿØÿ© ŸÅŸä ÿ™ÿµŸÜŸäÿπ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ ŸÅŸä ÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ÿå ÿ™ÿ£ÿ≥ÿ≥ÿ™ ÿπÿßŸÖ 1994 ŸÅŸä ÿßŸÑÿ±Ÿäÿßÿ∂ÿå Ÿàÿ™ÿπŸÖŸÑ ŸÅŸä ÿ≥ŸàŸÇ ÿ™ŸÜÿßŸÅÿ≥Ÿä):";

                const fileInfoEn = data ? "Based *primarily* on the provided competitor data and market intelligence for Saudi Mais Co.:" : "Leveraging your market research skills and knowledge of the competitive landscape for medical device manufacturers in Saudi Arabia and the Middle East, with a focus on Saudi Mais Co.:";
                const fileInfoAr = data ? "ÿ®ÿßŸÑÿßÿπÿ™ŸÖÿßÿØ *ÿ®ÿ¥ŸÉŸÑ ÿ£ÿ≥ÿßÿ≥Ÿä* ÿπŸÑŸâ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜ ŸàŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ≥ŸàŸÇ ÿßŸÑŸÖŸÇÿØŸÖÿ© ÿßŸÑÿÆÿßÿµÿ© ÿ®ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©:" : "ÿ®ÿßŸÑÿßÿ≥ÿ™ŸÅÿßÿØÿ© ŸÖŸÜ ŸÖŸáÿßÿ±ÿßÿ™ŸÉ ŸÅŸä ÿ£ÿ®ÿ≠ÿßÿ´ ÿßŸÑÿ≥ŸàŸÇ ŸàŸÖÿπÿ±ŸÅÿ™ŸÉ ÿ®ÿßŸÑŸÖÿ¥ŸáÿØ ÿßŸÑÿ™ŸÜÿßŸÅÿ≥Ÿä ŸÑŸÖÿµŸÜÿπŸä ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ© ŸÅŸä ÿßŸÑŸÖŸÖŸÑŸÉÿ© ÿßŸÑÿπÿ±ÿ®Ÿäÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸàÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ÿå ŸÖÿπ ÿßŸÑÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸâ ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©:";

                if (lang === 'ar') {
                    return `
                        ${companyContextAr}
                        ${fileInfoAr}
                        ŸÇŸÖ ÿ®ÿ•ÿ¨ÿ±ÿßÿ° ÿ™ÿ≠ŸÑŸäŸÑ ÿ™ŸÜÿßŸÅÿ≥Ÿä ÿ¥ÿßŸÖŸÑ Ÿäÿ±ŸÉÿ≤ ÿπŸÑŸâ ÿ£ÿ≥ŸàÿßŸÇ ÿßŸÑŸÖŸÖŸÑŸÉÿ© ÿßŸÑÿπÿ±ÿ®Ÿäÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸàÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ ÿßŸÑÿ£Ÿàÿ≥ÿπ ŸÑŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ.
                        ÿ≠ÿØÿØ ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜ ÿßŸÑÿ±ÿ¶Ÿäÿ≥ŸäŸäŸÜ (ÿßŸÑŸÖÿ≠ŸÑŸäŸäŸÜ ŸàÿßŸÑÿØŸàŸÑŸäŸäŸÜ)ÿå Ÿàÿ≠ŸÑŸÑ ÿ≠ÿµÿµŸáŸÖ ÿßŸÑÿ≥ŸàŸÇŸäÿ©ÿå ŸàŸÖÿ≠ÿßŸÅÿ∏ ŸÖŸÜÿ™ÿ¨ÿßÿ™ŸáŸÖÿå Ÿàÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿßÿ™ ÿßŸÑÿ™ÿ≥ÿπŸäÿ±ÿå ŸàŸÇŸÜŸàÿßÿ™ ÿßŸÑÿ™Ÿàÿ≤Ÿäÿπÿå ŸàŸÜŸÇÿßÿ∑ ÿßŸÑŸÇŸàÿ© ŸàÿßŸÑÿ∂ÿπŸÅÿå ŸàÿßŸÑÿ™ŸÉÿ™ŸäŸÉÿßÿ™ ÿßŸÑÿ™ÿ≥ŸàŸäŸÇŸäÿ©.
                        ${focus ? `Ÿäÿ¨ÿ® ÿ•ŸäŸÑÿßÿ° ÿ™ÿ±ŸÉŸäÿ≤ ÿÆÿßÿµ ÿπŸÑŸâ: ${focus}\n` : ''}
                        Ÿäÿ±ÿ¨Ÿâ ÿ™ŸÜÿ∏ŸäŸÖ ÿ™ÿ≠ŸÑŸäŸÑŸÉ ŸÑŸäÿ¥ŸÖŸÑ:
                        1.  ŸÜÿ∏ÿ±ÿ© ÿπÿßŸÖÿ© ŸÖŸÅÿµŸÑÿ© ÿπŸÑŸâ ÿßŸÑŸÖÿ¥ŸáÿØ ÿßŸÑÿ≥ŸàŸÇŸä: ÿßŸÑÿ≠ÿ¨ŸÖÿå ÿßŸÑŸÜŸÖŸàÿå ÿßŸÑŸÇÿ∑ÿßÿπÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ŸÑŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©.
                        2.  ÿ™ŸÇŸäŸäŸÖ ÿ™ŸÜÿßŸÅÿ≥Ÿä ŸÖÿ™ÿπŸÖŸÇ: ŸÖŸÑŸÅÿßÿ™ ÿ™ÿπÿ±ŸäŸÅŸäÿ© ŸÑŸÄ 3-5 ŸÖŸÜÿßŸÅÿ≥ŸäŸÜ ÿ±ÿ¶Ÿäÿ≥ŸäŸäŸÜÿå ÿ®ŸÖÿß ŸÅŸä ÿ∞ŸÑŸÉ ÿ™ÿ≠ŸÑŸäŸÑ SWOT ÿßŸÑÿÆÿßÿµ ÿ®ŸáŸÖ ŸÖŸÜ ŸÖŸÜÿ∏Ÿàÿ± ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©.
                        3.  ÿ™ÿ≠ŸÑŸäŸÑ ŸÖŸÇÿßÿ±ŸÜ: ŸÖŸÇÿßÿ±ŸÜÿ© ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿ®ÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜ ÿπŸÑŸâ ÿßŸÑÿπŸàÿßŸÖŸÑ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© (ÿ¨ŸàÿØÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ÿå ÿßŸÑÿ≥ÿπÿ±ÿå ÿßŸÑÿßÿ®ÿ™ŸÉÿßÿ±ÿå ÿßŸÑÿÆÿØŸÖÿ©).
                        4.  ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÅÿ±ÿµ ŸàÿßŸÑÿ™ŸáÿØŸäÿØÿßÿ™: ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿßŸÑÿØŸäŸÜÿßŸÖŸäŸÉŸäÿßÿ™ ÿßŸÑÿ™ŸÜÿßŸÅÿ≥Ÿäÿ© Ÿàÿßÿ™ÿ¨ÿßŸáÿßÿ™ ÿßŸÑÿ≥ŸàŸÇ.
                        5.  ÿ™ŸàÿµŸäÿßÿ™ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ©: ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿßÿ™ ŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ™ŸÜŸÅŸäÿ∞ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÑÿ™ÿπÿ≤Ÿäÿ≤ ŸÖÿ±ŸÉÿ≤Ÿáÿß ÿßŸÑÿ™ŸÜÿßŸÅÿ≥Ÿäÿå Ÿàÿ™ŸÖŸäŸäÿ≤ ÿπÿ±Ÿàÿ∂Ÿáÿßÿå ŸàÿßŸÑÿßÿ≥ÿ™ŸÅÿßÿØÿ© ŸÖŸÜ ŸÅÿ±ÿµ ÿßŸÑÿ≥ŸàŸÇ ÿßŸÑŸÖÿ≠ÿØÿØÿ©.
                        Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸàŸÅÿ± ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿ±ÿ§Ÿâ Ÿàÿßÿ∂ÿ≠ÿ© ŸÑÿ•ÿ±ÿ¥ÿßÿØ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ™Ÿáÿß ÿßŸÑÿ™ŸÜÿßŸÅÿ≥Ÿäÿ©.
                    `;
                }
                return `
                    ${companyContextEn}
                    ${fileInfoEn}
                    Conduct a comprehensive competitor analysis focusing on the Saudi Arabian and broader Middle Eastern markets for single-use medical devices.
                    Identify key competitors (local and international), analyze their market share, product portfolios, pricing strategies, distribution channels, strengths, weaknesses, and marketing tactics.
                    ${focus ? `Specific focus should be given to: ${focus}\n` : ''}
                    Please structure your analysis to include:
                    1.  Detailed Market Landscape Overview: Size, growth, key segments for medical consumables.
                    2.  In-depth Competitive Assessment: Profiles of 3-5 key competitors, including their SWOT analysis from Saudi Mais Co.'s perspective.
                    3.  Comparative Analysis: Benchmarking Saudi Mais Co. against competitors on key factors (product quality, price, innovation, service).
                    4.  Opportunity and Threat Identification: Based on competitive dynamics and market trends.
                    5.  Strategic Recommendations: Actionable strategies for Saudi Mais Co. to enhance its competitive positioning, differentiate its offerings, and capitalize on identified market opportunities.
                    The analysis should provide Saudi Mais Co. with clear insights to inform its competitive strategy.
                `;
            });
        }

        async function sendMessageToAI(message, loadingTextKey, promptBuilder) {
            const chatMessagesContainer = document.getElementById('chatMessages');
            
            const aiThinkingPara = document.createElement('p');
            const aiStrong = document.createElement('strong');
            aiStrong.textContent = translations[currentLanguage].aiAssistantName;
            aiThinkingPara.appendChild(aiStrong);
            aiThinkingPara.innerHTML += ` <div class="loading-enhanced" style="margin-top: 5px;"><div class="loading-dots"><div class="loading-dot"></div><div class="loading-dot"></div><div class="loading-dot"></div></div>${translations[currentLanguage][loadingTextKey]}</div>`;
            chatMessagesContainer.appendChild(aiThinkingPara);
            chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;

            const prompt = promptBuilder(message, currentLanguage);
            const response = await callGeminiAPI(prompt); // No dataContent passed here as it's for general chat or a full comprehensive analysis request
            
            aiThinkingPara.innerHTML = ''; 
            aiThinkingPara.appendChild(aiStrong); 
            const responseContentDiv = document.createElement('div');
            responseContentDiv.className = 'formatted-content'; 
            responseContentDiv.innerHTML = formatContent(response); 
            aiThinkingPara.appendChild(responseContentDiv);
            
            chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
        }

        async function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            if (!message) return;

            const chatMessagesContainer = document.getElementById('chatMessages');
            const userPara = document.createElement('p');
            const userStrong = document.createElement('strong');
            userStrong.textContent = currentLanguage === 'ar' ? "ÿ£ŸÜÿ™:" : "You:";
            userPara.appendChild(userStrong);
            userPara.appendChild(document.createTextNode(` ${message}`));
            chatMessagesContainer.appendChild(userPara);
            input.value = '';

            await sendMessageToAI(message, 'loadingQueryText', (query, lang) => {
                if (lang === 'ar') {
                    return `
                        ÿ®ÿµŸÅÿ™ŸÉ Ÿäÿ≤ŸäÿØ AIÿå ŸÖÿ≥ÿ™ÿ¥ÿßÿ±ŸÉ ÿßŸÑÿ∞ŸÉŸä ÿßŸÑŸÖÿÆÿµÿµ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© (ÿ¥ÿ±ŸÉÿ© ÿ±ÿßÿ¶ÿØÿ© ŸÅŸä ÿ™ÿµŸÜŸäÿπ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ ŸÅŸä ÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ ŸÖŸÜÿ∞ ÿπÿßŸÖ 1994ÿå ŸÖŸÇÿ±Ÿáÿß ÿßŸÑÿ±Ÿäÿßÿ∂ÿå ÿ™ÿ±ŸÉÿ≤ ÿπŸÑŸâ ÿßŸÑÿ•ŸÜÿ™ÿßÿ¨ ÿπÿßŸÑŸä ÿßŸÑÿ¨ŸàÿØÿ© Ÿàÿ™Ÿàÿßÿ¨Ÿá ÿ≠ÿßŸÑŸäŸãÿß ÿ™ÿ≠ÿØŸäÿßÿ™ ŸÅŸä ÿßŸÑÿ£ÿπŸÖÿßŸÑ):
                        Ÿäÿ±ÿ¨Ÿâ ŸÖÿπÿßŸÑÿ¨ÿ© ÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿßŸÑÿ™ÿßŸÑŸä ÿ®ÿπŸÜÿßŸäÿ©: "${query}".
                        Ÿäÿ¨ÿ® ÿ£ŸÜ Ÿäÿ≥ÿ™ŸÜÿØ ÿ±ÿØŸÉ ÿ•ŸÑŸâ ŸÖŸÑŸÅ ÿßŸÑÿ¥ÿ±ŸÉÿ©ÿå ŸàÿØŸäŸÜÿßŸÖŸäŸÉŸäÿßÿ™ ÿ£ÿ≥ŸàÿßŸÇ ÿßŸÑÿ±ÿπÿßŸäÿ© ÿßŸÑÿµÿ≠Ÿäÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸàÿßŸÑÿ¥ÿ±ŸÇ ÿ£Ÿàÿ≥ÿ∑Ÿäÿ©ÿå Ÿàÿ£ŸáÿØÿßŸÅ ÿ±ÿ§Ÿäÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© 2030ÿå ŸàÿßŸÑÿßÿ™ÿ¨ÿßŸáÿßÿ™ ÿßŸÑÿ≠ÿßŸÑŸäÿ© ŸÅŸä ÿßŸÑŸÖÿπÿØÿßÿ™ ŸàÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©. ŸÇÿØŸÖ ÿ±ÿ§Ÿâ ŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ™ŸÜŸÅŸäÿ∞ ÿ£Ÿà ÿ™ŸÅÿ≥Ÿäÿ±ÿßÿ™ Ÿàÿßÿ∂ÿ≠ÿ© ÿ≠Ÿäÿ´ŸÖÿß ÿ£ŸÖŸÉŸÜ.
                    `;
                }
                return `
                    As Yazeed AI, your dedicated AI consultant for Saudi Mais Co. for Medical Products (a leading manufacturer of single-use medical consumables in the Middle East since 1994, based in Riyadh, focused on high-quality production and currently navigating business challenges):
                    Please address the following user query thoughtfully: "${query}".
                    Your response should be informed by the company's profile, the dynamics of the Saudi and Middle Eastern healthcare markets, the objectives of Saudi Vision 2030, and current trends in medical equipment and consumables. Provide actionable insights or clear explanations where possible.
                `;
            });
        }

        async function startComprehensiveAnalysis() {
            const chatMessagesContainer = document.getElementById('chatMessages');
             const analysisTitlePara = document.createElement('p');
             const analysisTitleStrong = document.createElement('strong');
             analysisTitleStrong.textContent = translations[currentLanguage].comprehensiveAnalysisResultTitle;
             analysisTitlePara.appendChild(analysisTitleStrong);
             chatMessagesContainer.appendChild(analysisTitlePara);


            await sendMessageToAI("", 'loadingComprehensiveAnalysisText', (queryIgnored, lang) => {
                if (lang === 'ar') {
                     return `
                        ÿ®ÿµŸÅÿ™ŸÉ Ÿäÿ≤ŸäÿØ AIÿå ŸÇÿØŸÖ ÿ™ÿ≠ŸÑŸäŸÑ ÿ£ÿπŸÖÿßŸÑ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿä ÿ¥ÿßŸÖŸÑ ŸÑÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©.
                        ŸÖŸÑŸÅ ÿßŸÑÿ¥ÿ±ŸÉÿ©: ÿ¥ÿ±ŸÉÿ© ÿ±ÿßÿ¶ÿØÿ© ŸÅŸä ÿ™ÿµŸÜŸäÿπ ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØ ŸÅŸä ÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑ÿå ÿ™ÿ£ÿ≥ÿ≥ÿ™ ÿπÿßŸÖ 1994ÿå ŸàŸÖŸÇÿ±Ÿáÿß ÿßŸÑÿ±Ÿäÿßÿ∂ÿå ÿßŸÑŸÖŸÖŸÑŸÉÿ© ÿßŸÑÿπÿ±ÿ®Ÿäÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©. ÿ™ÿ§ŸÉÿØ ÿßŸÑÿ¥ÿ±ŸÉÿ© ÿπŸÑŸâ ÿßŸÑÿßŸÑÿ™ÿ≤ÿßŸÖ ÿ®ÿ£ÿπŸÑŸâ ŸÖÿπÿßŸäŸäÿ± ÿßŸÑÿ¨ŸàÿØÿ© ÿßŸÑÿπÿßŸÑŸÖŸäÿ© ŸÅŸä ÿ•ŸÜÿ™ÿßÿ¨Ÿáÿß Ÿàÿ™Ÿàÿßÿ¨Ÿá ÿ≠ÿßŸÑŸäŸãÿß ÿ™ÿ≠ÿØŸäÿßÿ™ ŸÉÿ®Ÿäÿ±ÿ© ŸÅŸä ÿßŸÑÿ£ÿπŸÖÿßŸÑ ŸàÿßŸÑÿ¨ŸàÿßŸÜÿ® ÿßŸÑŸÖÿßŸÑŸäÿ©.
                        Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ ÿ™ÿ≠ŸÑŸäŸÑŸÉ ŸÖŸÜÿ∏ŸÖŸãÿß ŸàŸÖŸÅÿµŸÑÿßŸãÿå ŸàŸäÿ∫ÿ∑Ÿä ÿßŸÑŸÖÿ¨ÿßŸÑÿßÿ™ ÿßŸÑÿ≠ŸäŸàŸäÿ© ÿßŸÑÿ™ÿßŸÑŸäÿ©:
                        1.  ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÖÿßŸÑŸä ÿßŸÑÿ≠ÿßŸÑŸä Ÿàÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿßÿ™ ÿßŸÑÿ™ÿπÿßŸÅŸä ÿßŸÑŸÖŸÖŸÉŸÜÿ©: ÿ™ŸÇŸäŸäŸÖ ÿßŸÑÿ≥ŸäŸàŸÑÿ© ŸàÿßŸÑÿ±ÿ®ÿ≠Ÿäÿ© ŸàÿßŸÑÿØŸäŸàŸÜÿå ŸàÿßŸÇÿ™ÿ±ÿßÿ≠ ÿÆÿ∑Ÿàÿßÿ™ ÿπŸÖŸÑŸäÿ© ŸÑÿ™ÿ≠ŸÇŸäŸÇ ÿßŸÑÿßÿ≥ÿ™ŸÇÿ±ÿßÿ± ÿßŸÑŸÖÿßŸÑŸä ŸàÿßŸÑÿ™ÿ≠ŸàŸÑ.
                        2.  ÿßŸÑŸÖÿ±ŸÉÿ≤ ÿßŸÑÿ≥ŸàŸÇŸä ŸàÿßŸÑŸÖÿ¥ŸáÿØ ÿßŸÑÿ™ŸÜÿßŸÅÿ≥Ÿä: ÿ™ŸÇŸäŸäŸÖ ÿßŸÑÿ≠ÿµÿ© ÿßŸÑÿ≥ŸàŸÇŸäÿ©ÿå Ÿàÿ™ÿµŸàÿ± ÿßŸÑÿπŸÑÿßŸÖÿ© ÿßŸÑÿ™ÿ¨ÿßÿ±Ÿäÿ©ÿå ŸàÿßŸÑŸÖŸÜÿßŸÅÿ≥ŸäŸÜ ÿßŸÑÿ±ÿ¶Ÿäÿ≥ŸäŸäŸÜ ŸÅŸä ŸÇÿ∑ÿßÿπ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∑ÿ®Ÿäÿ© ÿ∞ÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸàÿßÿ≠ÿØÿå Ÿàÿ™ÿ£ÿ´Ÿäÿ± ŸÖÿ®ÿßÿØÿ±ÿßÿ™ ÿßŸÑÿ±ÿπÿßŸäÿ© ÿßŸÑÿµÿ≠Ÿäÿ© ÿ∂ŸÖŸÜ ÿ±ÿ§Ÿäÿ© 2030.
                        3.  ÿ™ŸÇŸäŸäŸÖ ÿßŸÑŸÉŸÅÿßÿ°ÿ© ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑŸäÿ©: ŸÖÿ±ÿßÿ¨ÿπÿ© ÿπŸÖŸÑŸäÿßÿ™ ÿßŸÑÿ™ÿµŸÜŸäÿπÿå Ÿàÿ•ÿØÿßÿ±ÿ© ÿ≥ŸÑÿ≥ŸÑÿ© ÿßŸÑÿ™Ÿàÿ±ŸäÿØÿå Ÿàÿ£ŸÜÿ∏ŸÖÿ© ŸÖÿ±ÿßŸÇÿ®ÿ© ÿßŸÑÿ¨ŸàÿØÿ© (ŸÖÿπ ŸÖÿ±ÿßÿπÿßÿ© ÿßŸÑÿ™ÿ≤ÿßŸÖŸáŸÖ ÿ®ŸÖÿπÿßŸäŸäÿ± ÿßŸÑÿ¨ŸàÿØÿ© ÿßŸÑÿπÿßŸÑŸäÿ©)ÿå ŸàŸÅÿ±ÿµ ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ŸÉÿßŸÑŸäŸÅ Ÿàÿ≤ŸäÿßÿØÿ© ÿßŸÑŸÉŸÅÿßÿ°ÿ©.
                        4.  ŸÅÿ±ÿµ ÿßŸÑŸÜŸÖŸà ÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ©: ÿ™ÿ≠ÿØŸäÿØ ŸÖÿ¨ÿßŸÑÿßÿ™ ÿßŸÑŸÜŸÖŸà ÿßŸÑŸÖÿ≠ÿ™ŸÖŸÑÿ©ÿå ŸÖÿ´ŸÑ ÿ™ÿ∑ŸàŸäÿ± ŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿ¨ÿØŸäÿØÿ© (ŸÅŸä ÿ•ÿ∑ÿßÿ± ÿßŸÑŸÖÿ≥ÿ™ŸáŸÑŸÉÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©)ÿå ŸàÿßŸÑÿ™Ÿàÿ≥ÿπ ŸÅŸä ÿßŸÑÿ≥ŸàŸÇ (ÿ•ŸÇŸÑŸäŸÖŸäŸãÿß)ÿå ŸàÿßŸÑÿßÿ≥ÿ™ŸÅÿßÿØÿ© ŸÖŸÜ ŸÖÿ®ÿßÿØÿ±ÿßÿ™ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÖÿ≠ŸÑŸä (ŸÖÿ´ŸÑ ÿ®ÿ±ŸÜÿßŸÖÿ¨ ÿßŸÉÿ™ŸÅÿßÿ°).
                        5.  ÿÆÿßÿ±ÿ∑ÿ© ÿ∑ÿ±ŸäŸÇ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ŸÖŸÅÿµŸÑÿ©: ÿ∂ÿπ ÿÆÿ∑ÿ© ŸÖÿ±ÿ≠ŸÑŸäÿ© (ŸÇÿµŸäÿ±ÿ©ÿå ŸÖÿ™Ÿàÿ≥ÿ∑ÿ©ÿå ÿ∑ŸàŸäŸÑÿ© ÿßŸÑÿ£ÿ¨ŸÑ) ÿ®ÿ£ŸáÿØÿßŸÅ ŸàŸÖÿπÿßŸÑŸÖ Ÿàÿßÿ∂ÿ≠ÿ©.
                        6.  ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖÿÆÿßÿ∑ÿ± ŸàÿßŸÑÿ™ÿÆŸÅŸäŸÅ ŸÖŸÜŸáÿß: ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖÿÆÿßÿ∑ÿ± ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© (ÿßŸÑŸÖÿßŸÑŸäÿ©ÿå ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑŸäÿ©ÿå ÿßŸÑÿ≥ŸàŸÇŸäÿ©ÿå ÿßŸÑÿ™ŸÜÿ∏ŸäŸÖŸäÿ©) ŸàÿßŸÇÿ™ÿ±ÿßÿ≠ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿßÿ™ ŸÑŸÑÿ™ÿÆŸÅŸäŸÅ ŸÖŸÜŸáÿß.
                        ÿ∂ÿπ ÿ™ÿ≠ŸÑŸäŸÑŸÉ ŸÅŸä ÿ≥ŸäÿßŸÇ ÿ±ÿ§Ÿäÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© 2030ÿå ŸàÿßŸÑÿ™Ÿàÿ¨Ÿá ŸÜÿ≠Ÿà ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÖÿ≠ŸÑŸä (ÿßŸÉÿ™ŸÅÿßÿ°)ÿå Ÿàÿ•ŸÖŸÉÿßŸÜÿßÿ™ ÿßŸÑÿ™Ÿàÿ≥ÿπ ÿßŸÑÿ•ŸÇŸÑŸäŸÖŸä ŸÅŸä ÿßŸÑÿ¥ÿ±ŸÇ ÿßŸÑÿ£Ÿàÿ≥ÿ∑. Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ ÿßŸÑŸÜÿßÿ™ÿ¨ ÿßÿ≠ÿ™ÿ±ÿßŸÅŸäŸãÿß Ÿàÿ´ÿßŸÇÿ®Ÿãÿß ŸàŸäŸÇÿØŸÖ ÿ™ŸàÿµŸäÿßÿ™ Ÿàÿßÿ∂ÿ≠ÿ© ŸàŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ™ŸÜŸÅŸäÿ∞ ŸÑŸÇŸäÿßÿØÿ© ÿ¥ÿ±ŸÉÿ© ŸÖŸäÿ≥ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©.
                    `;
                }
                return `
                    As Yazeed AI, provide a comprehensive strategic business analysis for Saudi Mais Co. for Medical Products.
                    Company Profile: A leading manufacturer of single-use medical consumables in the Middle East, founded in 1994, located in Riyadh, Saudi Arabia. The company emphasizes adherence to the highest international quality standards in its production and is currently addressing significant business and financial challenges.
                    Your analysis should be structured and detailed, covering the following critical areas:
                    1.  Current Financial Situation & Viable Recovery Strategies: Assess liquidity, profitability, debt, and propose actionable steps for financial stabilization and turnaround.
                    2.  Market Position & Competitive Landscape: Evaluate market share, brand perception, key competitors in the single-use medical device sector, and impact of Vision 2030 healthcare initiatives.
                    3.  Operational Efficiency Assessment: Review manufacturing processes, supply chain management, quality control systems (considering their commitment to high standards), and opportunities for cost optimization and efficiency gains.
                    4.  Strategic Growth Opportunities: Identify potential areas for growth, such as new product development (within medical consumables), market expansion (regional), and leveraging local content initiatives (e.g., IKTVA).
                    5.  Detailed Strategic Roadmap: Outline a phased plan (short, medium, long-term) with clear objectives and milestones.
                    6.  Risk Analysis and Mitigation: Identify key risks (financial, operational, market, regulatory) and propose mitigation strategies.
                    Contextualize your analysis within the framework of Saudi Vision 2030, the drive for local content (IKTVA), and potential for regional expansion in the Middle East. The output should be professional, insightful, and provide clear, actionable recommendations for Saudi Mais Co.'s leadership.
                `;
            });
        }

        document.getElementById('userInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) { 
                e.preventDefault();
                sendMessage();
            }
        });

        window.addEventListener('scroll', function() {
            if (window.innerWidth <= 768) { 
                 document.querySelectorAll('.analysis-card, .section-card, .results-section').forEach(card => {
                    card.style.transform = card.style.transform.replace(/rotateY\([^)]+\)/, 'rotateY(0deg)'); 
                 });
                return;
            }

            const cards = document.querySelectorAll('.analysis-card, .section-card, .results-section');
            cards.forEach((card) => {
                const rect = card.getBoundingClientRect();
                const isVisible = rect.top < window.innerHeight && rect.bottom > 0;
                
                if (isVisible) {
                    const scrollFactor = Math.min(1, Math.max(-1, (rect.top - (window.innerHeight / 2) + (rect.height / 2)) / (window.innerHeight / 2)));
                    const translateZ = 60 - Math.abs(scrollFactor) * 40; 
                    let rotateY = scrollFactor * -7; 
                    if (currentLanguage === 'ar') rotateY *= -1; 
                    const scale = 1 - Math.abs(scrollFactor) * 0.03; 
                    
                    if(Math.abs(rotateY) > 0.5 || Math.abs(1-scale) > 0.005) {
                       card.style.transform = `translateZ(${translateZ}px) rotateY(${rotateY}deg) scale(${scale})`;
                    }
                }
            });
        });

        function saveAnalysisResults(section, results) {
            analysisHistory[section] = {
                timestamp: new Date().toISOString(),
                results: results,
                version: '2.2' 
            };
            try {
                localStorage.setItem('maisAnalysisHistory', JSON.stringify(analysisHistory));
            } catch (e) {
                console.warn("Could not save analysis history to localStorage:", e);
            }
        }

        function loadAnalysisHistory() {
            try {
                const saved = localStorage.getItem('maisAnalysisHistory');
                if (saved) {
                    const loadedHistory = JSON.parse(saved);
                    // Basic version check, can be expanded
                    if (loadedHistory && (loadedHistory.version === '2.1' || loadedHistory.version === '2.2')) {
                         analysisHistory = loadedHistory;
                    } else {
                        // Clear old history if version mismatch or invalid
                        analysisHistory = {};
                        localStorage.removeItem('maisAnalysisHistory');
                    }
                }
            } catch (error) {
                console.warn('Failed to load analysis history:', error);
                analysisHistory = {};
            }
        }

        function adjustApiStatusPosition() {
            const apiStatus = document.getElementById('apiStatus');
            if (!apiStatus) return;

            if (window.innerWidth <= 768) {
                if (apiStatus.style.position !== 'relative') {
                    apiStatus.style.position = 'relative';
                    apiStatus.style.top = 'auto';
                    apiStatus.style.right = 'auto';
                    apiStatus.style.left = 'auto';
                    apiStatus.style.margin = '10px auto';
                    apiStatus.style.width = 'fit-content';
                }
            } else {
                 if (apiStatus.style.position !== 'fixed') {
                    apiStatus.style.position = 'fixed';
                    apiStatus.style.top = '20px';
                    apiStatus.style.margin = '0';
                    apiStatus.style.width = 'auto'; 
                    if (currentLanguage === 'ar') {
                        apiStatus.style.left = '20px';
                        apiStatus.style.right = 'auto';
                    } else {
                        apiStatus.style.right = '20px';
                        apiStatus.style.left = 'auto';
                    }
                 }
            }
        }

        window.addEventListener('resize', adjustApiStatusPosition);
        
        document.addEventListener('DOMContentLoaded', function() {
            setLanguage(currentLanguage);
            loadAnalysisHistory();
            adjustApiStatusPosition(); 
            
            const defaultActiveButton = document.querySelector(`.nav-btn[onclick*="showSection('${currentSection}')"]`);
            if (defaultActiveButton) defaultActiveButton.classList.add('active');
            
            const elementsToAnimate = document.querySelectorAll('.analysis-card, .solution-card, .section-card, .company-info');
            elementsToAnimate.forEach((element, index) => {
                element.style.opacity = '0';
                const baseTransformZ = element.classList.contains('company-info') ? '50px' : '40px';
                element.style.transform = `translateZ(0px) translateY(50px)`;
                
                setTimeout(() => {
                    element.style.transition = 'opacity 0.7s ease-out, transform 0.7s cubic-bezier(0.23, 1, 0.320, 1)';
                    element.style.opacity = '1';
                    element.style.transform = `translateZ(${baseTransformZ}) translateY(0px)`;
                }, index * 80); 
            });
        });
    </script>
</body>
</html>